import{c as B,t as D,u as F,e as k,Q as U,r as v,h as f,w as j,R as N,S as $,j as O,m,n as c,P as A,q as i,T as z,p as a,v as E,x as I,B as x,E as y,U as G,z as s,W as R,G as q,X as Q,Y as _,Z as X,$ as Y,F as Z}from"./index-MPtZOwSp.js";const H={class:"flex items-center w-[95px] h-12 text-white justify-center"},J={class:"relative w-[1.5rem] battery-icon"},K={key:0,class:"absolute text-sm text-yellow-400 -bottom-[3px] left-[4px] mdi mdi-alert-circle"},L={class:"relative right-0 flex flex-col w-[4rem] select-none text-sm font-semibold leading-4 text-end -mr-2"},ee={class:"w-full"},te={class:"flex justify-end gap-x-1 items-center"},oe={class:"font-mono"},ae={class:"w-full"},se={key:0,class:"flex justify-end gap-x-1 items-center"},le={class:"font-mono mt-[2px]"},ne={key:1,class:"flex justify-end gap-x-1 items-center text-yellow-100"},re={class:"font-mono mt-[2px]"},ie={class:"text-red-500 text-center text-sm w-[full]"},u=500,de=B({__name:"BatteryIndicator",props:{miniWidget:{}},setup(C){const e=D(C).miniWidget,V={showCurrent:!0,showPower:!0,toggleInterval:1e3},t=F(),b=k(),M=U(),g=v(!0),p=v(void 0),w=v(""),h=v(void 0),n=v(e.value.options.toggleInterval??V.toggleInterval),T=f(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.voltage)===void 0?"--":Math.abs(t.powerSupply.voltage)>=100?t.powerSupply.voltage.toFixed(0):t.powerSupply.voltage.toFixed(1)}),W=f(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.current)===void 0?"--":Math.abs(t.powerSupply.current)>=100?t.powerSupply.current.toFixed(0):t.powerSupply.current.toFixed(1)}),P=f(()=>t.instantaneousWatts!==void 0?t.instantaneousWatts.toFixed(1):"--"),d=f(()=>{var l;return((l=t==null?void 0:t.powerSupply)==null?void 0:l.remaining)===void 0?-1:Math.abs(t.powerSupply.remaining)>100?100:t.powerSupply.remaining}),S=()=>{(p.value||h.value)&&(clearInterval(p.value),clearTimeout(h.value)),n.value<u?(e.value.options.toggleInterval=u,w.value=`Interval must be at least ${u}ms.`):e.value.options.toggleInterval=n.value,!e.value.options.showCurrent&&!e.value.options.showPower&&(e.value.options.showCurrent=!0,e.value.options.showPower=!0,w.value="At least one of the options must be enabled."),e.value.options.showCurrent&&e.value.options.showPower?p.value=setInterval(()=>{g.value=!g.value},e.value.options.toggleInterval):g.value=e.value.options.showCurrent,h.value=setTimeout(()=>{w.value="",n.value<u&&(n.value=u)},5e3)};return j([()=>e.value.options,n],S,{deep:!0}),N(()=>{e.value.options=Object.assign({},V,e.value.options),S(),$.registerUsage("Instantaneous Watts")}),O(()=>{p.value===void 0&&clearInterval(p.value)}),(l,o)=>(c(),m(Z,null,[A((c(),m("div",H,[a("div",J,[o[4]||(o[4]=a("i",{class:"mdi mdi-battery-outline"},null,-1)),a("i",{class:"mdi mdi-battery absolute inset-0 bottom-0 -right-1 text-transparent bg-clip-text",style:I({backgroundImage:`linear-gradient(to top, white ${d.value}%, transparent ${d.value}%)`})},null,4),d.value<0?(c(),m("span",K)):E("",!0)]),a("div",L,[a("div",ee,[a("div",te,[a("span",oe,x(T.value),1),o[5]||(o[5]=a("div",{class:"w-[15px] mr-[1px] -ml-[1px]"},"V",-1))])]),a("div",ae,[g.value?(c(),m("div",se,[a("span",le,x(W.value),1),o[6]||(o[6]=a("div",{class:"w-[15px]"},"A",-1))])):(c(),m("div",ne,[a("span",re,x(P.value),1),o[7]||(o[7]=a("div",{class:"w-[15px]"},"W",-1))]))])])])),[[z,`Battery remaining: ${d.value<0?"No Data":d.value+"%"}`]]),i(Y,{modelValue:s(b).miniWidgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":o[3]||(o[3]=r=>s(b).miniWidgetManagerVars(s(e).hash).configMenuOpen=r),width:"auto"},{default:y(()=>[i(G,{class:"pa-4 text-white w-[20rem]",style:I([{"border-radius":"15px"},s(M).globalGlassMenuStyles])},{default:y(()=>[i(R,{class:"text-center"},{default:y(()=>o[8]||(o[8]=[q("Battery Indicator Config")])),_:1,__:[8]}),i(Q,{class:"flex flex-col gap-y-4"},{default:y(()=>[i(_,{modelValue:s(e).options.showCurrent,"onUpdate:modelValue":o[0]||(o[0]=r=>s(e).options.showCurrent=r),label:"Show Current","hide-details":""},null,8,["modelValue"]),i(_,{modelValue:s(e).options.showPower,"onUpdate:modelValue":o[1]||(o[1]=r=>s(e).options.showPower=r),label:"Show Power","hide-details":""},null,8,["modelValue"]),i(X,{modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=r=>n.value=r),modelModifiers:{number:!0},label:"Toggle Interval (ms)",type:"number",min:u,step:"100",density:"compact",variant:"outlined",disabled:!s(e).options.showCurrent||!s(e).options.showPower},null,8,["modelValue","disabled"]),a("p",ie,x(w.value),1)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}});export{de as default};
