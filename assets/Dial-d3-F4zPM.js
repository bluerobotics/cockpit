import{c as I,y as P,J as T,r as _,w as C,av as X,o as Y,k as j,h as $,aw as q,ax as J,l as F,m as E,n as p,v as f,O as V,q as o,t as U,s as G,ay as H,_ as K}from"./index-7JEsIEbG.js";const Q={class:"potentiometer-scale elevation-5"},Z={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},ee=I({__name:"Dial",props:{miniWidget:{}},setup(R){const t=P(),e=T(R).miniWidget,d=_(0),v=_(-150);let h;C(()=>t.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(t.showElementPropsDrawer(e.value.hash),setTimeout(()=>{t.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const b=a=>{var s,r,u,c;let i;a==null||isNaN(Number(a))?i=((s=e.value.options.layout)==null?void 0:s.minValue)||0:i=Number(a),d.value=i;const n=300,l=((r=e.value.options.layout)==null?void 0:r.maxValue)-((u=e.value.options.layout)==null?void 0:u.minValue)||1;v.value=(i-((c=e.value.options.layout)==null?void 0:c.minValue))/l*n-150};C(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.name},a=>{a&&y()},{immediate:!0});const y=()=>{var a;if(e.value.options.dataLakeVariable){h=X((a=e.value.options.dataLakeVariable)==null?void 0:a.name,n=>{b(n)});const i=t.getMiniWidgetLastValue(e.value.hash);b(i)}};Y(()=>{(!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,t.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),y()});const W=j(()=>{var a;switch((a=e.value.options.layout)==null?void 0:a.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),S=a=>{a.preventDefault();const n=a.currentTarget.getBoundingClientRect(),l=n.left+n.width/2,s=n.top+n.height/2,r=a.clientX-l,u=a.clientY-s,c=Math.atan2(u,r)*(180/Math.PI),A=v.value,k=L=>{var w,D,x;const N=L.clientX-l,O=L.clientY-s;let m=Math.atan2(O,N)*(180/Math.PI)-c;m>180?m-=360:m<-180&&(m+=360);let g=A+m;g=Math.max(-150,Math.min(150,g)),v.value=g;const z=300,B=((w=e.value.options.layout)==null?void 0:w.maxValue)-((D=e.value.options.layout)==null?void 0:D.minValue)||1;if(d.value=(g+150)/z*B+((x=e.value.options.layout)==null?void 0:x.minValue),e.value.options.dataLakeVariable){if(t.editingMode)return;t.setMiniWidgetLastValue(e.value.hash,Math.round(d.value)),H(e.value.options.dataLakeVariable.name,Math.round(d.value))}},M=()=>{document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",M)};document.addEventListener("mousemove",k),document.addEventListener("mouseup",M)};return $(()=>{e.value.options.dataLakeVariable&&(q(e.value.options.dataLakeVariable.id),h&&J(e.value.options.dataLakeVariable.name,h))}),(a,i)=>{var n,l,s,r,u;return F(),E("div",{id:"dial",class:f(["flex items-center w-auto",((n=o(t).elementToShowOnDrawer)==null?void 0:n.hash)===o(e).hash&&o(t).editingMode?"bg-[#00000010] ":"border-0"]),style:V({justifyContent:(l=o(e).options.layout)==null?void 0:l.align}),onClick:i[0]||(i[0]=c=>o(t).editingMode&&o(t).showElementPropsDrawer(o(e).hash))},[p("div",{class:f(["flex flex-row",o(t).editingMode?"pointer-events-none":"pointer-events-auto"])},[p("div",{class:f(["potentiometer-container w-full",W.value]),onMousedown:S},[p("div",Q,[p("div",{class:"potentiometer-knob",style:V({transform:`rotate(${v.value}deg)`,background:((s=o(e).options.layout)==null?void 0:s.knobColor)||"#838383"})},[p("div",{class:"knob-notch",style:V({background:((r=o(e).options.layout)==null?void 0:r.notchColor)||"#222222"})},null,4)],4)])],34)],2),(u=o(e).options.layout)!=null&&u.showValue?(F(),E("div",Z,U(Math.round(d.value)||0),1)):G("",!0)],6)}}}),oe=K(ee,[["__scopeId","data-v-2ba3a088"]]);export{oe as default};
