import{A as E}from"./AlertIcon-f5UCA0Ug.js";import{c as T,e as P,h as r,t as _,r as w,w as c,o as I,j as z,m as B,n as L,q as y,s as N,v as j,E as A,p as R,aN as U,aO as $,ap as q,y as M,z as o,a8 as K,x as F,aP as G,ac as H,aK as J,a5 as D,_ as Q}from"./index-DRDfdZm5.js";const X=T({__name:"Dropdown",props:{miniWidget:{}},setup(C){var f,V;const i=P();let s;const d=C,l=r(()=>{var e;return((e=a.value.options.layout)==null?void 0:e.selectorOptions)||[]}),a=_(d).miniWidget,m=w(l.value.find(e=>{var t;return e.value===((t=d.miniWidget.options.lastSelected)==null?void 0:t.value)})||l.value[0]),n=w(((f=d.miniWidget.options.lastSelected)==null?void 0:f.value)||((V=l.value[0])==null?void 0:V.value));c(()=>i.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(i.showElementPropsDrawer(a.value.hash),setTimeout(()=>{i.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0}),c(m,e=>{i.updateElementOptions(a.value.hash,{...a.value.options,lastSelected:e})});const S=e=>{if(i.editingMode)return;const t=l.value.find(u=>u.value===e);t&&(n.value=e,a.value.options.dataLakeVariable&&G(a.value.options.dataLakeVariable.id,e),i.setMiniWidgetLastValue(a.value.hash,t.value))},W=r(()=>!p.value&&!i.editingMode&&i.isRealMiniWidget(a.value.hash)),p=r(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)}),x=r(()=>{var e;return((e=a.value.options.dataLakeVariable)==null?void 0:e.allowUserToChangeValue)===!0}),h=r(()=>{var e;return!!((e=a.value.options.dataLakeVariable)!=null&&e.id)&&x.value&&!i.editingMode}),g=()=>{a.value.options.dataLakeVariable&&(s=H(a.value.options.dataLakeVariable.id,e=>{n.value=String(e)}),n.value=String(J(a.value.options.dataLakeVariable.id)))};return c(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&s&&D(t,s),e&&g()}),I(()=>{if((!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,i.updateElementOptions(a.value.hash,{layout:{selectorOptions:[],align:"start",width:168},variableType:"string",dataLakeVariable:void 0})),a.value.options.dataLakeVariable)g();else{const e=i.getMiniWidgetLastValue(a.value.hash);m.value=l.value.find(t=>t.value===e)||l.value[0]}}),z(()=>{a.value.options.dataLakeVariable&&s&&D(a.value.options.dataLakeVariable.id,s)}),(e,t)=>{var u,k;return L(),B("div",{class:M(["flex relative w-full",((u=o(i).elementToShowOnDrawer)==null?void 0:u.hash)===o(a).hash&&o(i).editingMode?"bg-[#00000010] ":"border-0"]),style:F({width:"100%",justifyContent:(k=o(a).options.layout)==null?void 0:k.align}),onClick:t[2]||(t[2]=v=>o(i).editingMode&&o(i).showElementPropsDrawer(o(a).hash))},[y(K,{text:"This element is in display mode. To make it interactive, create or select a user-controlled data-lake variable",location:"top","open-delay":"500",disabled:h.value||!p.value},{activator:A(({props:v})=>{var b;return[R("div",U($(v)),[y(q,{modelValue:n.value,"onUpdate:modelValue":[t[0]||(t[0]=O=>n.value=O),S],items:l.value,"item-title":"name","item-value":"value",theme:"dark",density:"compact",variant:"filled","min-width":((b=o(a).options.layout)==null?void 0:b.width)||168,"hide-details":"",class:M(["text-white",[h.value?"pointer-events-auto cursor-pointer":"pointer-events-none cursor-default",p.value?"":"opacity-50"]])},null,8,["modelValue","items","min-width","class"])],16)]}),_:1},8,["disabled"]),W.value?(L(),N(E,{key:0,icon:"mdi-connection",color:"#b9af1d",animation:"pulse",class:"absolute center ml-[70px] mt-[12px]",tooltip:"This element isn't connected to a data-lake variable yet. Click here to configure it.",onClick:t[1]||(t[1]=v=>o(i).showElementPropsDrawer(o(a).hash))})):j("",!0)],6)}}}),ee=Q(X,[["__scopeId","data-v-71128815"]]);export{ee as default};
