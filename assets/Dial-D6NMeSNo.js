import{c as z,y as B,J as I,r as x,w as P,o as T,au as X,k as Y,h as j,av as $,aw as q,l as _,m as C,n as p,v as f,O as V,q as n,t as J,s as U,ax as G,_ as H}from"./index-CYC8Eir1.js";const K={class:"potentiometer-scale elevation-5"},Q={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},Z=z({__name:"Dial",props:{miniWidget:{}},setup(F){const t=B(),e=I(F).miniWidget,d=x(0),v=x(-150);let h;P(()=>t.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(t.showElementPropsDrawer(e.value.hash),setTimeout(()=>{t.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const b=a=>{var i,r,u,c;let s;a==null||isNaN(Number(a))?s=((i=e.value.options.layout)==null?void 0:i.minValue)||0:s=Number(a),d.value=s;const o=300,l=((r=e.value.options.layout)==null?void 0:r.maxValue)-((u=e.value.options.layout)==null?void 0:u.minValue)||1;v.value=(s-((c=e.value.options.layout)==null?void 0:c.minValue))/l*o-150};T(()=>{var a;if((!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,t.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),e.value.options.dataLakeVariable){h=X((a=e.value.options.dataLakeVariable)==null?void 0:a.name,o=>{b(o)});const s=t.getMiniWidgetLastValue(e.value.hash);b(s)}});const E=Y(()=>{var a;switch((a=e.value.options.layout)==null?void 0:a.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),R=a=>{a.preventDefault();const o=a.currentTarget.getBoundingClientRect(),l=o.left+o.width/2,i=o.top+o.height/2,r=a.clientX-l,u=a.clientY-i,c=Math.atan2(u,r)*(180/Math.PI),W=v.value,y=k=>{var w,L,D;const S=k.clientX-l,A=k.clientY-i;let m=Math.atan2(A,S)*(180/Math.PI)-c;m>180?m-=360:m<-180&&(m+=360);let g=W+m;g=Math.max(-150,Math.min(150,g)),v.value=g;const N=300,O=((w=e.value.options.layout)==null?void 0:w.maxValue)-((L=e.value.options.layout)==null?void 0:L.minValue)||1;if(d.value=(g+150)/N*O+((D=e.value.options.layout)==null?void 0:D.minValue),e.value.options.dataLakeVariable){if(t.editingMode)return;t.setMiniWidgetLastValue(e.value.hash,Math.round(d.value)),G(e.value.options.dataLakeVariable.name,Math.round(d.value))}},M=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",M)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",M)};return j(()=>{e.value.options.dataLakeVariable&&($(e.value.options.dataLakeVariable.id),h&&q(e.value.options.dataLakeVariable.name,h))}),(a,s)=>{var o,l,i,r,u;return _(),C("div",{id:"dial",class:f(["flex items-center w-auto",((o=n(t).elementToShowOnDrawer)==null?void 0:o.hash)===n(e).hash&&n(t).editingMode?"bg-[#00000010] ":"border-0"]),style:V({justifyContent:(l=n(e).options.layout)==null?void 0:l.align}),onClick:s[0]||(s[0]=c=>n(t).editingMode&&n(t).showElementPropsDrawer(n(e).hash))},[p("div",{class:f(["flex flex-row",n(t).editingMode?"pointer-events-none":"pointer-events-auto"])},[p("div",{class:f(["potentiometer-container w-full",E.value]),onMousedown:R},[p("div",K,[p("div",{class:"potentiometer-knob",style:V({transform:`rotate(${v.value}deg)`,background:((i=n(e).options.layout)==null?void 0:i.knobColor)||"#838383"})},[p("div",{class:"knob-notch",style:V({background:((r=n(e).options.layout)==null?void 0:r.notchColor)||"#222222"})},null,4)],4)])],34)],2),(u=n(e).options.layout)!=null&&u.showValue?(_(),C("div",Q,J(Math.round(d.value)||0),1)):U("",!0)],6)}}}),oe=H(Z,[["__scopeId","data-v-4e9f8eed"]]);export{oe as default};
