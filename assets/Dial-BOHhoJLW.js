import{c as S,y as A,J as B,r as _,w as C,o as I,k as P,h as T,aw as X,l as F,m as E,n as c,v as V,O as f,q as n,t as Y,s as j,ay as $,az as q,ax as J,_ as U}from"./index-CJcjVGeL.js";const G={class:"potentiometer-scale elevation-5"},H={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},K=S({__name:"Dial",props:{miniWidget:{}},setup(W){const t=A(),e=B(W).miniWidget,p=_(0),v=_(-150);let h;C(()=>t.miniWidgetManagerVars(e.value.hash).configMenuOpen,a=>{a===!0&&(t.showElementPropsDrawer(e.value.hash),setTimeout(()=>{t.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const b=a=>{var i,l,r,d;let s;a==null||isNaN(Number(a))?s=((i=e.value.options.layout)==null?void 0:i.minValue)||0:s=Number(a),p.value=s;const o=300,u=((l=e.value.options.layout)==null?void 0:l.maxValue)-((r=e.value.options.layout)==null?void 0:r.minValue)||1;v.value=(s-((d=e.value.options.layout)==null?void 0:d.minValue))/u*o-150},k=()=>{var a;if(e.value.options.dataLakeVariable){h=$((a=e.value.options.dataLakeVariable)==null?void 0:a.name,o=>{b(o)});const s=t.getMiniWidgetLastValue(e.value.hash);b(s)}};C(()=>{var a;return(a=e.value.options.dataLakeVariable)==null?void 0:a.name},a=>{a&&k()},{immediate:!0}),I(()=>{(!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,t.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),k()});const R=P(()=>{var a;switch((a=e.value.options.layout)==null?void 0:a.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),z=a=>{a.preventDefault();const o=a.currentTarget.getBoundingClientRect(),u=o.left+o.width/2,i=o.top+o.height/2;let l=Math.atan2(a.clientY-i,a.clientX-u)*(180/Math.PI);const r=y=>{var L,w,D;const M=Math.atan2(y.clientY-i,y.clientX-u)*(180/Math.PI);let m=M-l;m>180?m-=360:m<-180&&(m+=360);let g=v.value+m;g=Math.max(-150,Math.min(150,g)),v.value=g,l=M;const N=300,O=(((L=e.value.options.layout)==null?void 0:L.maxValue)||100)-(((w=e.value.options.layout)==null?void 0:w.minValue)||0);if(p.value=(g+150)/N*O+(((D=e.value.options.layout)==null?void 0:D.minValue)||0),e.value.options.dataLakeVariable){if(t.editingMode)return;const x=Math.round(p.value);t.setMiniWidgetLastValue(e.value.hash,x),J(e.value.options.dataLakeVariable.name,x)}},d=()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",d)};document.addEventListener("mousemove",r),document.addEventListener("mouseup",d)};return T(()=>{e.value.options.dataLakeVariable&&(X(e.value.options.dataLakeVariable.id),h&&q(e.value.options.dataLakeVariable.name,h))}),(a,s)=>{var o,u,i,l,r;return F(),E("div",{id:"dial",class:V(["flex items-center w-auto",((o=n(t).elementToShowOnDrawer)==null?void 0:o.hash)===n(e).hash&&n(t).editingMode?"bg-[#00000010] ":"border-0"]),style:f({justifyContent:(u=n(e).options.layout)==null?void 0:u.align}),onClick:s[0]||(s[0]=d=>n(t).editingMode&&n(t).showElementPropsDrawer(n(e).hash))},[c("div",{class:V(["flex flex-row",n(t).editingMode?"pointer-events-none":"pointer-events-auto"])},[c("div",{class:V(["potentiometer-container w-full",R.value]),onMousedown:z},[c("div",G,[c("div",{class:"potentiometer-knob",style:f({transform:`rotate(${v.value}deg)`,background:((i=n(e).options.layout)==null?void 0:i.knobColor)||"#838383"})},[c("div",{class:"knob-notch",style:f({background:((l=n(e).options.layout)==null?void 0:l.notchColor)||"#222222"})},null,4)],4)])],34)],2),(r=n(e).options.layout)!=null&&r.showValue?(F(),E("div",H,Y(Math.round(p.value)||0),1)):j("",!0)],6)}}}),ee=U(K,[["__scopeId","data-v-1c1ba5df"]]);export{ee as default};
