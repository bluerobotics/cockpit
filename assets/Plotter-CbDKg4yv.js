import{bM as x,bJ as A,aY as K,aZ as J,be as Q,a$ as Y,k as O,bN as q,c as ce,K as fe,y as me,J as ge,r as j,L as pe,o as ve,bO as be,av as he,au as ye,w as $,aB as Ve,aF as ke,aH as Se,aE as we,l as I,m as T,q as s,n as c,H as r,N as d,ah as Ce,aQ as R,a2 as F,O as C,V as G,aI as D,U as W,S as xe,a5 as Le,Q as Me,a6 as Ne,F as Pe,_ as je}from"./index-BCFcAppG.js";const Z=x.reduce((t,i)=>(t[i]={type:[Boolean,String,Number],default:!1},t),{}),X=x.reduce((t,i)=>{const n="offset"+A(i);return t[n]={type:[String,Number],default:null},t},{}),ee=x.reduce((t,i)=>{const n="order"+A(i);return t[n]={type:[String,Number],default:null},t},{}),z={col:Object.keys(Z),offset:Object.keys(X),order:Object.keys(ee)};function $e(t,i,n){let u=t;if(!(n==null||n===!1)){if(i){const e=i.replace(t,"");u+=`-${e}`}return t==="col"&&(u="v-"+u),t==="col"&&(n===""||n===!0)||(u+=`-${n}`),u.toLowerCase()}}const Ie=["auto","start","end","center","baseline","stretch"],Te=K({cols:{type:[Boolean,String,Number],default:!1},...Z,offset:{type:[String,Number],default:null},...X,order:{type:[String,Number],default:null},...ee,alignSelf:{type:String,default:null,validator:t=>Ie.includes(t)},...J(),...Q()},"VCol"),E=Y()({name:"VCol",props:Te(),setup(t,i){let{slots:n}=i;const u=O(()=>{const e=[];let m;for(m in z)z[m].forEach(g=>{const v=t[g],k=$e(m,g,v);k&&e.push(k)});const p=e.some(g=>g.startsWith("v-col-"));return e.push({"v-col":!p||!t.cols,[`v-col-${t.cols}`]:t.cols,[`offset-${t.offset}`]:t.offset,[`order-${t.order}`]:t.order,[`align-self-${t.alignSelf}`]:t.alignSelf}),e});return()=>{var e;return q(t.tag,{class:[u.value,t.class],style:t.style},(e=n.default)==null?void 0:e.call(n))}}}),B=["start","end","center"],te=["space-between","space-around","space-evenly"];function U(t,i){return x.reduce((n,u)=>{const e=t+A(u);return n[e]=i(),n},{})}const Ee=[...B,"baseline","stretch"],le=t=>Ee.includes(t),ae=U("align",()=>({type:String,default:null,validator:le})),_e=[...B,...te],oe=t=>_e.includes(t),ne=U("justify",()=>({type:String,default:null,validator:oe})),Ae=[...B,...te,"stretch"],se=t=>Ae.includes(t),ie=U("alignContent",()=>({type:String,default:null,validator:se})),H={align:Object.keys(ae),justify:Object.keys(ne),alignContent:Object.keys(ie)},Oe={align:"align",justify:"justify",alignContent:"align-content"};function Be(t,i,n){let u=Oe[t];if(n!=null){if(i){const e=i.replace(t,"");u+=`-${e}`}return u+=`-${n}`,u.toLowerCase()}}const Ue=K({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:le},...ae,justify:{type:String,default:null,validator:oe},...ne,alignContent:{type:String,default:null,validator:se},...ie,...J(),...Q()},"VRow"),_=Y()({name:"VRow",props:Ue(),setup(t,i){let{slots:n}=i;const u=O(()=>{const e=[];let m;for(m in H)H[m].forEach(p=>{const g=t[p],v=Be(m,p,g);v&&e.push(v)});return e.push({"v-row--no-gutters":t.noGutters,"v-row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),e});return()=>{var e;return q(t.tag,{class:["v-row",u.value,t.class],style:t.style},(e=n.default)==null?void 0:e.call(n))}}}),Re={key:0,class:"w-full h-full flex items-center justify-center text-center text-white text-h5 font-weight-bold p-4 overflow-hidden"},Fe={key:1,class:"main"},Ge=["width","height"],De={class:"ml-2"},We={class:"ml-2 flex gap-x-8"},ze={class:"ml-2 flex gap-x-8"},He={class:"flex w-full justify-end my-2"},Ke=ce({__name:"Plotter",props:{widget:{}},setup(t){const i=fe(),n=me(),e=ge(t).widget,m=j([]);pe(()=>{Object.keys(e.value.options).length===0&&(e.value.options={backgroundColor:"rgba(0, 0, 0, 0.7)",lineColor:"rgba(255, 0, 0, 1.0)",dataLakeVariableId:void 0,maxSamples:1e3,limitSamples:!0,lineThickness:1})}),ve(()=>{g(e.value.options.dataLakeVariableId),m.value=Object.values(be()).filter(o=>o.type==="number")});const p=()=>{e.value.options.limitSamples&&(f.length===e.value.options.maxSamples+1?f.shift():f.length>e.value.options.maxSamples&&f.splice(0,f.length-e.value.options.maxSamples))},g=o=>{if(o===void 0){console.error("No data lake variable ID provided!");return}const l=e.value.options.dataLakeVariableId;l!==void 0&&he(l),ye(o,a=>{f.push(a),p(),S()})};$([e.value.options.maxSamples,e.value.options.limitSamples],()=>{p(),S()});const{width:v,height:k}=Ve(),y=O(()=>({width:e.value.size.width*v.value,height:e.value.size.height*k.value})),V=j(),L=j(),M=(o,l,a,b)=>{const P=o.measureText(l),h=4;o.fillStyle="rgba(0, 0, 0, 0.5)",o.fillRect(a-h,b-16-h,P.width+h*2,16+h*2),o.fillStyle=e.value.options.lineColor,o.fillText(l,a,b)},S=()=>{if(V.value===void 0||V.value===null)return;if(L.value===void 0){console.debug("Canvas context undefined!"),L.value=V.value.getContext("2d");return}const o=L.value,l=y.value.width,a=y.value.height;ke(o),o.clearRect(0,0,l,a),o.fillStyle=e.value.options.backgroundColor,o.fillRect(0,0,l,a),o.strokeStyle=e.value.options.lineColor,o.lineWidth=Math.max(e.value.options.lineThickness,1);try{if(f.length===0)return;N=Math.max(...f),w=Math.min(...f);const b=f[f.length-1];o.beginPath(),o.moveTo(0,a),f.forEach((P,h)=>{const ue=h*(l/f.length),de=a-(P-w)/(N-w)*a;o.lineTo(ue,de)}),o.stroke(),o.font="14px monospace",o.textBaseline="bottom",M(o,`Current: ${b.toFixed(2)}`,10,a-10),M(o,`Min: ${w.toFixed(2)}`,10,a-30),M(o,`Max: ${N.toFixed(2)}`,10,a-50)}catch(b){console.error("Error drawing graph:",b)}},f=[];let N=0,w=0;$([y,e.value.options],()=>{n.isWidgetVisible(e.value)&&Se(()=>S())});const re=we(V);return $(re,(o,l)=>{o&&!l&&S()}),(o,l)=>(I(),T(Pe,null,[s(e).options.dataLakeVariableId?(I(),T("div",Fe,[c("canvas",{ref_key:"canvasRef",ref:V,width:y.value.width,height:y.value.height},null,8,Ge)])):(I(),T("p",Re," Please open the Plotter widget configuration menu to select a variable to be plotted. ")),r(Ne,{modelValue:s(n).widgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":l[7]||(l[7]=a=>s(n).widgetManagerVars(s(e).hash).configMenuOpen=a),title:"Plotter config",variant:"text-only"},{content:d(()=>[r(_,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[l[8]||(l[8]=c("div",{class:"text-subtitle-1 font-weight-medium mb-4"},"Data Source",-1)),c("div",De,[r(Ce,{modelValue:s(e).options.dataLakeVariableId,"onUpdate:modelValue":[l[0]||(l[0]=a=>s(e).options.dataLakeVariableId=a),g],items:m.value,"item-title":"name","item-value":"id",label:"Data Lake variable",hint:"Select a variable to be plotted","persistent-hint":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),_:1})]),_:1}),r(_,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[l[11]||(l[11]=c("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Appearance",-1)),c("div",We,[r(R,{"close-on-content-click":!1},{activator:d(({props:a})=>[c("div",F(a,{class:"flex cursor-pointer"}),[l[9]||(l[9]=c("span",{class:"mt-1"},"Background color",-1)),c("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:s(e).options.backgroundColor})},null,4)],16)]),default:d(()=>[r(G,{class:"overflow-hidden",style:C(s(i).globalGlassMenuStyles)},{default:d(()=>[r(D,{modelValue:s(e).options.backgroundColor,"onUpdate:modelValue":l[1]||(l[1]=a=>s(e).options.backgroundColor=a),label:"Background","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(R,{"close-on-content-click":!1},{activator:d(({props:a})=>[c("div",F(a,{class:"flex cursor-pointer"}),[l[10]||(l[10]=c("span",{class:"mt-1"},"Line color",-1)),c("div",{class:"w-[30px] h-[30px] border-2 border-slate-700 rounded-lg cursor-pointer ml-2",style:C({backgroundColor:s(e).options.lineColor})},null,4)],16)]),default:d(()=>[r(G,{class:"overflow-hidden",style:C(s(i).globalGlassMenuStyles)},{default:d(()=>[r(D,{modelValue:s(e).options.lineColor,"onUpdate:modelValue":l[2]||(l[2]=a=>s(e).options.lineColor=a),label:"Line","hide-inputs":""},null,8,["modelValue"])]),_:1},8,["style"])]),_:1}),r(W,{modelValue:s(e).options.lineThickness,"onUpdate:modelValue":l[3]||(l[3]=a=>s(e).options.lineThickness=a),modelModifiers:{number:!0},type:"number",label:"Line thickness",variant:"outlined",density:"compact",rules:[a=>a>0||"Must be greater than 0"],width:"140px","hide-details":""},null,8,["modelValue","rules"])])]),_:1})]),_:1}),r(_,null,{default:d(()=>[r(E,{cols:"12"},{default:d(()=>[l[12]||(l[12]=c("div",{class:"text-subtitle-1 font-weight-medium mb-2"},"Data Points",-1)),c("div",ze,[r(xe,{modelValue:s(e).options.limitSamples,"onUpdate:modelValue":l[4]||(l[4]=a=>s(e).options.limitSamples=a),label:"Limit number of samples"},null,8,["modelValue"]),r(W,{modelValue:s(e).options.maxSamples,"onUpdate:modelValue":l[5]||(l[5]=a=>s(e).options.maxSamples=a),modelModifiers:{number:!0},type:"number",label:"Maximum samples",variant:"outlined",density:"comfortable",disabled:!s(e).options.limitSamples,rules:[a=>a>0||"Must be greater than 0"],hint:"Higher values will show more history but may impact performance",width:"220px"},null,8,["modelValue","disabled","rules"])])]),_:1})]),_:1})]),actions:d(()=>[c("div",He,[r(Le,{onClick:l[6]||(l[6]=a=>s(n).widgetManagerVars(s(e).hash).configMenuOpen=!1)},{default:d(()=>l[13]||(l[13]=[Me("Close")])),_:1})])]),_:1},8,["modelValue"])],64))}}),Qe=je(Ke,[["__scopeId","data-v-e1802d47"]]);export{Qe as default};
