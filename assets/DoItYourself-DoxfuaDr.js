import{c as K,a_ as J,a$ as q,b0 as G,K as Q,y as X,J as Z,r as g,k as O,L as ee,o as te,ae as se,D as ae,l as B,m as R,n as r,H as t,N as s,V as ne,O as x,q as m,af as U,Q as f,P as oe,R as le,b1 as re,s as ie,b2 as ue,a6 as M,W as de,F as ce,b3 as fe,b4 as h,b5 as w,_ as pe}from"./index-BNSr_zFG.js";import{V as me,a as T,b as L,c as D}from"./VExpansionPanels-D_pJ4rmB.js";function he(u){return new Worker(""+new URL("css.worker-Xlwe2hWs.js",import.meta.url).href,{name:u==null?void 0:u.name})}function ge(u){return new Worker(""+new URL("html.worker-BvRU5B8F.js",import.meta.url).href,{name:u==null?void 0:u.name})}function ve(u){return new Worker(""+new URL("json.worker-CpyesD6f.js",import.meta.url).href,{name:u==null?void 0:u.name})}const xe={class:"main"},we=["innerHTML"],Ce={key:0,class:"help-panel mb-4 p-4 rounded bg-white/5"},ye={class:"flex justify-between items-center px-4 w-full h-full"},Ve={class:"flex gap-x-10"},F=50,ke=K({__name:"DoItYourself",props:{widget:{}},setup(u){J(i=>({"0b4adc66":v.value})),self.MonacoEnvironment={getWorker(i,e){return e==="json"?new ve:e==="css"||e==="scss"||e==="less"?new he:e==="html"||e==="handlebars"||e==="razor"?new ge:e==="typescript"||e==="javascript"?new q:new G}};const $=Q(),C=X(),a=Z(u).widget,y=g(null),V=g(null),k=g(null),b=g(!1),j=g(["html","css","js"]);let n=null,o=null,l=null;const d={html:`<!-- Write your HTML code here -->
<div id="diy-container">
  <span>Create your own widget!</span>
</div>`,css:`/* Write your CSS code here */
#diy-container {
  width: 100%;
  height: 100%;
  padding: 1rem;
  background-color: white;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3rem;
  text-align: center;
  font-family: 'Roboto', sans-serif;
  font-weight: 500;
}`,js:`// Write your JavaScript code here
document.addEventListener('DOMContentLoaded', () => {
  // Your code here
});`},H=O(()=>{const i=a.value.options.html||d.html,e=a.value.options.css||d.css,c=a.value.options.js||d.js;return`${i}
<style>
${e}
</style>
<script>
${c}
<\/script>`}),E=(i,e,c)=>fe.create(i,{value:c,language:e,theme:"vs-dark",minimap:{enabled:!1},fontSize:14,lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,tabSize:2,wordWrap:"on",padding:{top:12,bottom:12}}),_=i=>{i.addCommand(h.CtrlCmd|w.Enter,()=>S()),i.addCommand(h.CtrlCmd|w.KeyS,()=>S()),i.addCommand(h.CtrlCmd|h.Alt|w.UpArrow,()=>{n&&n.hasTextFocus()&&o?o.focus():l&&l.hasTextFocus()&&n?n.focus():o&&o.hasTextFocus()&&l&&l.focus()}),i.addCommand(h.CtrlCmd|h.Alt|w.DownArrow,()=>{n&&n.hasTextFocus()&&l?l.focus():l&&l.hasTextFocus()&&o?o.focus():o&&o.hasTextFocus()&&n&&n.focus()})},z=async()=>{n||!y.value||l||!k.value||o||!V.value||(n=E(y.value,"html",a.value.options.html||d.html),l=E(k.value,"javascript",a.value.options.js||d.js),o=E(V.value,"css",a.value.options.css||d.css),n&&_(n),l&&_(l),o&&_(o))},I=async()=>{await z()},N=async()=>{W()},S=()=>{!n||!o||!l||(a.value.options.html=n.getValue(),a.value.options.css=o.getValue(),a.value.options.js=l.getValue(),A())},A=()=>{var p;const i=a.value.options.js||"",e=`diy-script-${a.value.hash}`;(p=document.getElementById(e))==null||p.remove();const c=document.createElement("script");c.type="text/javascript",c.textContent=i,c.id=e,document.body.appendChild(c)},P=()=>{!n||!o||!l||(n.setValue(a.value.options.html||d.html),o.setValue(a.value.options.css||d.css),l.setValue(a.value.options.js||d.js))},W=()=>{n&&(n.dispose(),n=null),o&&(o.dispose(),o=null),l&&(l.dispose(),l=null)},Y=()=>{C.widgetManagerVars(a.value.hash).configMenuOpen=!1,W()},v=O(()=>{const i=j.value.length;return i===0?`${F}vh`:`${Math.round(F/i)}vh`});return ee(()=>{a.value.options=Object.assign({},d,a.value.options)}),te(()=>{A()}),se(()=>{W()}),(i,e)=>{const c=ae("vue-draggable-resizable");return B(),R(ce,null,[r("div",xe,[r("div",{class:"w-full h-full",innerHTML:H.value},null,8,we)]),t(de,{modelValue:m(C).widgetManagerVars(m(a).hash).configMenuOpen,"onUpdate:modelValue":e[2]||(e[2]=p=>m(C).widgetManagerVars(m(a).hash).configMenuOpen=p),"max-width":m($).isOnSmallScreen?"100%":"800px",onAfterEnter:I,onAfterLeave:N},{default:s(()=>[t(c,{"drag-handle":".drag-handle",w:"auto",h:"auto",handles:["tm","mr","bm","ml"]},{default:s(()=>[t(ne,{class:"pa-2",style:x(m($).globalGlassMenuStyles)},{default:s(()=>[t(U,{class:"drag-handle absolute top-[12px] left-[12px] cursor-grab"},{default:s(()=>e[3]||(e[3]=[f("mdi-drag")])),_:1}),t(U,{class:"absolute top-[12px] right-[12px] cursor-pointer",onClick:e[0]||(e[0]=p=>b.value=!b.value)},{default:s(()=>e[4]||(e[4]=[f(" mdi-help-circle-outline ")])),_:1}),t(oe,{class:"w-full text-center mt-2 mb-2"},{default:s(()=>e[5]||(e[5]=[f("DIY widget configuration")])),_:1}),t(le,{class:"mx-2 flex flex-col gap-y-3"},{default:s(()=>[t(re,null,{default:s(()=>[b.value?(B(),R("div",Ce,e[6]||(e[6]=[r("h3",{class:"text-lg mb-2"},"Editor instructions",-1),r("ul",{class:"text-sm text-white/70 list-disc pl-4 space-y-1"},[r("li",null,"Use the HTML, CSS, and JS editors to create your custom widget"),r("li",null,"Changes are applied when you click Apply or press Cmd/Ctrl + Enter/S"),r("li",null,"Navigate between editors using Cmd/Ctrl + Option/Alt + ↑/↓"),r("li",null,"Reset to last saved state using the Reset button"),r("li",null,"Your code runs in the widget's context and has access to the DOM"),r("li",null,"You can use the console to debug your code"),r("li",null," You can use the data-lake system to inject or consume data from Cockpit. Check the docs for more information around this. "),r("li",null,"Click on each editor's header to expand it to full size")],-1)]))):ie("",!0)]),_:1}),t(me,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=p=>j.value=p),class:"editors-container",multiple:""},{default:s(()=>[t(T,{value:"html"},{default:s(()=>[t(L,{static:"",height:"36px",class:"text-white/60"},{default:s(()=>e[7]||(e[7]=[f(" HTML ")])),_:1}),t(D,{eager:""},{default:s(()=>[r("div",{ref_key:"htmlEditorContainer",ref:y,class:"editor-container",style:x({height:v.value})},null,4)]),_:1})]),_:1}),t(T,{value:"js"},{default:s(()=>[t(L,{static:"",height:"36px",class:"text-white/60"},{default:s(()=>e[8]||(e[8]=[f(" JS ")])),_:1}),t(D,{eager:""},{default:s(()=>[r("div",{ref_key:"jsEditorContainer",ref:k,class:"editor-container",style:x({height:v.value})},null,4)]),_:1})]),_:1}),t(T,{value:"css"},{default:s(()=>[t(L,{static:"",height:"36px",class:"text-white/60"},{default:s(()=>e[9]||(e[9]=[f(" CSS ")])),_:1}),t(D,{eager:""},{default:s(()=>[r("div",{ref_key:"cssEditorContainer",ref:V,class:"editor-container",style:x({height:v.value})},null,4)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ue,null,{default:s(()=>[r("div",ye,[t(M,{class:"text-white/60",variant:"text",onClick:Y},{default:s(()=>e[10]||(e[10]=[f("Close")])),_:1}),r("div",Ve,[t(M,{class:"text-white/60",variant:"text",onClick:P},{default:s(()=>e[11]||(e[11]=[f("Reset")])),_:1}),t(M,{class:"text-white",variant:"text",onClick:S},{default:s(()=>e[12]||(e[12]=[f("Apply")])),_:1})])])]),_:1})]),_:1},8,["style"])]),_:1})]),_:1},8,["modelValue","max-width"])],64)}}}),_e=pe(ke,[["__scopeId","data-v-529ba608"]]);export{_e as default};
