import{c as H,y as Z,J as ee,r as C,w as W,k as N,o as ae,aM as te,h as oe,l as M,m as c,n as p,s as g,x as _,N as O,v as l,aO as I,G as ne,t as le,aG as se,I as R,O as A,Q as K,a6 as U,a9 as ie,aJ as ue,a1 as j,aN as re,_ as de}from"./index-DyWRLZmV.js";const ve={class:"potentiometer-scale elevation-5"},ce={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},pe={class:"flex flex-col w-4 h-7 justify-between items-center"},b=0,P=100,S=300,me=H({__name:"Dial",props:{miniWidget:{}},setup($){const o=Z(),a=ee($).miniWidget,n=C(b),m=S/2,E=C(-m);let V;const u=C(!1),y=C(String(Math.round(n.value)||b));W(()=>o.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(o.showElementPropsDrawer(a.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const r=N(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.minValue)||b}),f=N(()=>{var e;return Number((e=a.value.options.layout)==null?void 0:e.maxValue)||P}),d=e=>{let t;e==null||isNaN(Number(e))?t=r.value:t=Number(e),n.value=t;const i=f.value-r.value;E.value=(t-r.value)/i*S-m},s=N(()=>{var e,t;return((t=(e=a.value.options)==null?void 0:e.dataLakeVariable)==null?void 0:t.persistent)===!0}),z=()=>{a.value.options.dataLakeVariable&&(V=ie(a.value.options.dataLakeVariable.id,e=>{d(e)}),d(ue(a.value.options.dataLakeVariable.id)))};W(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.id},(e,t)=>{t&&V&&j(t,V),e&&z()}),W(()=>[r.value,f.value],([e])=>{n.value=e,d(n.value)}),ae(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,o.updateElementOptions(a.value.hash,{layout:{minValue:b,maxValue:P,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable?(a.value.options.dataLakeVariable.allowUserToChangeValue||te({...a.value.options.dataLakeVariable,allowUserToChangeValue:!0}),z()):d(o.getMiniWidgetLastValue(a.value.hash))});const G=N(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),L=()=>{if(s.value&&!o.editingMode){const e=Math.round(n.value);o.setMiniWidgetLastValue(a.value.hash,e),re(a.value.options.dataLakeVariable.id,e)}};let B=0;const J=e=>{if(e.preventDefault(),!s.value)return;const i=e.currentTarget.getBoundingClientRect(),D=i.left+i.width/2,F=i.top+i.height/2,h=x=>{const w=Math.atan2(x.clientX-D,F-x.clientY)*180/Math.PI;if(Math.abs(w-B)>m)return;let v=Math.max(-m,Math.min(m,w));E.value=v,B=v;const q=f.value-r.value;n.value=(v+m)/S*q+r.value,a.value.options.dataLakeVariable&&L()},k=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",k)},X=()=>{n.value<f.value&&(d(n.value+1),L())},Y=()=>{n.value>r.value&&(d(n.value-1),L())},Q=()=>{o.editingMode||!s.value||(u.value=!0,y.value=String(Math.round(n.value)||b))},T=()=>{let e=parseFloat(y.value);isNaN(e)&&(e=Math.round(n.value)||b),e=Math.max(r.value,Math.min(e,f.value)),d(e),L(),u.value=!1};return oe(()=>{a.value.options.dataLakeVariable&&V&&j(a.value.options.dataLakeVariable.id,V)}),(e,t)=>{var i,D,F,h,k,x,w;return c(),M("div",{id:"dial",class:_(["flex items-center w-auto",((i=l(o).elementToShowOnDrawer)==null?void 0:i.hash)===l(a).hash&&l(o).editingMode?"bg-[#00000010] ":"border-0"]),style:O({justifyContent:(D=l(a).options.layout)==null?void 0:D.align}),onClick:t[2]||(t[2]=v=>l(o).editingMode&&l(o).showElementPropsDrawer(l(a).hash))},[p("div",{class:_(["flex flex-row",l(o).editingMode||!s.value?"pointer-events-none":"pointer-events-auto"])},[p("div",{class:_(["potentiometer-container w-full",G.value]),onMousedown:J,onClick:t[0]||(t[0]=v=>u.value=!1)},[p("div",ve,[p("div",{class:"potentiometer-knob",style:O({transform:`rotate(${E.value}deg)`,background:((F=l(a).options.layout)==null?void 0:F.knobColor)||"#838383"})},[p("div",{class:"knob-notch",style:O({background:((h=l(a).options.layout)==null?void 0:h.notchColor)||"#222222"})},null,4)],4)])],34),((k=l(a).options.layout)==null?void 0:k.minValue)>=((x=l(a).options.layout)==null?void 0:x.maxValue)?(c(),M("p",ce," Min value is larger than Max value ")):g("",!0)],2),(w=l(a).options.layout)!=null&&w.showValue?(c(),M("div",{key:0,class:"flex",onKeydown:I(T,["esc"])},[p("div",{class:_(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",s.value&&u.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[!u.value||!s.value?(c(),M("div",{key:0,onClick:Q},le(Math.round(n.value)||0),1)):g("",!0),u.value&&s.value?ne((c(),M("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=v=>y.value=v),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:I(T,["enter"]),onBlur:T},null,544)),[[se,y.value]]):g("",!0)],2),p("div",pe,[!u.value&&s.value?(c(),R(U,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:X},{default:A(()=>t[3]||(t[3]=[K("mdi-plus")])),_:1,__:[3]})):g("",!0),!u.value&&s.value?(c(),R(U,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:Y},{default:A(()=>t[4]||(t[4]=[K("mdi-minus")])),_:1,__:[4]})):g("",!0)])],32)):g("",!0)],6)}}}),Ve=de(me,[["__scopeId","data-v-e8d0f7cd"]]);export{Ve as default};
