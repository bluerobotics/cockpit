import{c as O,y as z,J as B,r as C,w as P,o as T,au as I,k as X,h as Y,av as j,aw as $,l as D,m as _,n as p,v as h,O as V,q as n,t as q,s as J,ax as U,_ as G}from"./index-BCFcAppG.js";const H={class:"potentiometer-scale elevation-5"},K={key:0,class:"value-display bg-[#FFFFFF22] border-[#FFFFFF44] border-[1px] rounded-md p-[2px] min-w-9 text-center elevation-1"},Q=O({__name:"Dial",props:{miniWidget:{}},setup(F){const a=z(),e=B(F).miniWidget,c=C(0),v=C(-150);P(()=>a.miniWidgetManagerVars(e.value.hash).configMenuOpen,t=>{t===!0&&(a.showElementPropsDrawer(e.value.hash),setTimeout(()=>{a.miniWidgetManagerVars(e.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const f=t=>{var s,r,u,d;let i;t==null||isNaN(Number(t))?i=((s=e.value.options.layout)==null?void 0:s.minValue)||0:i=Number(t),c.value=i;const o=300,l=((r=e.value.options.layout)==null?void 0:r.maxValue)-((u=e.value.options.layout)==null?void 0:u.minValue)||1;v.value=(i-((d=e.value.options.layout)==null?void 0:d.minValue))/l*o-150};T(()=>{var t;if((!e.value.options||Object.keys(e.value.options).length===0)&&(e.value.isCustomElement=!0,a.updateElementOptions(e.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",actionVariable:void 0})),e.value.options.actionVariable){I((t=e.value.options.actionVariable)==null?void 0:t.name,o=>{f(o)});const i=a.getMiniWidgetLastValue(e.value.hash);f(i)}});const A=X(()=>{var t;switch((t=e.value.options.layout)==null?void 0:t.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}}),E=t=>{t.preventDefault();const o=t.currentTarget.getBoundingClientRect(),l=o.left+o.width/2,s=o.top+o.height/2,r=t.clientX-l,u=t.clientY-s,d=Math.atan2(u,r)*(180/Math.PI),R=v.value,b=M=>{var w,k,x;const W=M.clientX-l,S=M.clientY-s;let m=Math.atan2(S,W)*(180/Math.PI)-d;m>180?m-=360:m<-180&&(m+=360);let g=R+m;g=Math.max(-150,Math.min(150,g)),v.value=g;const L=300,N=((w=e.value.options.layout)==null?void 0:w.maxValue)-((k=e.value.options.layout)==null?void 0:k.minValue)||1;if(c.value=(g+150)/L*N+((x=e.value.options.layout)==null?void 0:x.minValue),e.value.options.actionVariable){if(a.editingMode)return;a.setMiniWidgetLastValue(e.value.hash,Math.round(c.value)),U(e.value.options.actionVariable.name,Math.round(c.value))}},y=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",y)};return Y(()=>{e.value.options.actionVariable&&(j(e.value.options.actionVariable.name),$(e.value.options.actionVariable.id))}),(t,i)=>{var o,l,s,r,u;return D(),_("div",{id:"dial",class:h(["flex items-center w-auto",((o=n(a).elementToShowOnDrawer)==null?void 0:o.hash)===n(e).hash&&n(a).editingMode?"bg-[#00000010] ":"border-0"]),style:V({justifyContent:(l=n(e).options.layout)==null?void 0:l.align}),onClick:i[0]||(i[0]=d=>n(a).editingMode&&n(a).showElementPropsDrawer(n(e).hash))},[p("div",{class:h(["flex flex-row",n(a).editingMode?"pointer-events-none":"pointer-events-auto"])},[p("div",{class:h(["potentiometer-container w-full",A.value]),onMousedown:E},[p("div",H,[p("div",{class:"potentiometer-knob",style:V({transform:`rotate(${v.value}deg)`,background:((s=n(e).options.layout)==null?void 0:s.knobColor)||"#838383"})},[p("div",{class:"knob-notch",style:V({background:((r=n(e).options.layout)==null?void 0:r.notchColor)||"#222222"})},null,4)],4)])],34)],2),(u=n(e).options.layout)!=null&&u.showValue?(D(),_("div",K,q(Math.round(c.value)||0),1)):J("",!0)],6)}}}),ae=G(Q,[["__scopeId","data-v-4ec050d3"]]);export{ae as default};
