import{c as ee,y as ae,J as te,r as M,w as E,o as oe,aA as ne,k as le,h as ie,l as p,m as x,n as v,v as L,O as W,q as i,s as f,aD as O,t as se,G as ue,av as re,I as K,N as U,Q as P,af as j,at as de,aB as X,aC as me,_ as ce}from"./index-B36CAGpo.js";const pe={class:"potentiometer-scale elevation-5"},ve={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},Ve={class:"flex flex-col w-4 h-7 justify-between items-center"},ge=ee({__name:"Dial",props:{miniWidget:{}},setup(Y){const o=ae(),a=te(Y).miniWidget,l=M(0),k=M(-150);let D;const d=M(!1),y=M(String(Math.round(l.value)||0));E(()=>o.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(o.showElementPropsDrawer(a.value.hash),setTimeout(()=>{o.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const V=e=>{var g,c,m;let t;e==null||isNaN(Number(e))?t=Number((g=a.value.options.layout)==null?void 0:g.minValue)||0:t=Number(e),l.value=t;const n=300,s=Number((c=a.value.options.layout)==null?void 0:c.minValue)||0,u=(Number((m=a.value.options.layout)==null?void 0:m.maxValue)||100)-s;k.value=(t-s)/u*n-150},_=()=>{var e;if(a.value.options.dataLakeVariable){D=de((e=a.value.options.dataLakeVariable)==null?void 0:e.name,n=>{V(n)});const t=o.getMiniWidgetLastValue(a.value.hash);V(t)}};E(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.name},e=>{e&&_()},{immediate:!0}),E(()=>{var e,t;return[Number((e=a.value.options.layout)==null?void 0:e.minValue)||0,Number((t=a.value.options.layout)==null?void 0:t.maxValue)||100]},([e])=>{l.value=e,V(l.value)},{immediate:!0}),oe(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,o.updateElementOptions(a.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),a.value.options.dataLakeVariable&&!a.value.options.dataLakeVariable.allowUserToChangeValue&&ne({...a.value.options.dataLakeVariable,allowUserToChangeValue:!0}),_()});const $=le(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}});let F=0,C=0;const N=()=>{if(a.value.options.dataLakeVariable&&!o.editingMode){const e=Math.round(l.value);o.setMiniWidgetLastValue(a.value.hash,e),X(a.value.options.dataLakeVariable.name,e)}},q=e=>{e.preventDefault();const n=e.currentTarget.getBoundingClientRect(),s=n.left+n.width/2,r=n.top+n.height/2,u=Math.atan2(e.clientY-r,e.clientX-s)*180/Math.PI;F=u,C=u;const c=k.value-u,m=T=>{var S,z;const B=Math.atan2(T.clientY-r,T.clientX-s)*180/Math.PI;let h=B-F;h>180?h-=360:h<-180&&(h+=360);const I=C+h;F=B,C=I;let w=I+c;w=Math.max(-150,Math.min(150,w)),k.value=w;const H=300,R=((S=a.value.options.layout)==null?void 0:S.minValue)||0,Z=(((z=a.value.options.layout)==null?void 0:z.maxValue)||100)-R;l.value=(w+150)/H*Z+R,a.value.options.dataLakeVariable&&N()},b=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",b)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",b)},G=()=>{var t;const e=((t=a.value.options.layout)==null?void 0:t.maxValue)||100;l.value<e&&(V(l.value+1),N())},J=()=>{var t;const e=((t=a.value.options.layout)==null?void 0:t.minValue)||0;l.value>e&&(V(l.value-1),N())},Q=()=>{o.editingMode||(d.value=!0,y.value=String(Math.round(l.value)||0))},A=()=>{var s,r;let e=parseFloat(y.value);isNaN(e)&&(e=Math.round(l.value)||0);const t=((s=a.value.options.layout)==null?void 0:s.minValue)||0,n=((r=a.value.options.layout)==null?void 0:r.maxValue)||100;if(e>n&&(e=n),e<t&&(e=t),V(e),a.value.options.dataLakeVariable&&!o.editingMode){const u=Math.round(e);o.setMiniWidgetLastValue(a.value.hash,u),X(a.value.options.dataLakeVariable.name,u)}d.value=!1};return ie(()=>{a.value.options.dataLakeVariable&&D&&me(a.value.options.dataLakeVariable.name,D)}),(e,t)=>{var n,s,r,u,g,c,m;return p(),x("div",{id:"dial",class:L(["flex items-center w-auto",((n=i(o).elementToShowOnDrawer)==null?void 0:n.hash)===i(a).hash&&i(o).editingMode?"bg-[#00000010] ":"border-0"]),style:W({justifyContent:(s=i(a).options.layout)==null?void 0:s.align}),onClick:t[2]||(t[2]=b=>i(o).editingMode&&i(o).showElementPropsDrawer(i(a).hash))},[v("div",{class:L(["flex flex-row",i(o).editingMode?"pointer-events-none":"pointer-events-auto"])},[v("div",{class:L(["potentiometer-container w-full",$.value]),onMousedown:q,onClick:t[0]||(t[0]=b=>d.value=!1)},[v("div",pe,[v("div",{class:"potentiometer-knob",style:W({transform:`rotate(${k.value}deg)`,background:((r=i(a).options.layout)==null?void 0:r.knobColor)||"#838383"})},[v("div",{class:"knob-notch",style:W({background:((u=i(a).options.layout)==null?void 0:u.notchColor)||"#222222"})},null,4)],4)])],34),((g=i(a).options.layout)==null?void 0:g.minValue)>=((c=i(a).options.layout)==null?void 0:c.maxValue)?(p(),x("p",ve," Min value is larger than Max value ")):f("",!0)],2),(m=i(a).options.layout)!=null&&m.showValue?(p(),x("div",{key:0,class:"flex",onKeydown:O(A,["esc"])},[v("div",{class:L(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",d.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[d.value?f("",!0):(p(),x("div",{key:0,onClick:Q},se(Math.round(l.value)||0),1)),d.value?ue((p(),x("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=b=>y.value=b),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:O(A,["enter"]),onBlur:A},null,544)),[[re,y.value]]):f("",!0)],2),v("div",Ve,[d.value?f("",!0):(p(),K(j,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:G},{default:U(()=>t[3]||(t[3]=[P("mdi-plus")])),_:1})),d.value?f("",!0):(p(),K(j,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:J},{default:U(()=>t[4]||(t[4]=[P("mdi-minus")])),_:1}))])],32)):f("",!0)],6)}}}),xe=ce(ge,[["__scopeId","data-v-0542cd67"]]);export{xe as default};
