import{c as Ge,K as Ze,aq as je,ax as ft,r as c,k as E,w as g,aY as be,o as Ye,ay as H,I as z,m as w,O as v,H as u,V as qe,N as ue,v as n,P as Ke,n as q,a7 as F,a6 as ze,Q as D,R as Qe,az as gt,l as K,F as Je,q as ht,aA as bt,bO as yt,a_ as kt,x as ye,t as xt,S as Ne,s as R,U as wt,aP as Ct,am as Mt,bH as Tt,W as Xe,_ as et,bD as Vt,J as Et,af as It,u as Lt,M as Ue,Y as Re,L as St,bP as _t,bQ as r,j as Ot,bR as k,al as Ft,aU as Pt,bS as At,bT as $t,bU as We,bV as Bt,bW as Ht,bX as Dt,a0 as zt,y as Nt,bj as Ut,G as Rt,a5 as re,aG as Y,a4 as ce,bY as Wt,ad as Gt,bZ as Zt,b_ as jt}from"./index-Dk-z1IUT.js";const Yt={class:"flex justify-end"},qt={key:0,class:"fixed top-[80px] right-5"},Kt={key:1,class:"flex w-full items-center"},Qt={class:"flex justify-between w-full py-1 px-2 pt-3"},Jt={class:"flex items-center"},Xt=Ge({__name:"MissionChecklist",props:{modelValue:{type:Boolean}},emits:["update:modelValue","confirmed","dismissed"],setup(de,{emit:te}){const T=Ze(),V=je(),ve=de,s=te,m=ft("cockpit-pre-arm-checklist",[]),o=c({}),L=c(""),S=c(null),h=c(!1),P=E(()=>ve.modelValue),_=()=>{const p={};for(const i of m.value??[])p[i.id]=!1;o.value=p},Q=E(()=>{if(!V.showChecklistBeforeArm)return!0;const p=m.value??[];return p.length>0&&p.every(i=>o.value[i.id]===!0)});g(()=>P.value,p=>{p?(_(),be(()=>{var i,d;return(d=(i=S.value)==null?void 0:i.focus)==null?void 0:d.call(i)})):(o.value={},h.value=!1)}),g(()=>m.value,p=>{if(!P.value)return;const i={...o.value},d={};for(const x of p??[])d[x.id]=!0,x.id in i||(i[x.id]=!1);for(const x of Object.keys(i)){const A=Number(x);d[A]||delete i[A]}o.value=i},{deep:!0});const N=async()=>{var d,x;const p=L.value.trim();if(!p)return;const i={id:Date.now(),text:p};m.value.push(i),P.value&&(o.value[i.id]=!1),L.value="",await be(),(x=(d=S.value)==null?void 0:d.focus)==null||x.call(d)},oe=p=>{if(m.value=m.value.filter(i=>i.id!==p),p in o.value){const i={...o.value};delete i[p],o.value=i}},W=()=>{s("dismissed"),s("update:modelValue",!1)},J=()=>{s("confirmed",!0),s("update:modelValue",!1)};return Ye(()=>{m.value.length===0&&(m.value=[{id:Date.now(),text:"Ensure the vehicle is safe to launch"}]),P.value&&_()}),g(()=>V.showChecklistBeforeArm,p=>{p||H({message:"Pre-arm checklist disabled. You can re-enable it in Settings → Mission → Enable pre-arm checklist.",variant:"info",duration:5e3})},{immediate:!0}),(p,i)=>(w(),z(Xe,{modelValue:P.value,"onUpdate:modelValue":i[4]||(i[4]=d=>P.value=d),"max-width":"600",scrollable:"",persistent:""},{default:v(()=>[u(qe,{style:ue(n(T).globalGlassMenuStyles),class:"rounded-lg"},{default:v(()=>[u(Ke,{class:"text-center relative pt-3"},{default:v(()=>[i[6]||(i[6]=q("h6",{class:"ml-4"},"Warning! Your vehicle is about to be armed",-1)),u(F,{icon:"",variant:"text",color:"white",class:"absolute right-1 top-1","aria-label":"Close",onClick:W},{default:v(()=>[u(ze,null,{default:v(()=>i[5]||(i[5]=[D("mdi-close")])),_:1,__:[5]})]),_:1})]),_:1,__:[6]}),u(Qe,{class:"mt-[-10px]"},{default:v(()=>[u(gt,{lines:"one",theme:"dark",class:"bg-transparent"},{default:v(()=>[(w(!0),K(Je,null,ht(n(m),d=>(w(),z(bt,{key:d.id,theme:"dark"},yt({prepend:v(()=>[u(Ne,{modelValue:o.value[d.id],"onUpdate:modelValue":x=>o.value[d.id]=x,class:"mt-0","hide-details":"",density:"compact",disabled:!n(V).showChecklistBeforeArm},null,8,["modelValue","onUpdate:modelValue","disabled"])]),default:v(()=>[u(kt,{class:ye([{"line-through opacity-60":o.value[d.id]},{"opacity-50":!n(V).showChecklistBeforeArm}])},{default:v(()=>[D(xt(d.text),1)]),_:2},1032,["class"])]),_:2},[h.value&&n(m).length>1?{name:"append",fn:v(()=>[u(F,{icon:"",variant:"text",disabled:!n(V).showChecklistBeforeArm,onClick:x=>oe(d.id)},{default:v(()=>[u(ze,null,{default:v(()=>i[7]||(i[7]=[D("mdi-close")])),_:1,__:[7]})]),_:2},1032,["disabled","onClick"])]),key:"0"}:void 0]),1024))),128))]),_:1}),q("div",Yt,[h.value?(w(),K("div",Kt,[h.value?(w(),z(wt,{key:0,ref_key:"newItemInput",ref:S,modelValue:L.value,"onUpdate:modelValue":i[1]||(i[1]=d=>L.value=d),disabled:!n(V).showChecklistBeforeArm,variant:"filled",density:"compact",placeholder:"Type an item and press Enter","hide-details":"",class:"ml-6 w-[80%]","append-inner-icon":"mdi-plus",onKeyup:Ct(N,["enter"]),"onClick:appendInner":N},null,8,["modelValue","disabled"])):R("",!0),u(F,{"prepend-icon":"mdi-check",disabled:!n(V).showChecklistBeforeArm,variant:"text",color:"white",size:"small",class:"elevation-1 bg-[#FFFFFF15] hover:bg-[#FFFFFF22] ml-10",onClick:i[2]||(i[2]=()=>{h.value=!1,N()})},{default:v(()=>i[9]||(i[9]=[D("Done")])),_:1,__:[9]},8,["disabled"])])):(w(),K("div",qt,[u(F,{"prepend-icon":"mdi-format-list-checks",disabled:!n(V).showChecklistBeforeArm,variant:"text",color:"white",size:"small",class:"elevation-1 bg-[#FFFFFF15] hover:bg-[#FFFFFF22]",onClick:i[0]||(i[0]=d=>h.value=!0)},{default:v(()=>i[8]||(i[8]=[D(" Edit Items ")])),_:1,__:[8]},8,["disabled"])]))])]),_:1}),u(Mt,{class:"flex center w-[80%]",inset:""}),u(Tt,null,{default:v(()=>[q("div",Qt,[u(F,{variant:"text",onClick:W},{default:v(()=>i[10]||(i[10]=[D("Cancel")])),_:1,__:[10]}),q("div",Jt,[u(Ne,{"model-value":!n(V).showChecklistBeforeArm,class:"mt-0 scale-[0.8]","hide-details":"",density:"compact","onUpdate:modelValue":i[3]||(i[3]=d=>n(V).showChecklistBeforeArm=!d)},null,8,["model-value"]),i[11]||(i[11]=q("p",{class:"text-xs text-center ml-2"},"Don't show this checklist again",-1))]),u(F,{color:"#ffffff33",class:ye({"opacity-30":!Q.value}),variant:"flat",disabled:!Q.value,onClick:J},{default:v(()=>i[12]||(i[12]=[D("Go")])),_:1,__:[12]},8,["class","disabled"])])]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"]))}}),eo=et(Xt,[["__scopeId","data-v-b0b8e43a"]]),to=["id"],oo=Ge({__name:"Map",props:{widget:{}},setup(de){var De;Vt(e=>({"36e5a2fc":ct.value}));const te=de,T=Et(te).widget,V=Ze(),{showDialog:ve}=It(),s=Lt(),m=je(),o=c(),L=c(m.defaultMapZoom),S=c(m.defaultMapCenter),h=c(),P=E(()=>`map-${T.value.hash}`),_=c(!1),Q=c(!1),N=c([]),oe=c(),W=c(!1),J=c(!1),p=c(!1);let i;const d=e=>{e.touches.length>1&&(J.value=!0,B.value&&ne(),clearTimeout(i))},x=e=>{e.touches.length<=1&&(i=window.setTimeout(()=>J.value=!1,300))},A=c(null),I=c({});Ue.registerUsage(Re.latitude),Ue.registerUsage(Re.longitude),St(()=>{Object.keys(T.value.options).length===0&&(T.value.options={showVehiclePath:!0}),C.enableAutoUpdate()});const ke=r.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:23,maxNativeZoom:19,attribution:"© OpenStreetMap"}),xe=r.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:23,maxNativeZoom:19,attribution:"© Esri World Imagery"}),we=r.tileLayer("https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",{maxZoom:18,attribution:"© OpenSeaMap contributors"}),Ce=r.tileLayer.wms("https://geoserver.openseamap.org/geoserver/gwc/service/wms",{layers:"gebco2021:gebco_2021",format:"image/png",transparent:!0,version:"1.1.1",attribution:"© GEBCO, OpenSeaMap",tileSize:256,maxZoom:19}),tt={OpenStreetMap:ke,"Esri World Imagery":xe},ot={Seamarks:we,"Marine Profile":Ce},G=c(),Me=Ot(G),Te=r.control.zoom({position:"bottomright"}),Ve=r.control.layers(tt,ot);g(_,()=>{o.value!==void 0&&(_.value?(o.value.addControl(Te),o.value.addControl(Ve)):(o.value.removeControl(Te),o.value.removeControl(Ve)))}),g(Me,()=>{_.value=Me.value}),Ye(async()=>{var e,t;(e=G.value)==null||e.addEventListener("touchstart",d,{passive:!0}),(t=G.value)==null||t.addEventListener("touchend",x,{passive:!0}),o.value=r.map(P.value,{layers:[ke,xe,we,Ce],attributionControl:!1}).setView(S.value,L.value),o.value.removeControl(o.value.zoomControl),o.value.on("click",a=>{y.value=[a.latlng.lat,a.latlng.lng]}),o.value.on("moveend",()=>{if(o.value===void 0)return;let{lat:a,lng:l}=o.value.getCenter();a&&l&&(S.value=[a,l])}),o.value.on("dragstart",()=>{W.value=!0}),o.value.on("dragend",()=>{setTimeout(()=>W.value=!1,200)}),o.value.on("zoomend",()=>{var a;B.value=!1,o.value!==void 0&&(L.value=((a=o.value)==null?void 0:a.getZoom())??S.value)}),o.value.on("contextmenu",a=>{y.value=[a.latlng.lat,a.latlng.lng]}),C.enableAutoUpdate(),window.addEventListener("keydown",_e),M.value?C.goToTarget(k.VEHICLE):C.goToTarget(k.HOME),!s.isVehicleOnline&&m.vehicleMission.length&&ge(m.vehicleMission),Q.value=!0,await me()});const at={open:e=>{if(!o.value||J.value||W.value)return;e.preventDefault(),e.stopPropagation();const t=o.value.mouseEventToContainerPoint(e),a=o.value.containerPointToLatLng(t);y.value=[a.lat,a.lng],oe.value.openAt(e),B.value=!0},close:()=>{ne()}},Ee=()=>{var e;(e=o.value)==null||e.eachLayer(t=>{(t instanceof r.Marker||t instanceof r.Polyline&&t.options.color==="#358AC3")&&o.value.removeLayer(t)}),N.value=[],ae.value=void 0,U.value=void 0,j.value=void 0,$.value=void 0},me=async()=>{Q.value&&(Ee(),s.isVehicleOnline?await Fe():m.vehicleMission.length&&ge(m.vehicleMission))};g(()=>s.isVehicleOnline,()=>{me()}),g(()=>m.vehicleMissionRevision,()=>{me()}),Ft(()=>{var e,t;C.disableAutoUpdate(),window.removeEventListener("keydown",_e),o.value&&(o.value.off("contextmenu"),Object.values(I.value).forEach(a=>a.remove()),I.value={}),(e=G.value)==null||e.removeEventListener("touchstart",d),(t=G.value)==null||t.removeEventListener("touchend",x)}),g(S,(e,t)=>{var a;e.toString()!==t.toString()&&((a=o.value)==null||a.panTo(e))}),g(o,(e,t)=>{o.value!==void 0&&(e==null?void 0:e.options)===void 0&&(o.value=t)}),g(L,(e,t)=>{var a;e!==t&&(B.value=!1,(a=o.value)==null||a.setZoom(L.value))}),g(te.widget,()=>{var e;(e=o.value)==null||e.invalidateSize()});const Z=c(void 0),C=new _t(e=>Z.value=e,e=>S.value=e);C.setTrackableTarget(k.VEHICLE,()=>M.value),C.setTrackableTarget(k.HOME,()=>h.value);const M=E(()=>s.coordinates.latitude?[s.coordinates.latitude,s.coordinates.longitude]:void 0),pe=E(()=>{var e;return s.attitude.yaw?Pt((e=s.attitude)==null?void 0:e.yaw):0}),Ie=E(()=>{const e=s.lastHeartbeat;return e?`${At(e??0,{includeSeconds:!0})} ago`:"never"}),{history:it}=$t(M);(De=navigator==null?void 0:navigator.geolocation)==null||De.watchPosition(e=>{h.value||(h.value=[e.coords.latitude,e.coords.longitude])},e=>console.error(`Failed to get position: (${e.code}) ${e.message}`),{enableHighAccuracy:!1,timeout:5e3,maximumAge:0});let Le=!0;g([h,o],async()=>{h.value===S.value||!o.value||!Le||(C.goToTarget(k.HOME),Le=!1)});const $=c();g(s.coordinates,()=>{if(!(!o.value||!M.value)){if($.value===void 0){let e=Bt;s.vehicleType===We.MAV_TYPE_SURFACE_BOAT?e=Ht:s.vehicleType===We.MAV_TYPE_SUBMARINE&&(e=Dt);const t=r.divIcon({className:"vehicle-marker",html:`<img src="${e}" style="width: 64px; height: 64px;">`,iconSize:[64,64],iconAnchor:[32,32]});$.value=r.marker(M.value,{icon:t});const a=r.tooltip({content:"No data available",className:"waypoint-tooltip",offset:[40,0]});$.value.bindTooltip(a),o.value.addLayer($.value)}$.value.setLatLng(M.value)}}),g(M,(e,t)=>{Z.value===k.VEHICLE||t!==void 0||C.follow(k.VEHICLE)}),g([M,pe,Ie,()=>s.isArmed],()=>{var t,a,l,b,f;if($.value===void 0)return;(b=$.value.getTooltip())==null||b.setContent(`
    <p>Coordinates: ${(t=M.value)==null?void 0:t[0].toFixed(6)}, ${(a=M.value)==null?void 0:a[1].toFixed(6)}</p>
    <p>Velocity: ${((l=s.velocity.ground)==null?void 0:l.toFixed(2))??"N/A"} m/s</p>
    <p>Heading: ${pe.value.toFixed(2)}°</p>
    <p>${s.isArmed?"Armed":"Disarmed"}</p>
    <p>Last seen: ${Ie.value}</p>
  `);const e=(f=$.value.getElement())==null?void 0:f.querySelector("img");e&&(e.style.transform=`rotate(${pe.value}deg)`)});const U=c();g(h,()=>{if(o.value===void 0)return;const e=h.value;if(e!==void 0)if(U.value)U.value.setLatLng(e);else{U.value=r.marker(e,{icon:r.divIcon({className:"marker-icon",iconSize:[24,24],iconAnchor:[12,12]}),draggable:!0});const t=r.tooltip({content:'<i class="mdi mdi-home-map-marker text-[18px] "></i>',permanent:!0,direction:"center",className:"waypoint-tooltip",opacity:1});U.value.bindTooltip(t),U.value.on("dragend",a=>{const b=a.target.getLatLng();he([b.lat,b.lng])}),o.value.addLayer(U.value)}});const ae=c();g(N,e=>{o.value&&(ae.value||(ae.value=r.polyline([],{color:"#358AC3"}).addTo(o.value)),ae.value.setLatLngs(e.map(t=>t.coordinates)),e.forEach((t,a)=>{var f;const l=r.marker(t.coordinates);l.setIcon(r.divIcon({className:"marker-icon",iconSize:[16,16],iconAnchor:[8,8]}));const b=r.tooltip({content:a.toString(),permanent:!0,direction:"center",className:"waypoint-tooltip",opacity:1});l.bindTooltip(b),(f=o.value)==null||f.addLayer(l)}))},{deep:!0});const fe=c();g(it,e=>{if(o.value===void 0||e===void 0)return;fe.value===void 0&&(fe.value=r.polyline([],{color:"#ffff00"}).addTo(o.value));const t=e.filter(a=>a.snapshot!==void 0).map(a=>a.snapshot);fe.value.setLatLngs(t)});const B=c(!1),y=c(null),Se=c(),nt=zt([{item:"Set home waypoint",action:()=>ie("set-home-waypoint"),icon:"mdi-home-map-marker"},{item:"Place Point of Interest",action:()=>ie("place-poi"),icon:"mdi-map-marker-plus"},{item:"GoTo",action:()=>ie("goto"),icon:"mdi-crosshairs-gps"},{item:"Set default map position",action:()=>ie("set-default-map-position"),icon:"mdi-map-check"}]),j=c(),lt=async()=>{var e;if(!(!o.value||!y.value))try{await m.setDefaultMapPosition(y.value,L.value),H({message:"Default map position set",variant:"success"});const t=r.marker(y.value,{icon:r.divIcon({className:"marker-icon",iconSize:[24,24],iconAnchor:[12,12]})}).addTo(o.value),a=r.tooltip({content:'<i class="mdi mdi-map-check text-[18px] border-[1px] rounded-full px-[2px] py-[1px]"></i>',permanent:!0,direction:"center",className:"waypoint-tooltip",opacity:1});t.bindTooltip(a).openTooltip();const l=t.getElement(),b=(e=t.getTooltip())==null?void 0:e.getElement();[l,b].forEach(f=>{f&&(f.style.transition="opacity 1s",f.style.opacity="1")}),setTimeout(()=>{[l,b].forEach(f=>{f&&(f.style.opacity="0")}),setTimeout(()=>{var f;(f=o.value)==null||f.removeLayer(t)},1e3)},1500)}catch(t){console.error(t),H({message:"Failed to set default map position",variant:"error"})}},st=async()=>{if(!y.value||!o.value)return;j.value&&(o.value.removeLayer(j.value),j.value=void 0),j.value=r.marker(y.value,{icon:r.divIcon({className:"marker-icon",iconSize:[24,24],iconAnchor:[12,12]})}).addTo(o.value);const e=r.tooltip({content:'<i class="mdi mdi-crosshairs-gps border-[1px] rounded-full text-[18px] px-[2px] pt-[1px] "></i>',permanent:!0,direction:"center",className:"waypoint-tooltip",opacity:1});if(j.value.bindTooltip(e),y.value){const f=s.coordinates.altitude??0,O=y.value[0],ee=y.value[1];try{await s.goTo(0,0,0,0,O,ee,f)}catch(se){H({message:`GoTo request failed: ${se.message}`,variant:"error"})}}},ie=async e=>{switch(e){case"goto":{st();break}case"set-default-map-position":lt();break;case"place-poi":y.value&&A.value?A.value.openDialog(y.value):y.value?A.value||(H({message:"POI Manager (map widget) is not available.",variant:"error"}),console.error("Cannot open POI dialog, POI Manager (map widget) ref is not set.")):(H({message:"Cannot place Point of Interest without map coordinates.",variant:"error"}),console.error("Cannot open POI dialog without click coordinates for new POI"));break;case"set-home-waypoint":y.value&&he(y.value);break;default:console.warn("Unknown menu option selected:",e)}B.value=!1},ne=()=>{B.value=!1,o.value!==void 0&&Se.value!==void 0&&o.value.removeLayer(Se.value)},_e=e=>{e.key==="Escape"&&ne()},ge=e=>{e.forEach((t,a)=>{a===0?(h.value=t.coordinates,he(t.coordinates)):N.value.push(t)})},le=c(!1),Oe=c(0),Fe=async()=>{le.value=!0,Ee();const e=async t=>{Oe.value=t};try{const t=await s.fetchMission(e);ge(t),H({variant:"success",message:"Mission download succeeded!",duration:3e3})}catch(t){ve({variant:"error",title:"Mission download failed",message:t,timer:5e3})}finally{le.value=!1}},he=async e=>{const t=[e[0],e[1]];h.value=t,await s.setHomeWaypoint(t,0),B.value&&(B.value=!1)},Pe=async()=>{try{await s.startMission()}catch{H({message:"Failed to start mission.",variant:"error"})}},rt=async()=>{if(m.showChecklistBeforeArm){p.value=!0;return}Pe()},X=Nt(),ct=E(()=>`${Math.max(-X.widgetClearanceForVisibleArea(T.value).bottom,0)}px`),Ae=E(()=>`${Math.max(-X.widgetClearanceForVisibleArea(T.value).top,0)}px`),ut=E(()=>s.isVehicleOnline?"Download the mission that is stored in the vehicle.":"Cannot download mission (vehicle offline)."),dt=E(()=>s.isVehicleOnline?"Execute the mission that is stored in the vehicle.":"Cannot execute mission (vehicle offline)."),vt=E(()=>h.value===void 0?"Cannot center map on home (home position undefined).":Z.value===k.HOME?"Tracking home position. Click to stop tracking.":"Click once to center on home or twice to track it."),mt=E(()=>s.isVehicleOnline?M.value===void 0?"Cannot center map on vehicle (vehicle position undefined).":Z.value===k.VEHICLE?"Tracking vehicle position. Click to stop tracking.":"Click once to center on vehicle or twice to track it.":"Cannot center map on vehicle (vehicle offline)."),$e=e=>({html:`
    <div class="poi-marker-container">
      <div class="poi-marker-background" style="background-color: ${e.color}80;"></div>
      <i class="v-icon notranslate mdi ${e.icon}" style="color: rgba(255, 255, 255, 0.7); position: relative; z-index: 2;"></i>
    </div>
  `,className:"poi-marker-icon-widget",iconSize:[32,32],iconAnchor:[16,32]}),Be=e=>{if(!o.value||!o.value.getContainer())return;const t=r.divIcon($e(e)),a=r.marker(e.coordinates,{icon:t,draggable:!0}).addTo(o.value),l=`
    <strong>${e.name}</strong><br>
    ${e.description?e.description+"<br>":""}
    Lat: ${e.coordinates[0].toFixed(8)}, Lng: ${e.coordinates[1].toFixed(8)}
  `,b={permanent:!1,direction:"top",offset:[0,-40],className:"poi-tooltip-widget"};a.bindTooltip(l,b),a.on("drag",f=>{var se;const O=f.target.getLatLng(),ee=`
      <strong>${e.name}</strong><br>
      ${e.description?e.description+"<br>":""}
      Lat: ${O.lat.toFixed(8)}, Lng: ${O.lng.toFixed(8)}
    `;(se=a.getTooltip())==null||se.setContent(ee)}),a.on("dragend",f=>{const O=f.target.getLatLng();m.movePointOfInterest(e.id,[O.lat,O.lng])}),a.on("click",f=>{if(r.DomEvent.stopPropagation(f),A.value){const O=m.pointsOfInterest.find(ee=>ee.id===e.id);O?A.value.openDialog(void 0,O):console.warn("POI not found in store:",e.id)}}),I.value[e.id]=a},He=e=>{var l;if(!o.value||!o.value.getContainer()||!I.value[e.id])return;const t=I.value[e.id];t.setLatLng(e.coordinates),t.setIcon(r.divIcon($e(e)));const a=`
    <strong>${e.name}</strong><br>
    ${e.description?e.description+"<br>":""}
    Lat: ${e.coordinates[0].toFixed(8)}, Lng: ${e.coordinates[1].toFixed(8)}
  `;(l=t.getTooltip())==null||l.setContent(a)},pt=e=>{!o.value||!I.value[e]||(I.value[e].remove(),delete I.value[e])};return g(()=>m.pointsOfInterest,async e=>{if((!o.value||!o.value.getContainer())&&(await be(),!o.value||!o.value.getContainer())){console.warn("Map.vue: POI watcher - map not ready after nextTick.");return}const t=new Set(e.map(a=>a.id));Object.keys(I.value).forEach(a=>{t.has(a)||pt(a)}),e.forEach(a=>{I.value[a.id]?He(a):Be(a)})},{deep:!0,immediate:!0}),g(o,e=>{e&&e.getContainer()&&m.pointsOfInterest.forEach(t=>{I.value[t.id]?He(t):Be(t)})},{immediate:!0}),(e,t)=>{const a=Ut("contextmenu");return w(),K(Je,null,[Rt((w(),K("div",{ref_key:"mapBase",ref:G,class:ye(["page-base",n(X).editingMode?"pointer-events-none":"pointer-events-auto"])},[q("div",{id:P.value,ref_key:"map",ref:o,class:"map"},[u(ce,{location:"top",text:vt.value},{activator:v(({props:l})=>[_.value?(w(),z(F,re({key:0},l,{class:["absolute right-[166px] m-3 bottom-button bg-slate-50 text-[14px]",h.value?"":"active-events-on-disabled"],color:Z.value==n(k).HOME?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-home-search",size:"x-small",disabled:!h.value,onClick:t[0]||(t[0]=Y(b=>n(C).goToTarget(n(k).HOME,!0),["stop"])),onDblclick:t[1]||(t[1]=Y(b=>n(C).follow(n(k).HOME),["stop"]))}),null,16,["class","color","disabled"])):R("",!0)]),_:1},8,["text"]),u(ce,{location:"top",text:mt.value},{activator:v(({props:l})=>[_.value?(w(),z(F,re({key:0},l,{class:["absolute m-3 bottom-button right-[124px] bg-slate-50 text-[14px]",M.value?"":"active-events-on-disabled"],color:Z.value==n(k).VEHICLE?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-airplane-marker",size:"x-small",disabled:!M.value,onClick:t[2]||(t[2]=Y(b=>n(C).goToTarget(n(k).VEHICLE,!0),["stop"])),onDblclick:t[3]||(t[3]=Y(b=>n(C).follow(n(k).VEHICLE),["stop"]))}),null,16,["class","color","disabled"])):R("",!0)]),_:1},8,["text"]),u(ce,{location:"top",text:ut.value},{activator:v(({props:l})=>[_.value?(w(),z(F,re({key:0},l,{class:["absolute m-3 bottom-button right-[82px] bg-slate-50 text-[14px]",n(s).isVehicleOnline?"":"active-events-on-disabled"],disabled:!n(s).isVehicleOnline,elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-download",size:"x-small",onClick:Y(Fe,["stop"])}),null,16,["class","disabled"])):R("",!0)]),_:1},8,["text"]),u(ce,{location:"top",text:dt.value},{activator:v(({props:l})=>[_.value?(w(),z(F,re({key:0},l,{class:["absolute mb-3 ml-1 bottom-button right-[52px] bg-slate-50 text-[14px]",n(s).isVehicleOnline?"":"active-events-on-disabled"],disabled:!n(s).isVehicleOnline,elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-play",size:"x-small",onClick:Y(rt,["stop"])}),null,16,["class","disabled"])):R("",!0)]),_:1},8,["text"])],8,to)],2)),[[a,at]]),u(Wt,{ref_key:"contextMenuRef",ref:oe,visible:B.value,width:"260px","menu-items":nt,onClose:ne},null,8,["visible","menu-items"]),u(Xe,{modelValue:n(X).widgetManagerVars(n(T).hash).configMenuOpen,"onUpdate:modelValue":t[5]||(t[5]=l=>n(X).widgetManagerVars(n(T).hash).configMenuOpen=l),width:"auto"},{default:v(()=>[u(qe,{class:"pa-2",style:ue(n(V).globalGlassMenuStyles)},{default:v(()=>[u(Ke,{class:"text-center"},{default:v(()=>t[7]||(t[7]=[D("Map widget settings")])),_:1,__:[7]}),u(Qe,null,{default:v(()=>[u(Gt,{modelValue:n(T).options.showVehiclePath,"onUpdate:modelValue":t[4]||(t[4]=l=>n(T).options.showVehiclePath=l),class:"my-1",label:"Show vehicle path",color:n(T).options.showVehiclePath?"white":void 0,"hide-details":""},null,8,["modelValue","color"])]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"]),le.value?(w(),z(Zt,{key:0,"model-value":Oe.value,height:"10",absolute:"",bottom:"",color:"white",style:ue(`top: ${Ae.value}`)},null,8,["model-value","style"])):R("",!0),le.value?(w(),K("p",{key:1,style:ue({top:Ae.value}),class:"absolute left-[7px] mt-4 flex text-md font-bold text-white z-30 drop-shadow-md"}," Loading mission... ",4)):R("",!0),u(jt,{ref_key:"poiManagerMapWidgetRef",ref:A},null,512),u(eo,{"model-value":p.value,onConfirmed:Pe,"onUpdate:modelValue":t[6]||(t[6]=l=>p.value=l)},null,8,["model-value"])],64)}}}),io=et(oo,[["__scopeId","data-v-c3d3a744"]]);export{io as default};
