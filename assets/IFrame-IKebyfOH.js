import{c as $,bD as j,k as M,K as A,y as P,r as u,J as G,aS as H,L as K,bL as E,al as J,w as Q,l as w,m as v,n,H as o,v as s,N as g,x as q,G as h,O as i,Q as b,a6 as X,t as Y,a7 as S,a$ as C,I as Z,as as ee,V as ae,P as te,R as se,U as N,aP as oe,T as le,aR as ne,bM as ie,s as re,ad as de,am as ue,bH as ce,W as pe,bN as ve,F as me,bO as fe,a9 as we,_ as ge}from"./index-B3-Iskgt.js";const he={class:"w-full h-full"},be=["width","height"],Ve={class:"flex flex-col justify-start items-center h-auto pt-2 cursor-pointer"},ye={class:"flex justify-between w-full h-[25px] px-2"},xe={class:"select-none"},_e={class:"pt-2"},ke=["src"],Me={key:1},Se=["src"],Ce={class:"flex items-center justify-between"},Le={class:"mt-2 mb-2 w-[95%]"},Ue={class:"flex justify-between"},Fe={key:0},Re=$({__name:"IFrame",props:{widget:{}},setup(T){j(t=>({"2fb3676c":W.value}));const L=A(),r=P(),V=u(),e=G(T).widget,y=u(!1),x=u(0),d=u(e.value.options.source),m=u(!1),_=u(""),c=u(!1),B=()=>{c.value=!c.value},I=()=>{r.allowMovingAndResizing(e.value.hash,!0),window.addEventListener("mouseup",p),window.addEventListener("dragend",p)},p=()=>{r.allowMovingAndResizing(e.value.hash,!1),window.removeEventListener("mouseup",p),window.removeEventListener("dragend",p)},U=M(()=>({width:e.value.size.width*f.value,height:e.value.size.height*f.value})),k=t=>fe(t)?!0:"URL is not valid.",F=()=>{const t=k(d.value);if(t!==!0){_.value=`${t} Please enter a valid URL.`,m.value=!0;return}e.value.options.source=d.value,_.value=`IFrame URL sucessfully updated to '${d.value}'.`,m.value=!0},R=t=>{if(t.data.type!=="cockpit:listenToDatalakeVariables")return;const{variable:a}=t.data;we(a,l=>{V.value.contentWindow.postMessage({type:"cockpit:datalakeVariable",variable:a,value:l},"*")})};K(()=>{window.addEventListener("message",R,!0),Object.keys(e.value.options).length===0&&(e.value.options={source:"http://"+E},d.value=E)}),J(()=>{window.removeEventListener("message",R,!0)});const{width:f,height:z}=H(),O=M(()=>{let t="";return t=t.concat(" ",`left: ${e.value.position.x*f.value}px;`),t=t.concat(" ",`top: ${e.value.position.y*z.value}px;`),t=t.concat(" ",`width: ${e.value.size.width*f.value}px;`),t=t.concat(" ",`height: ${e.value.size.height*z.value}px;`),r.editingMode&&(t=t.concat(" ","pointer-events:none; border:0;")),r.isWidgetVisible(e.value)||(t=t.concat(" ","display: none;")),t}),W=M(()=>(100-x.value)/100);function D(){console.log("Finished loading"),y.value=!0}return Q(e,()=>{r.widgetManagerVars(e.value.hash).configMenuOpen===!1&&k(d.value)!==!0&&(d.value=e.value.options.source)},{deep:!0}),(t,a)=>(v(),w(me,null,[n("div",he,[s(e).options.isCollapsible?(v(),w("div",{key:0,ref:"iframe-container",class:q(["w-full rounded-lg overflow-hidden -mt-2",[c.value?"h-[42px]":"h-full"]]),width:U.value.width,height:U.value.height,style:g(s(L).globalGlassMenuStyles)},[n("div",Ve,[n("div",ye,[o(X,{class:"cursor-grab opacity-40",onMousedown:I,onMouseup:p},{default:i(()=>a[7]||(a[7]=[b(" mdi-drag ")])),_:1,__:[7]}),n("div",xe,Y(s(e).options.containerName||"iframe"),1),o(S,{icon:c.value?"mdi-chevron-down":"mdi-chevron-up",variant:"text",size:"36",class:"mt-[-6px] opacity-60",onClick:B},null,8,["icon"])]),h(n("div",_e,[h(n("iframe",{ref_key:"iframe",ref:V,src:s(e).options.source,style:g(O.value),frameborder:"0",onLoad:D},null,44,ke),[[C,y.value]])],512),[[C,!c.value]])])],14,be)):(v(),w("div",Me,[(v(),Z(ee,{to:".widgets-view"},[h(n("iframe",{ref_key:"iframe",ref:V,src:s(e).options.source,style:g([O.value,{position:"absolute"}]),frameborder:"0",onLoad:D},null,44,Se),[[C,y.value]])]))])),o(pe,{modelValue:s(r).widgetManagerVars(s(e).hash).configMenuOpen,"onUpdate:modelValue":a[5]||(a[5]=l=>s(r).widgetManagerVars(s(e).hash).configMenuOpen=l),"min-width":"600","max-width":"45%"},{default:i(()=>[o(ae,{class:"pa-2",style:g(s(L).globalGlassMenuStyles)},{default:i(()=>[o(te,{class:"text-center"},{default:i(()=>a[8]||(a[8]=[b("Settings")])),_:1,__:[8]}),o(se,null,{default:i(()=>[n("div",null,[a[9]||(a[9]=n("p",null,"Iframe Source",-1)),n("div",Ce,[o(N,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=l=>d.value=l),variant:"filled",outlined:"",rules:[k],onKeydown:oe(F,["enter"])},null,8,["modelValue","rules"]),h(o(S,{icon:"mdi-check",class:"mx-1 mb-5 bg-[#FFFFFF22]",rounded:"lg",flat:"",onClick:F},null,512),[[le,"Set",void 0,{bottom:!0}]])])]),n("div",Le,[o(ne,{modelValue:x.value,"onUpdate:modelValue":a[1]||(a[1]=l=>x.value=l),label:"Transparency",color:"white",min:0,max:90},null,8,["modelValue"])]),o(ie,{compact:"","is-expanded":!0,"no-bottom-divider":"","no-top-divider":""},{title:i(()=>a[10]||(a[10]=[b("Advanced options")])),content:i(()=>[n("div",Ue,[o(de,{modelValue:s(e).options.isCollapsible,"onUpdate:modelValue":a[2]||(a[2]=l=>s(e).options.isCollapsible=l),label:"Collapsible container",color:"white",class:"ml-2"},null,8,["modelValue"]),s(e).options.isCollapsible?(v(),w("div",Fe,[o(N,{modelValue:s(e).options.containerName,"onUpdate:modelValue":a[3]||(a[3]=l=>s(e).options.containerName=l),label:"Container name","item-title":"name",density:"compact",variant:"outlined","no-data-text":"iframe","hide-details":"",theme:"dark",class:"w-[300px] mt-2"},null,8,["modelValue"])])):re("",!0)])]),_:1})]),_:1}),o(ue,{width:"80%",inset:""}),o(ce,{class:"flex justify-end mt-2"},{default:i(()=>[o(S,{color:"white",onClick:a[4]||(a[4]=l=>s(r).widgetManagerVars(s(e).hash).configMenuOpen=!1)},{default:i(()=>a[11]||(a[11]=[b(" Close ")])),_:1,__:[11]})]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])]),o(ve,{"open-snackbar":m.value,message:_.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":a[6]||(a[6]=l=>m.value=l)},null,8,["open-snackbar","message"])],64))}}),De=ge(Re,[["__scopeId","data-v-549a5da2"]]);export{De as default};
