import{c as ee,y as ae,J as te,r as M,w as A,o as ne,k as oe,h as le,l as p,m as x,n as v,v as L,O as W,q as i,s as b,az as T,t as ie,G as se,at as ue,I as K,N as P,Q as j,af as U,ax as re,aw as X,ay as de,_ as me}from"./index-C6uq_RVh.js";const ce={class:"potentiometer-scale elevation-5"},pe={key:0,class:"absolute bg-[#880000] pa-2 text-xs mt-2 -ml-12 border-2 border-white rounded-md z-50"},ve={class:"flex flex-col w-4 h-7 justify-between items-center"},ge=ee({__name:"Dial",props:{miniWidget:{}},setup(Y){const n=ae(),a=te(Y).miniWidget,l=M(0),y=M(-150);let D;const d=M(!1),k=M(String(Math.round(l.value)||0));A(()=>n.miniWidgetManagerVars(a.value.hash).configMenuOpen,e=>{e===!0&&(n.showElementPropsDrawer(a.value.hash),setTimeout(()=>{n.miniWidgetManagerVars(a.value.hash).configMenuOpen=!1},200))},{immediate:!0,deep:!0});const g=e=>{var V,c,m;let t;e==null||isNaN(Number(e))?t=Number((V=a.value.options.layout)==null?void 0:V.minValue)||0:t=Number(e),l.value=t;const o=300,s=Number((c=a.value.options.layout)==null?void 0:c.minValue)||0,u=(Number((m=a.value.options.layout)==null?void 0:m.maxValue)||100)-s;y.value=(t-s)/u*o-150},_=()=>{var e;if(a.value.options.dataLakeVariable){D=re((e=a.value.options.dataLakeVariable)==null?void 0:e.name,o=>{g(o)});const t=n.getMiniWidgetLastValue(a.value.hash);g(t)}};A(()=>{var e;return(e=a.value.options.dataLakeVariable)==null?void 0:e.name},e=>{e&&_()},{immediate:!0}),A(()=>{var e,t;return[Number((e=a.value.options.layout)==null?void 0:e.minValue)||0,Number((t=a.value.options.layout)==null?void 0:t.maxValue)||100]},([e])=>{l.value=e,g(l.value)},{immediate:!0}),ne(()=>{(!a.value.options||Object.keys(a.value.options).length===0)&&(a.value.isCustomElement=!0,n.updateElementOptions(a.value.hash,{layout:{minValue:0,maxValue:100,size:"small",showValue:!0,align:"center",knobColor:"#838383",notchColor:"#303030aa"},variableType:"number",dataLakeVariable:void 0})),_()});const $=oe(()=>{var e;switch((e=a.value.options.layout)==null?void 0:e.size){case"medium":return"potentiometer-medium";case"large":return"potentiometer-large";default:return"potentiometer-small"}});let F=0,C=0;const N=()=>{if(a.value.options.dataLakeVariable&&!n.editingMode){const e=Math.round(l.value);n.setMiniWidgetLastValue(a.value.hash,e),X(a.value.options.dataLakeVariable.name,e)}},q=e=>{e.preventDefault();const o=e.currentTarget.getBoundingClientRect(),s=o.left+o.width/2,r=o.top+o.height/2,u=Math.atan2(e.clientY-r,e.clientX-s)*180/Math.PI;F=u,C=u;const c=y.value-u,m=z=>{var I,O;const R=Math.atan2(z.clientY-r,z.clientX-s)*180/Math.PI;let h=R-F;h>180?h-=360:h<-180&&(h+=360);const S=C+h;F=R,C=S;let w=S+c;w=Math.max(-150,Math.min(150,w)),y.value=w;const H=300,B=((I=a.value.options.layout)==null?void 0:I.minValue)||0,Z=(((O=a.value.options.layout)==null?void 0:O.maxValue)||100)-B;l.value=(w+150)/H*Z+B,a.value.options.dataLakeVariable&&N()},f=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)};document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)},G=()=>{var t;const e=((t=a.value.options.layout)==null?void 0:t.maxValue)||100;l.value<e&&(g(l.value+1),N())},J=()=>{var t;const e=((t=a.value.options.layout)==null?void 0:t.minValue)||0;l.value>e&&(g(l.value-1),N())},Q=()=>{n.editingMode||(d.value=!0,k.value=String(Math.round(l.value)||0))},E=()=>{var s,r;let e=parseFloat(k.value);isNaN(e)&&(e=Math.round(l.value)||0);const t=((s=a.value.options.layout)==null?void 0:s.minValue)||0,o=((r=a.value.options.layout)==null?void 0:r.maxValue)||100;if(e>o&&(e=o),e<t&&(e=t),g(e),a.value.options.dataLakeVariable&&!n.editingMode){const u=Math.round(e);n.setMiniWidgetLastValue(a.value.hash,u),X(a.value.options.dataLakeVariable.name,u)}d.value=!1};return le(()=>{a.value.options.dataLakeVariable&&D&&de(a.value.options.dataLakeVariable.name,D)}),(e,t)=>{var o,s,r,u,V,c,m;return p(),x("div",{id:"dial",class:L(["flex items-center w-auto",((o=i(n).elementToShowOnDrawer)==null?void 0:o.hash)===i(a).hash&&i(n).editingMode?"bg-[#00000010] ":"border-0"]),style:W({justifyContent:(s=i(a).options.layout)==null?void 0:s.align}),onClick:t[2]||(t[2]=f=>i(n).editingMode&&i(n).showElementPropsDrawer(i(a).hash))},[v("div",{class:L(["flex flex-row",i(n).editingMode?"pointer-events-none":"pointer-events-auto"])},[v("div",{class:L(["potentiometer-container w-full",$.value]),onMousedown:q,onClick:t[0]||(t[0]=f=>d.value=!1)},[v("div",ce,[v("div",{class:"potentiometer-knob",style:W({transform:`rotate(${y.value}deg)`,background:((r=i(a).options.layout)==null?void 0:r.knobColor)||"#838383"})},[v("div",{class:"knob-notch",style:W({background:((u=i(a).options.layout)==null?void 0:u.notchColor)||"#222222"})},null,4)],4)])],34),((V=i(a).options.layout)==null?void 0:V.minValue)>=((c=i(a).options.layout)==null?void 0:c.maxValue)?(p(),x("p",pe," Min value is larger than Max value ")):b("",!0)],2),(m=i(a).options.layout)!=null&&m.showValue?(p(),x("div",{key:0,class:"flex",onKeydown:T(E,["esc"])},[v("div",{class:L(["value-display bg-[#FFFFFF22] border-[1px] rounded-md p-[2px] min-w-[40px] text-center elevation-1",d.value?"pointer-events-auto border-blue-800 bg-[#0000FF11]":"cursor-pointer border-[#FFFFFF44] bg-[#FFFFFF22]"])},[d.value?b("",!0):(p(),x("div",{key:0,onClick:Q},ie(Math.round(l.value)||0),1)),d.value?se((p(),x("input",{key:1,"onUpdate:modelValue":t[1]||(t[1]=f=>k.value=f),class:"bg-transparent border-0 text-center outline-none max-w-[30px]",onKeydown:T(E,["enter"]),onBlur:E},null,544)),[[ue,k.value]]):b("",!0)],2),v("div",ve,[d.value?b("",!0):(p(),K(U,{key:0,class:"text-white text-[16px] -mt-[2px] ml-2 cursor-pointer opacity-30",onClick:G},{default:P(()=>t[3]||(t[3]=[j("mdi-plus")])),_:1})),d.value?b("",!0):(p(),K(U,{key:1,class:"text-white text-[16px] -mb-1 ml-2 cursor-pointer opacity-30",onClick:J},{default:P(()=>t[4]||(t[4]=[j("mdi-minus")])),_:1}))])],32)):b("",!0)],6)}}}),he=me(ge,[["__scopeId","data-v-95fd22e5"]]);export{he as default};
