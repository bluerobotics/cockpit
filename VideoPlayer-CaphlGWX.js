import{ca as B,d as D,bD as M,b as o,aD as P,aC as T,p as g,aG as j,aI as z,aJ as E,a6 as O,q as w,k as v,o as f,c as y,a as s,t as h,h as i,a1 as r,ac as H,aQ as A,a4 as S,ad as q,aK as x,aZ as k,a2 as N,aj as K,a7 as L,am as Y,an as G,ao as J}from"./index-7qAN_0zn.js";import{u as Q}from"./video-BFbQJ_o2.js";const W=B("v-banner-text"),c=m=>(Y("data-v-23b3800f"),m=m(),G(),m),Z={ref:"videoWidget",class:"video-widget"},X={key:0,class:"no-video-alert"},ee=c(()=>s("span",null,"No video stream selected.",-1)),te=[ee],ae={key:1,class:"no-video-alert"},oe=c(()=>s("p",null,"The selected stream is not available.",-1)),le=c(()=>s("p",null,"Please check its source or select another stream.",-1)),se=[oe,le],ne={key:2,class:"no-video-alert"},ie={class:"no-video-alert"},re=c(()=>s("span",{class:"text-xl font-bold"},"Server status: ",-1)),de=c(()=>s("span",{class:"text-xl font-bold"},"Stream status: ",-1)),ue={key:3,class:"no-video-alert"},ce=c(()=>s("p",null,"Loading stream...",-1)),me=[ce],pe={class:"flex-wrap justify-center d-flex ga-5"},ve=D({__name:"VideoPlayer",props:{widget:{}},setup(m){M(a=>({35940377:o(e).options.videoFitStyle,"56ab815b":I.value}));const p=Q(),{namesAvailableStreams:d}=P(p),e=T(m).widget,n=g(),V=g(),u=g(),_=g(!1);j(()=>{const a={videoFitStyle:"cover",flipHorizontally:!1,flipVertically:!1,rotationAngle:0,streamName:void 0};e.value.options=Object.assign({},a,e.value.options),n.value=e.value.options.streamName});const C=setInterval(()=>{var l;e.value.options.streamName===void 0&&!d.value.isEmpty()&&(e.value.options.streamName=d.value[0],n.value=e.value.options.streamName,d.value.length>1&&z.fire({title:"Multiple streams detected",text:`You have multiple streams available, so we chose one randomly to start with.
        If you want to change it, please open the widget configuration on the edit-menu.`,icon:"info",confirmButtonText:"OK"}));const a=p.getMediaStream(e.value.options.streamName);E(a,u.value)||(u.value=a);const t=((l=p.getStreamData(e.value.options.streamName))==null?void 0:l.connected)??!1;t!==_.value&&(_.value=t)},1e3);O(()=>clearInterval(C)),w(n,()=>{e.value.options.streamName=n.value,u.value=void 0}),w(u,()=>{!V.value||!u.value||(V.value.srcObject=u.value,V.value.play().then(()=>console.log("[VideoPlayer] Stream is playing")).catch(a=>{const t=`Failed to play stream. Reason: ${a}`;console.error(`[VideoPlayer] ${t}`)}))});const b=a=>{e.value.options.rotationAngle+=a},F=v(()=>`scale(${e.value.options.flipHorizontally?-1:1}, ${e.value.options.flipVertically?-1:1})`),U=v(()=>`rotate(${e.value.options.rotationAngle??0}deg)`),I=v(()=>`${F.value} ${U.value}`),R=v(()=>{var a;return n.value===void 0?"Unknown.":((a=p.getStreamData(n.value))==null?void 0:a.webRtcManager.signallerStatus)??"Unknown."}),$=v(()=>{var a;return n.value===void 0?"Unknown.":((a=p.getStreamData(n.value))==null?void 0:a.webRtcManager.streamStatus)??"Unknown."});return(a,t)=>(f(),y(L,null,[s("div",Z,[n.value===void 0?(f(),y("div",X,te)):!o(d).isEmpty()&&!o(d).includes(n.value)?(f(),y("div",ae,se)):_.value?(f(),y("div",ue,me)):(f(),y("div",ne,[s("div",ie,[s("p",null,[re,s("span",null,h(R.value),1)]),s("p",null,[de,s("span",null,h($.value),1)])])])),s("video",{id:"mainDisplayStream",ref_key:"videoElement",ref:V,muted:"",autoplay:"",playsinline:"",disablePictureInPicture:""}," Your browser does not support the video tag. ",512)],512),i(K,{modelValue:o(e).managerVars.configMenuOpen,"onUpdate:modelValue":t[6]||(t[6]=l=>o(e).managerVars.configMenuOpen=l),width:"auto"},{default:r(()=>[i(H,{class:"pa-2"},{default:r(()=>[i(A,null,{default:r(()=>[S("Video widget config")]),_:1}),i(q,null,{default:r(()=>[i(x,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value=l),label:"Stream name",class:"my-3",items:o(d),"item-title":"name",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":""},null,8,["modelValue","items"]),i(x,{modelValue:o(e).options.videoFitStyle,"onUpdate:modelValue":t[1]||(t[1]=l=>o(e).options.videoFitStyle=l),label:"Fit style",class:"my-3",items:["cover","fill","contain"],"item-title":"style",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":""},null,8,["modelValue"]),i(W,null,{default:r(()=>[S('Saved stream name: "'+h(o(e).options.streamName)+'"',1)]),_:1}),i(k,{modelValue:o(e).options.flipHorizontally,"onUpdate:modelValue":t[2]||(t[2]=l=>o(e).options.flipHorizontally=l),class:"my-1",label:"Flip horizontally",color:o(e).options.flipHorizontally?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"]),i(k,{modelValue:o(e).options.flipVertically,"onUpdate:modelValue":t[3]||(t[3]=l=>o(e).options.flipVertically=l),class:"my-1",label:"Flip vertically",color:o(e).options.flipVertically?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"]),s("div",pe,[i(N,{"prepend-icon":"mdi-file-rotate-left",variant:"outlined",onClick:t[4]||(t[4]=l=>b(-90))},{default:r(()=>[S(" Rotate Left")]),_:1}),i(N,{"prepend-icon":"mdi-file-rotate-right",variant:"outlined",onClick:t[5]||(t[5]=l=>b(90))},{default:r(()=>[S(" Rotate Right")]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Se=J(ve,[["__scopeId","data-v-23b3800f"]]);export{Se as default};
