import{bl as Ie,bm as He,bn as Ze,bo as se,bp as Fe,bq as Oe,br as We,bs as Ge,k as L,b5 as C,q as Z,bt as k,bu as ce,an as Be,bb as V,at as z,a1 as te,i as G,m as ye,ac as Xe,d as qe,j as Se,D as Te,u as Je,bv as Ye,aq as Ke,p as Qe,bw as et,bx as D,U as tt,Z as ot,o as $,c as me,f as h,a2 as A,g as K,b as p,a as I,t as U,h as Q,by as Ae,aK as ie,R as Ce,ai as H,bh as nt,a4 as Me,am as at,ah as lt,aj as st,a3 as it,au as rt,av as ut,a7 as dt,bz as ct,$ as Ee}from"./index.e70afa68.js";import{_ as ft}from"./VehicleIcon.vue_vue_type_script_setup_true_lang.bdf01b5b.js";function xe(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}function mt(e){return xe({},e)}var Pe=1440,pt=2520,pe=43200,yt=86400;function vt(e,t,o){var n,f;Ie(2,arguments);var c=Ge(),s=(n=(f=o==null?void 0:o.locale)!==null&&f!==void 0?f:c.locale)!==null&&n!==void 0?n:He;if(!s.formatDistance)throw new RangeError("locale must contain formatDistance property");var d=Ze(e,t);if(isNaN(d))throw new RangeError("Invalid time value");var l=xe(mt(o),{addSuffix:Boolean(o==null?void 0:o.addSuffix),comparison:d}),v,a;d>0?(v=se(t),a=se(e)):(v=se(e),a=se(t));var y=Fe(a,v),B=(Oe(a)-Oe(v))/1e3,u=Math.round((y-B)/60),b;if(u<2)return o!=null&&o.includeSeconds?y<5?s.formatDistance("lessThanXSeconds",5,l):y<10?s.formatDistance("lessThanXSeconds",10,l):y<20?s.formatDistance("lessThanXSeconds",20,l):y<40?s.formatDistance("halfAMinute",0,l):y<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):u===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",u,l);if(u<45)return s.formatDistance("xMinutes",u,l);if(u<90)return s.formatDistance("aboutXHours",1,l);if(u<Pe){var O=Math.round(u/60);return s.formatDistance("aboutXHours",O,l)}else{if(u<pt)return s.formatDistance("xDays",1,l);if(u<pe){var M=Math.round(u/Pe);return s.formatDistance("xDays",M,l)}else if(u<yt)return b=Math.round(u/pe),s.formatDistance("aboutXMonths",b,l)}if(b=We(a,v),b<12){var S=Math.round(u/pe);return s.formatDistance("xMonths",S,l)}else{var x=b%12,w=Math.floor(b/12);return x<3?s.formatDistance("aboutXYears",w,l):x<9?s.formatDistance("overXYears",w,l):s.formatDistance("almostXYears",w+1,l)}}function gt(e,t){return Ie(1,arguments),vt(e,Date.now(),t)}const De=(e,t)=>{let o;return function(...n){const f=this;o&&clearTimeout(o),o=setTimeout(()=>{e.apply(f,n),o=null},t)}},bt=e=>!e||typeof e.charAt!="function"?e:e.charAt(0).toUpperCase()+e.slice(1),X=(e,t,o)=>{for(const n in o){const f="set"+bt(n);e[f]?ye(()=>o[n],(c,s)=>{e[f](c,s)}):t[f]&&ye(()=>o[n],c=>{t[f](c)})}},q=e=>{const t={};for(const o in e)if(o.startsWith("on")&&!o.startsWith("onUpdate")&&o!=="onReady"){const n=o.slice(2).toLocaleLowerCase();t[n]=e[o]}return t},ht=async e=>{const t=await Promise.all([k(()=>import("./marker-icon-2x.68378269.js"),[],import.meta.url),k(()=>import("./marker-icon.753d5637.js"),[],import.meta.url),k(()=>import("./marker-shadow.40fd21b3.js"),[],import.meta.url)]);delete e.Default.prototype._getIconUrl,e.Default.mergeOptions({iconRetinaUrl:t[0].default,iconUrl:t[1].default,shadowUrl:t[2].default})},re=e=>{const t=L(()=>console.warn(`Method ${e} has been invoked without being replaced`)),o=(...n)=>t.value(...n);return o.wrapped=t,V(e,o),o},ue=(e,t)=>e.wrapped.value=t,j=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||void 0,J="useGlobalLeaflet",oe={options:{type:Object,default:()=>({})}},ne=e=>({options:e.options,methods:{}}),be={...oe,pane:{type:String,default:"overlayPane"},attribution:{type:String,default:null},name:{type:String,custom:!0,default:void 0},layerType:{type:String,custom:!0,default:void 0},visible:{type:Boolean,custom:!0,default:!0}},he=(e,t,o)=>{const n=C("addLayer"),f=C("removeLayer"),{options:c,methods:s}=ne(e),d={...c,attribution:e.attribution,pane:e.pane},l=()=>n({leafletObject:t.value}),v=()=>f({leafletObject:t.value}),a={...s,setAttribution(y,B){this.$parent.leafletObject.attributionControl.removeAttribution(B).addAttribution(y)},setName(){v(),e.visible&&l()},setLayerType(){v(),e.visible&&l()},setVisible(y){t.value&&(y?l():v())},bindPopup({leafletObject:y}){t.value.bindPopup(y)},bindTooltip({leafletObject:y}){t.value.bindTooltip(y)},unbindTooltip(){const y=t.value?t.value.getTooltip():null;y&&y.unbindTooltip()},unbindPopup(){const y=t.value?t.value.getPopup():null;y&&y.unbindPopup()},updateVisibleProp(y){o.emit("update:visible",y)}};return V("bindPopup",a.bindPopup),V("bindTooltip",a.bindTooltip),V("unbindTooltip",a.unbindTooltip),V("unbindPopup",a.unbindPopup),Xe(()=>{a.unbindPopup(),a.unbindTooltip(),v()}),{options:d,methods:a}},ke=(e,t)=>{if(e&&t.default)return ce("div",{style:{display:"none"}},t.default())},Lt={...oe,interactive:{type:Boolean,default:!0},bubblingMouseEvents:{type:Boolean,default:!0}},_t=e=>{const{options:t,methods:o}=ne(e);return{options:{...t,interactive:e.interactive,bubblingMouseEvents:e.bubblingMouseEvents},methods:o}},wt={...be,...Lt,stroke:{type:Boolean,custom:!0,default:!0},color:{type:String,custom:!0,default:"#3388ff"},weight:{type:Number,custom:!0,default:3},opacity:{type:Number,custom:!0,default:1},lineCap:{type:String,custom:!0,default:"round"},lineJoin:{type:String,custom:!0,default:"round"},dashArray:{type:String,custom:!0,default:null},dashOffset:{type:String,custom:!0,default:null},fill:{type:Boolean,custom:!0,default:!1},fillColor:{type:String,custom:!0,default:"#3388ff"},fillOpacity:{type:Number,custom:!0,default:.2},fillRule:{type:String,custom:!0,default:"evenodd"},className:{type:String,custom:!0,default:null}},Ot=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),{options:c,methods:s}=_t(e),d=C("removeLayer"),l={...n,...c,stroke:e.stroke,color:e.color,weight:e.weight,opacity:e.opacity,lineCap:e.lineCap,lineJoin:e.lineJoin,dashArray:e.dashArray,dashOffset:e.dashOffset,fill:e.fill,fillColor:e.fillColor,fillOpacity:e.fillOpacity,fillRule:e.fillRule,className:e.className},v={...f,...s,setStroke(a){t.value.setStyle({stroke:a})},setColor(a){t.value.setStyle({color:a})},setWeight(a){t.value.setStyle({weight:a})},setOpacity(a){t.value.setStyle({opacity:a})},setLineCap(a){t.value.setStyle({lineCap:a})},setLineJoin(a){t.value.setStyle({lineJoin:a})},setDashArray(a){t.value.setStyle({dashArray:a})},setDashOffset(a){t.value.setStyle({dashOffset:a})},setFill(a){t.value.setStyle({fill:a})},setFillColor(a){t.value.setStyle({fillColor:a})},setFillOpacity(a){t.value.setStyle({fillOpacity:a})},setFillRule(a){t.value.setStyle({fillRule:a})},setClassName(a){t.value.setStyle({className:a})}};return te(()=>{d({leafletObject:t.value})}),{options:l,methods:v}},St={...be,pane:{type:String,default:"tilePane"},opacity:{type:Number,custom:!1,default:1},zIndex:{type:Number,default:1},tileSize:{type:Number,default:256},noWrap:{type:Boolean,default:!1},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:void 0}},Tt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o);return{options:{...n,pane:e.pane,opacity:e.opacity,zIndex:e.zIndex,tileSize:e.tileSize,noWrap:e.noWrap,minZoom:e.minZoom,maxZoom:e.maxZoom},methods:{...f}}},At={iconUrl:{type:String,custom:!0,default:null},iconRetinaUrl:{type:String,custom:!0,default:null},iconSize:{type:[Object,Array],custom:!0,default:null},iconAnchor:{type:[Object,Array],custom:!0,default:null},popupAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},tooltipAnchor:{type:[Object,Array],custom:!0,default:()=>[0,0]},shadowUrl:{type:String,custom:!0,default:null},shadowRetinaUrl:{type:String,custom:!0,default:null},shadowSize:{type:[Object,Array],custom:!0,default:null},shadowAnchor:{type:[Object,Array],custom:!0,default:null},bgPos:{type:[Object,Array],custom:!0,default:()=>[0,0]},className:{type:String,custom:!0,default:""},options:{type:Object,custom:!0,default:()=>({})}};var de={name:"LIcon",props:{...At,...oe},setup(e,t){const o=L(null),n=C(J),f=C("canSetParentHtml"),c=C("setParentHtml"),s=C("setIcon");let d,l,v,a,y;const B=(M,S,x)=>{const w=M&&M.innerHTML;if(!S){x&&y&&f()&&c(w);return}const P=q(t.attrs);y&&l(y,P);const{options:F}=ne(e),i={...F,iconUrl:e.iconUrl,iconRetinaUrl:e.iconRetinaUrl,iconSize:e.iconSize,iconAnchor:e.iconAnchor,popupAnchor:e.popupAnchor,tooltipAnchor:e.tooltipAnchor,shadowUrl:e.shadowUrl,shadowRetinaUrl:e.shadowRetinaUrl,shadowSize:e.shadowSize,shadowAnchor:e.shadowAnchor,bgPos:e.bgPos,className:e.className,html:w||e.html};y=i.html?v(i):a(i),d(y,P),s(y)},u=()=>{z(()=>B(o.value,!0,!1))},b=()=>{z(()=>B(o.value,!1,!0))},O={setIconUrl:u,setIconRetinaUrl:u,setIconSize:u,setIconAnchor:u,setPopupAnchor:u,setTooltipAnchor:u,setShadowUrl:u,setShadowRetinaUrl:u,setShadowAnchor:u,setBgPos:u,setClassName:u,setHtml:u};return Z(async()=>{const{DomEvent:M,divIcon:S,icon:x}=n?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);d=M.on,l=M.off,v=S,a=x,X(O,{},e),new MutationObserver(b).observe(o.value,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),u()}),{root:o}},render(){const e=this.$slots.default?this.$slots.default():void 0;return ce("div",{ref:"root"},e)}};de.__file="src/components/LIcon.vue";var Ve={emits:["ready","update:zoom","update:center","update:bounds"],props:{...oe,center:{type:[Object,Array],default:()=>[0,0]},bounds:{type:[Array,Object],default:void 0},maxBounds:{type:[Array,Object],default:void 0},zoom:{type:Number,default:0},minZoom:{type:Number,default:void 0},maxZoom:{type:Number,default:void 0},paddingBottomRight:{type:Array,default:void 0},paddingTopLeft:{type:Array,default:void 0},padding:{type:Array,default:void 0},worldCopyJump:{type:Boolean,default:!1},crs:{type:[String,Object],default:"EPSG3857"},maxBoundsViscosity:{type:Number,default:void 0},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number,default:void 0},inertiaMaxSpeed:{type:Number,default:void 0},easeLinearity:{type:Number,default:void 0},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number,default:void 0},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:!1},useGlobalLeaflet:{type:Boolean,default:!1}},setup(e,t){const o=L(null),n=Be({ready:!1,leafletRef:{},layersToAdd:[],layersInControl:[]}),{options:f}=ne(e),c={...f,minZoom:e.minZoom,maxZoom:e.maxZoom,maxBounds:e.maxBounds,maxBoundsViscosity:e.maxBoundsViscosity,worldCopyJump:e.worldCopyJump,crs:e.crs,center:e.center,zoom:e.zoom,inertia:e.inertia,inertiaDeceleration:e.inertiaDeceleration,inertiaMaxSpeed:e.inertiaMaxSpeed,easeLinearity:e.easeLinearity,zoomAnimation:e.zoomAnimation,zoomAnimationThreshold:e.zoomAnimationThreshold,fadeAnimation:e.fadeAnimation,markerZoomAnimation:e.markerZoomAnimation},s=re("addLayer"),d=re("removeLayer"),l=re("registerControl"),v=re("registerLayerControl");V(J,e.useGlobalLeaflet);const a={moveEndHandler(){t.emit("update:zoom",n.leafletRef.getZoom()),t.emit("update:center",n.leafletRef.getCenter()),t.emit("update:bounds",n.leafletRef.getBounds())},overlayAddHandler(u){const b=n.layersInControl.find(O=>O.name===u.name);b&&b.updateVisibleProp(!0)},overlayRemoveHandler(u){const b=n.layersInControl.find(O=>O.name===u.name);b&&b.updateVisibleProp(!1)}};Z(async()=>{e.useGlobalLeaflet&&(j.L=j.L||await k(()=>import("./index.e70afa68.js").then(i=>i.l),[],import.meta.url));const{map:u,CRS:b,Icon:O,latLngBounds:M,latLng:S,DomEvent:x}=e.useGlobalLeaflet?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);try{c.beforeMapMount&&await c.beforeMapMount()}catch(i){console.error(`The following error occurred running the provided beforeMapMount hook ${i.message}`)}await ht(O);const w=typeof c.crs=="string"?b[c.crs]:c.crs;c.crs=w||b.EPSG3857;const P={addLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd.push(i):n.layersInControl.find(R=>R.leafletObject._leaflet_id===i.leafletObject._leaflet_id)||(n.layerControl.addLayer(i),n.layersInControl.push(i))),i.visible!==!1&&n.leafletRef.addLayer(i.leafletObject)},removeLayer(i){i.layerType!==void 0&&(n.layerControl===void 0?n.layersToAdd=n.layersToAdd.filter(g=>g.name!==i.name):(n.layerControl.removeLayer(i.leafletObject),n.layersInControl=n.layersInControl.filter(g=>g.leafletObject._leaflet_id!==i.leafletObject._leaflet_id))),n.leafletRef.removeLayer(i.leafletObject)},registerLayerControl(i){n.layerControl=i,n.layersToAdd.forEach(g=>{n.layerControl.addLayer(g)}),n.layersToAdd=[],l(i)},registerControl(i){n.leafletRef.addControl(i.leafletObject)},setZoom(i){const g=n.leafletRef.getZoom();i!==g&&n.leafletRef.setZoom(i,{animate:e.noBlockingAnimations?!1:null})},setPaddingBottomRight(i){n.paddingBottomRight=i},setPaddingTopLeft(i){n.paddingTopLeft=i},setPadding(i){n.padding=i},setCrs(i){const g=n.leafletRef.getBounds();n.leafletRef.options.crs=i,n.leafletRef.fitBounds(g,{animate:!1,padding:[0,0]})},fitBounds(i){n.leafletRef.fitBounds(i,{animate:this.noBlockingAnimations?!1:null})},setBounds(i){if(!i)return;const g=M(i);if(!g.isValid())return;!(n.lastSetBounds||n.leafletRef.getBounds()).equals(g,0)&&(n.lastSetBounds=g,n.leafletRef.fitBounds(g,this.fitBoundsOptions))},setCenter(i){if(i==null)return;const g=S(i),R=n.lastSetCenter||n.leafletRef.getCenter();(R.lat!==g.lat||R.lng!==g.lng)&&(n.lastSetCenter=g,n.leafletRef.panTo(g,{animate:this.noBlockingAnimations?!1:null}))}};ue(s,P.addLayer),ue(d,P.removeLayer),ue(l,P.registerControl),ue(v,P.registerLayerControl),n.leafletRef=u(o.value,c),X(P,n.leafletRef,e);const F=q(t.attrs);n.leafletRef.on("moveend",De(a.moveEndHandler,100)),n.leafletRef.on("overlayadd",a.overlayAddHandler),n.leafletRef.on("overlayremove",a.overlayRemoveHandler),x.on(n.leafletRef,F),n.ready=!0,z(()=>t.emit("ready",n.leafletRef))}),te(()=>{n.leafletRef&&n.leafletRef.remove()});const y=G(()=>n.leafletRef),B=G(()=>n.ready);return{root:o,ready:B,leafletObject:y}},render(){return ce("div",{style:{width:"100%",height:"100%"},ref:"root"},this.ready?this.$slots.default():{})}};Ve.__file="src/components/LMap.vue";const Ct={...be,pane:{type:String,default:"markerPane"},draggable:{type:Boolean,custom:!0,default:!1},latLng:{type:[Object,Array],custom:!0,default:null},icon:{type:[Object],default:()=>{},custom:!1},zIndexOffset:{type:Number,custom:!1,default:null}},Mt=(e,t,o)=>{const{options:n,methods:f}=he(e,t,o),c={...n,...e},s={...f,setDraggable(d){t.value.dragging&&(d?t.value.dragging.enable():t.value.dragging.disable())},latLngSync(d){o.emit("update:latLng",d.latlng),o.emit("update:lat-lng",d.latlng)},setLatLng(d){if(d!=null&&t.value){const l=t.value.getLatLng();(!l||!l.equals(d))&&t.value.setLatLng(d)}}};return{options:c,methods:s}};var ee={name:"LMarker",props:Ct,setup(e,t){const o=L({}),n=L(!1),f=C(J),c=C("addLayer");V("canSetParentHtml",()=>!!o.value.getElement()),V("setParentHtml",l=>o.value.getElement().innerHTML=l),V("setIcon",l=>o.value.setIcon&&o.value.setIcon(l));const{options:s,methods:d}=Mt(e,o,t);return s.icon===void 0&&delete s.icon,Z(async()=>{const{marker:l,DomEvent:v}=f?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);o.value=l(e.latLng,s);const a=q(t.attrs);v.on(o.value,a),o.value.on("move",De(d.latLngSync,100)),X(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,z(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return ke(this.ready,this.$slots)}};ee.__file="src/components/LMarker.vue";const Ne={...wt,latLngs:{type:Array,default:()=>[]},smoothFactor:{type:Number,custom:!0,default:1},noClip:{type:Boolean,custom:!0,default:!1}},Et=(e,t,o)=>{const{options:n,methods:f}=Ot(e,t,o),c={...n,...e},s={...f,setSmoothFactor(d){t.value.setStyle({smoothFactor:d})},setNoClip(d){t.value.setStyle({noClip:d})},addLatLng(d){t.value.addLatLng(d)}};return{options:c,methods:s}};({...Ne});var ve={name:"LPolyline",props:Ne,setup(e,t){const o=L({}),n=L(!1),f=C(J),c=C("addLayer"),{options:s,methods:d}=Et(e,o,t);return Z(async()=>{const{polyline:l,DomEvent:v}=f?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);o.value=l(e.latLngs,s);const a=q(t.attrs);v.on(o.value,a),X(d,o.value,e),c({...e,...d,leafletObject:o.value}),n.value=!0,z(()=>t.emit("ready",o.value))}),{ready:n,leafletObject:o}},render(){return ke(this.ready,this.$slots)}};ve.__file="src/components/LPolyline.vue";const Pt={...oe,content:{type:String,default:null}},It=(e,t)=>{const{options:o,methods:n}=ne(e),f={...n,setContent(c){t.value&&c!==null&&c!==void 0&&t.value.setContent(c)}};return{options:o,methods:f}},Bt=e=>e.default?ce("div",{ref:"root"},e.default()):null,$e={...St,tms:{type:Boolean,default:!1},subdomains:{type:String,default:"abc"},detectRetina:{type:Boolean,default:!1},url:{type:String,default:null}},xt=(e,t)=>{const{options:o,methods:n}=Tt(e,t);return{options:{...o,tms:e.tms,subdomains:e.subdomains,detectRetina:e.detectRetina},methods:{...n}}};var je={props:$e,setup(e,t){const o=L({}),n=C(J),f=C("addLayer"),{options:c,methods:s}=xt(e,o);return Z(async()=>{const{tileLayer:d,DomEvent:l}=n?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);o.value=d(e.url,c);const v=q(t.attrs);l.on(o.value,v),X(s,o.value,e),f({...e,...s,leafletObject:o.value}),z(()=>t.emit("ready",o.value))}),{leafletObject:o}},render(){return null}};je.__file="src/components/LTileLayer.vue";const Dt={...Pt},kt=(e,t)=>{const{options:o,methods:n}=It(e,t),f=C("unbindTooltip");return te(()=>{f()}),{options:o,methods:n}};var ge={name:"LTooltip",props:Dt,setup(e,t){const o=L({}),n=L(null),f=C(J),c=C("bindTooltip"),{options:s,methods:d}=kt(e,o);return Z(async()=>{const{tooltip:l,DomEvent:v}=f?j.L:await k(()=>import("./leaflet-src.esm.13473dcf.js"),[],import.meta.url);o.value=l(s),X(d,o.value,e);const a=q(t.attrs);v.on(o.value,a),o.value.setContent(e.content||n.value),c({leafletObject:o.value}),z(()=>t.emit("ready",o.value))}),{root:n,leafletObject:o}},render(){return Bt(this.$slots)}};ge.__file="src/components/LTooltip.vue";({...$e});const Vt=I("svg",{xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24"},[I("path",{fill:"blue",d:`M12 3L2 12h3v8h14v-8h3L12 3m0 4.7c2.1 0 3.8 1.7
            3.8 3.8c0 3-3.8 6.5-3.8 6.5s-3.8-3.5-3.8-6.5c0-2.1
            1.7-3.8 3.8-3.8m0 2.3a1.5 1.5 0 0 0-1.5 1.5A1.5 1.5
            0 0 0 12 13a1.5 1.5 0 0 0 1.5-1.5A1.5 1.5 0 0 0 12 10Z`})],-1),jt=qe({__name:"Map",props:{widget:{}},setup(e){var we;Se.registerUsage(Te.latitude),Se.registerUsage(Te.longitude);const t=Je(),o=Ye(),n=L(18),f=L(null),c=L([-27.5935,-48.55854]),s=L(c.value),d=L(void 0),l=G(()=>t.coordinates.latitude?[t.coordinates.latitude,t.coordinates.longitude]:void 0),v=G(()=>{var r;return t.attitude.yaw?Ke((r=t.attitude)==null?void 0:r.yaw):0}),{history:a}=Qe(l),y=G(()=>a.value.filter(r=>r.snapshot!==void 0).map(r=>r.snapshot)),B=G(()=>{const r=t.lastHeartbeat;return r?`${gt(r!=null?r:0,{includeSeconds:!0})} ago`:"never"}),u=new et(r=>d.value=r,r=>c.value=r);u.setTrackableTarget(D.VEHICLE,()=>l.value),u.setTrackableTarget(D.HOME,()=>s.value);const b=L(null),O=L(null);let M=!0;(we=navigator==null?void 0:navigator.geolocation)==null||we.watchPosition(r=>{s.value=[r.coords.latitude,r.coords.longitude],M&&(u.goToTarget(D.HOME),M=O.value!==null)},r=>{console.error(`Failed to get position: (${r.code}) ${r.message}`)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:0});let S=null;const x=async()=>{var r,m;if(await z(),S=(r=b.value)==null?void 0:r.leafletObject,!S){console.warn("Failed to get leaflet reference");return}if(O.value=(m=b.value)==null?void 0:m.leafletObject,S.on("click",fe),O.value==null){console.warn("Failed to get leaflet reference");return}O.value.zoomControl.setPosition("bottomright"),S.on("contextmenu",()=>{P()}),setTimeout(()=>u.goToTarget(D.HOME),2e3)},w=L(null),P=()=>{ae.value=!1,w.value=null},F=r=>{r.key==="Escape"&&P()};Z(()=>{window.addEventListener("keydown",F)});const i=L(!1),g=L(0),R=async()=>{for(i.value=!0,g.value=0;o.currentPlanningWaypoints.length>0;)o.currentPlanningWaypoints.pop();const r=async m=>{g.value=m};try{(await t.fetchMission(r)).forEach(_=>{o.currentPlanningWaypoints.push(_),Ee.fire({icon:"success",title:"Mission download succeed!",timer:2e3})})}catch(m){Ee.fire({icon:"error",title:"Mission download failed",text:m,timer:5e3})}finally{i.value=!1}},Le=()=>{t.startMission()},_e=e,N=tt(_e).widget;ye(_e.widget,()=>{var r;(r=O.value)==null||r.invalidateSize()}),ot(()=>{Object.keys(N.value.options).length===0&&(N.value.options={showVehiclePath:!0}),u.enableAutoUpdate()}),te(()=>{u.disableAutoUpdate(),S&&S.off("click",fe)}),te(()=>{window.removeEventListener("keydown",F),S&&S.off("contextmenu")});const ae=L(!1),le=Be({top:"0px",left:"0px"}),fe=r=>{var m,_,T;if(console.log("Map click event:",r),((m=r==null?void 0:r.latlng)==null?void 0:m.lat)!=null&&((_=r==null?void 0:r.latlng)==null?void 0:_.lng)!=null){w.value=[r.latlng.lat,r.latlng.lng],ae.value=!0;const E=(T=O.value)==null?void 0:T.getContainer();if(E){const{x:Y,y:W}=E.getBoundingClientRect();le.left=`${r.originalEvent.clientX-Y}px`,le.top=`${r.originalEvent.clientY-W}px`}}else console.error("Invalid event structure:",r)},ze=r=>{var m;switch(console.log(`Option selected: ${r}`),r){case"goto":if(w.value){const W=(m=t.coordinates.altitude)!=null?m:0,Re=w.value[0],Ue=w.value[1];t.goTo(0,0,0,0,Re,Ue,W)}break;default:console.warn("Unknown menu option selected:",r)}ae.value=!1};return(r,m)=>($(),me(Me,null,[h(p(Ve),{ref_key:"map",ref:b,modelValue:n.value,"onUpdate:modelValue":m[6]||(m[6]=_=>n.value=_),zoom:n.value,"onUpdate:zoom":m[7]||(m[7]=_=>n.value=_),bounds:f.value,"onUpdate:bounds":m[8]||(m[8]=_=>f.value=_),center:c.value,"onUpdate:center":m[9]||(m[9]=_=>c.value=_),"max-zoom":19,class:"map",onReady:x,onClick:fe},{default:A(()=>{var _;return[w.value?($(),K(p(ee),{key:0,"lat-lng":w.value},{default:A(()=>[h(p(ge),null,{default:A(()=>[I("div",null,"coordinates: "+U(w.value),1)]),_:1})]),_:1},8,["lat-lng"])):Q("",!0),h(Ae,{location:"top center",text:"Home position is currently undefined",disabled:Boolean(s.value)},{activator:A(({props:T})=>[h(ie,Ce({class:["absolute left-0 m-3 bottom-12 bg-slate-50",s.value?"":"active-events-on-disabled"],color:d.value==p(D).HOME?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-home-map-marker",size:"x-small"},T,{disabled:!s.value,onClick:m[0]||(m[0]=H(E=>p(u).goToTarget(p(D).HOME,!0),["stop"])),onDblclick:m[1]||(m[1]=H(E=>p(u).follow(p(D).HOME),["stop"]))}),null,16,["class","color","disabled"])]),_:1},8,["disabled"]),ae.value?($(),me("div",{key:1,class:"context-menu",style:nt({top:le.top,left:le.left})},[I("ul",{onClick:m[3]||(m[3]=H(()=>{},["stop"]))},[I("li",{onClick:m[2]||(m[2]=T=>ze("goto"))},"GoTo")])],4)):Q("",!0),h(Ae,{location:"top center",text:"Vehicle position is currently undefined",disabled:Boolean(l.value)},{activator:A(({props:T})=>[h(ie,Ce({class:["absolute m-3 bottom-12 left-10 bg-slate-50",l.value?"":"active-events-on-disabled"],color:d.value==p(D).VEHICLE?"red":"",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-airplane-marker",size:"x-small"},T,{disabled:!l.value,onClick:m[4]||(m[4]=H(E=>p(u).goToTarget(p(D).VEHICLE,!0),["stop"])),onDblclick:m[5]||(m[5]=H(E=>p(u).follow(p(D).VEHICLE),["stop"]))}),null,16,["class","color","disabled"])]),_:1},8,["disabled"]),h(ie,{class:"absolute m-3 bottom-12 left-20 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-download",size:"x-small",onClick:H(R,["stop"])}),h(ie,{class:"absolute mb-3 ml-1 bottom-12 left-32 bg-slate-50",elevation:"2",style:{"z-index":"1002","border-radius":"0px"},icon:"mdi-play",size:"x-small",onClick:H(Le,["stop"])}),($(!0),me(Me,null,at(p(o).currentPlanningWaypoints,(T,E)=>($(),K(p(ee),{key:T.id,"lat-lng":T.coordinates},{default:A(()=>[h(p(de),{"icon-anchor":[12,12],"class-name":"markerIcon"},{default:A(()=>[I("div",null,U(E),1)]),_:2},1024)]),_:2},1032,["lat-lng"]))),128)),h(p(ve),{"lat-lngs":p(o).currentPlanningWaypoints.map(T=>T.coordinates),color:"rgba(1, 1, 1, 0.5)"},null,8,["lat-lngs"]),s.value?($(),K(p(ee),{key:2,"lat-lng":s.value},{default:A(()=>[h(p(de),{"icon-size":[24,24]},{default:A(()=>[Vt]),_:1})]),_:1},8,["lat-lng"])):Q("",!0),h(p(ee),{"lat-lng":(_=l.value)!=null?_:[0,0],name:"Vehicle"},{default:A(()=>[h(p(ge),null,{default:A(()=>{var T,E,Y,W;return[I("p",null,"Coordinates: "+U((T=l.value)!=null?T:"No data available"),1),I("p",null,"Velocity: "+U((Y=`${(E=p(t).velocity.ground)==null?void 0:E.toFixed(2)} m/s`)!=null?Y:"No data available"),1),I("p",null,"Heading: "+U((W=`${v.value.toFixed(2)}\xB0`)!=null?W:"No data available"),1),I("p",null,U(p(t).isArmed?"Armed":"Disarmed"),1),I("p",null,"Last seen: "+U(B.value),1)]}),_:1}),h(p(de),{"icon-anchor":[50,50]},{default:A(()=>[h(ft,{type:p(t).vehicleType,heading:v.value},null,8,["type","heading"])]),_:1})]),_:1},8,["lat-lng"]),p(N).options.showVehiclePath?($(),K(p(ve),{key:3,"lat-lngs":y.value},null,8,["lat-lngs"])):Q("",!0),h(p(je),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})]}),_:1},8,["modelValue","zoom","bounds","center"]),h(dt,{modelValue:p(N).managerVars.configMenuOpen,"onUpdate:modelValue":m[11]||(m[11]=_=>p(N).managerVars.configMenuOpen=_),width:"auto"},{default:A(()=>[h(lt,{class:"pa-2"},{default:A(()=>[h(st,null,{default:A(()=>[it("Map widget settings")]),_:1}),h(rt,null,{default:A(()=>[h(ut,{modelValue:p(N).options.showVehiclePath,"onUpdate:modelValue":m[10]||(m[10]=_=>p(N).options.showVehiclePath=_),class:"my-1",label:"Show vehicle path",color:p(N).options.showVehiclePath?"rgb(0, 20, 80)":void 0,"hide-details":""},null,8,["modelValue","color"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i.value?($(),K(ct,{key:0,"model-value":g.value,height:"10",absolute:"",bottom:"",color:"rgba(0, 110, 255, 0.8)"},null,8,["model-value"])):Q("",!0)],64))}});export{jt as default};
