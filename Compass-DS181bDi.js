import{d as P,a5 as B,v as u,A as U,x as m,o as I,j as $,a as f,X as j,ax as H,ay as z,a4 as F,q,D as X,u as G,a9 as J,az as Y,l as K,as as Q,at as c,aA as Z,aq as N,ao as ee,H as ae,c as te,i as V,J as se,ah as oe,b as g,L as ne,a1 as le,a2 as re,a3 as ie}from"./index-Bm_whh5E.js";import{g as h}from"./index-ZORhgBxb.js";const de=P({__name:"Dialog",props:{show:Boolean},emits:["update:show"],setup(o,{emit:p}){const v=o,w=p,d=B(v).show,n=u(d.value),i=u(),y=u();return U(()=>{i.value.addEventListener("click",t=>{!t.target||t.target instanceof HTMLElement&&!t.target.closest(".action-button")&&t.target.nodeName!=="DIALOG"||(n.value=!1)}),document.addEventListener("keydown",t=>{n.value&&t.key==="Escape"&&(t.preventDefault(),t.stopImmediatePropagation(),n.value=!1)},{passive:!1})}),m(d,()=>n.value=d.value),m(n,()=>{n.value?i.value.showModal():(i.value.setAttribute("closing",""),i.value.addEventListener("animationend",()=>{i.value.removeAttribute("closing"),i.value.close()},{once:!0})),w("update:show",n.value)}),(t,l)=>(I(),$(z,{to:"body"},[f("dialog",{ref_key:"dialogRef",ref:i,class:"modal"},[f("div",j({ref_key:"dialogContentRef",ref:y},t.$attrs,{class:"flex flex-col items-center justify-center w-full h-full p-5 backdrop-blur-sm"}),[H(t.$slots,"default")],16)],512)]))}}),ce=o=>(le("data-v-b5f35b8a"),o=o(),re(),o),ge=["height","width"],ue={class:"flex items-center"},fe=ce(()=>f("span",{class:"mr-3 text-slate-100"},"Heading style",-1)),pe={class:"w-40"};var L=(o=>(o.NORTH_UP="North Up",o.HEAD_UP="Head Up",o))(L||{});const ve=P({__name:"Compass",props:{widget:{}},setup(o){const p=F();q.registerUsage(X.heading);const v=G(),w=u(),d=u(),n=u(),i={0:"N",45:"NE",90:"E",135:"SE",180:"S",225:"SW",270:"W",315:"NW"},y=Object.values(L),l=B(o).widget;J(()=>{Object.keys(l.value.options).length===0&&(l.value.options={headingStyle:y[0]})}),U(()=>{M(),W()});const{width:T,height:R}=Y(w),b=K(()=>T.value<R.value?T.value:R.value),W=()=>{if(d.value===void 0||d.value===null)return;n.value===void 0&&(n.value=d.value.getContext("2d"));const e=n.value;Q(e);const a=.5*b.value,r=.13*b.value,x=.03*a;e.textAlign="center",e.strokeStyle="white",e.font=`bold ${r}px Arial`,e.fillStyle="white",e.lineWidth=x,e.textBaseline="middle";const _=.7*a,C=.4*a,E=.55*a;e.translate(a,a),e.font=`bold ${r}px Arial`,e.fillText(`${s.yawAngleDegrees.toFixed(0)}Â°`,.15*r,0),e.rotate(c(-90)),l.value.options.headingStyle=="Head Up"&&e.rotate(-c(s.yawAngleDegrees));for(const[k,O]of Object.entries(i))e.save(),e.rotate(c(Number(k))),e.beginPath(),e.moveTo(E,0),e.lineTo(_,0),e.textBaseline="bottom",e.font=`bold ${.7*r}px Arial`,e.translate(_*1.025,0),e.rotate(c(90)),e.fillText(O,0,0),e.stroke(),e.restore();for(const k of Z(360))k%9===0&&(e.save(),e.lineWidth=.25*x,e.rotate(c(Number(k))),e.beginPath(),e.moveTo(1.1*E,0),e.lineTo(_,0),e.stroke(),e.restore());e.beginPath(),e.arc(0,0,_,0,c(360)),e.stroke(),l.value.options.headingStyle=="North Up"?e.rotate(c(s.yawAngleDegrees)):e.rotate(c(s.yawAngleDegrees)),e.beginPath(),e.lineWidth=1,e.strokeStyle="red",e.fillStyle="red";const S=.05*a;e.moveTo(C,S),e.lineTo(E-.5*S,0),e.lineTo(C,-S),e.lineTo(C,S),e.closePath(),e.fill(),e.stroke()},A=u(.01);let D;m(v.attitude,e=>{if(D===void 0){A.value=N(v.attitude.yaw),D=e.yaw;return}Math.abs(N(e.yaw-D))>.1&&(D=e.yaw,A.value=N(v.attitude.yaw))});const s=ee({yawAngleDegrees:0}),M=()=>{const e=A.value,a=e<0?e+360:e,r=s.yawAngleDegrees>270&&a<90,x=s.yawAngleDegrees<90&&a>270;r?(h.to(s,.05,{yawAngleDegrees:0}),h.fromTo(s,.05,{yawAngleDegrees:0},{yawAngleDegrees:a})):x?(h.to(s,.05,{yawAngleDegrees:360}),h.fromTo(s,.05,{yawAngleDegrees:360},{yawAngleDegrees:a})):h.to(s,.1,{yawAngleDegrees:a})};return m(A,()=>M()),m([s,T,R],()=>{p.isWidgetVisible(l.value)&&ae(()=>W())}),(e,a)=>(I(),te(ne,null,[f("div",{ref_key:"compassRoot",ref:w,class:"compass"},[f("canvas",{ref_key:"canvasRef",ref:d,height:b.value,width:b.value,class:"rounded-[15%] bg-slate-950/70"},null,8,ge)],512),V(de,{show:g(p).widgetManagerVars(g(l).hash).configMenuOpen,"onUpdate:show":a[1]||(a[1]=r=>g(p).widgetManagerVars(g(l).hash).configMenuOpen=r),class:"flex pa-4 bg-[#ffffff10] text-white backdrop-blur-2xl border-[1px] border-[#FAFAFA12]"},{default:se(()=>[f("div",ue,[fe,f("div",pe,[V(oe,{modelValue:g(l).options.headingStyle,"onUpdate:modelValue":a[0]||(a[0]=r=>g(l).options.headingStyle=r),options:g(y)},null,8,["modelValue","options"])])])]),_:1},8,["show"])],64))}}),we=ie(ve,[["__scopeId","data-v-b5f35b8a"]]);export{we as default};
