import{z as Gt,A as Zt,B as Is,C as Jt,F as ks,G as Kt,H as Vs,I as As,J as Qt,K as Os,L as es,M as Ds,N as Ms,O as Rs,P as Us,Q as ts,q as p,R as ss,v as Q,x as Vt,S as Ls,T as as,V as Xt,i as d,U as Fs,W as vt,X as Bs,Y as st,Z as zs,_ as Ys,$ as is,d as At,o as _,j as ke,a0 as Hs,a1 as m,a2 as We,a3 as W,a4 as w,t as k,a5 as os,a6 as Ws,l as kt,a7 as ns,c as C,a as u,a8 as De,a9 as ft,aa as be,k as L,n as ve,ab as tt,ac as js,ad as Xs,ae as $s,af as qs,ag as Gs,ah as Zs,ai as Js,aj as ls,ak as $t,al as Ks,am as rs,an as cs,ao as us,ap as Qs,aq as ea,ar as ta,as as sa,at as aa,au as qt,av as ia,aw as oa,ax as na,ay as la,az as ra,w as ca,aA as ua,aB as da,aC as fa,aD as va,aE as ha,aF as ma,aG as pa,aH as ga,aI as qe,aJ as ya,r as _a,b as Nt,aK as Ta,aL as xa}from"./index-CknxIVJT.js";var ds={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(l){(function(P,f,R,g){var E=["","webkit","Moz","MS","ms","o"],j=f.createElement("div"),Y="function",h=Math.round,D=Math.abs,N=Date.now;function r(e,t,s){return setTimeout(he(e,s),t)}function X(e,t,s){return Array.isArray(e)?(V(e,s[t],s),!0):!1}function V(e,t,s){var a;if(e)if(e.forEach)e.forEach(t,s);else if(e.length!==g)for(a=0;a<e.length;)t.call(s,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(s,e[a],a,e)}function U(e,t,s){var a="DEPRECATED METHOD: "+t+`
`+s+` AT 
`;return function(){var i=new Error("get-stack-trace"),c=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",b=P.console&&(P.console.warn||P.console.log);return b&&b.call(P.console,a,c),e.apply(this,arguments)}}var I;typeof Object.assign!="function"?I=function(t){if(t===g||t===null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),a=1;a<arguments.length;a++){var i=arguments[a];if(i!==g&&i!==null)for(var c in i)i.hasOwnProperty(c)&&(s[c]=i[c])}return s}:I=Object.assign;var x=U(function(t,s,a){for(var i=Object.keys(s),c=0;c<i.length;)(!a||a&&t[i[c]]===g)&&(t[i[c]]=s[i[c]]),c++;return t},"extend","Use `assign`."),ae=U(function(t,s){return x(t,s,!0)},"merge","Use `assign`.");function z(e,t,s){var a=t.prototype,i;i=e.prototype=Object.create(a),i.constructor=e,i._super=a,s&&I(i,s)}function he(e,t){return function(){return e.apply(t,arguments)}}function ne(e,t){return typeof e==Y?e.apply(t&&t[0]||g,t):e}function F(e,t){return e===g?t:e}function $(e,t,s){V(y(t),function(a){e.addEventListener(a,s,!1)})}function ee(e,t,s){V(y(t),function(a){e.removeEventListener(a,s,!1)})}function me(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function S(e,t){return e.indexOf(t)>-1}function y(e){return e.trim().split(/\s+/g)}function q(e,t,s){if(e.indexOf&&!s)return e.indexOf(t);for(var a=0;a<e.length;){if(s&&e[a][s]==t||!s&&e[a]===t)return a;a++}return-1}function G(e){return Array.prototype.slice.call(e,0)}function Me(e,t,s){for(var a=[],i=[],c=0;c<e.length;){var b=t?e[c][t]:e[c];q(i,b)<0&&a.push(e[c]),i[c]=b,c++}return s&&(t?a=a.sort(function(se,oe){return se[t]>oe[t]}):a=a.sort()),a}function re(e,t){for(var s,a,i=t[0].toUpperCase()+t.slice(1),c=0;c<E.length;){if(s=E[c],a=s?s+i:t,a in e)return a;c++}return g}var pe=1;function H(){return pe++}function Ve(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||P}var ie=/mobile|tablet|ip(ad|hone|od)|android/i,we="ontouchstart"in P,ce=re(P,"PointerEvent")!==g,Ge=we&&ie.test(navigator.userAgent),Re="touch",mt="pen",Ze="mouse",je="kinect",pt=25,te=1,Ee=2,B=4,Z=8,Ue=1,Le=2,Ae=4,Fe=8,Be=16,ue=Le|Ae,ge=Fe|Be,it=ue|ge,ot=["x","y"],ze=["clientX","clientY"];function le(e,t){var s=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(a){ne(e.options.enable,[e])&&s.handler(a)},this.init()}le.prototype={handler:function(){},init:function(){this.evEl&&$(this.element,this.evEl,this.domHandler),this.evTarget&&$(this.target,this.evTarget,this.domHandler),this.evWin&&$(Ve(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ee(this.element,this.evEl,this.domHandler),this.evTarget&&ee(this.target,this.evTarget,this.domHandler),this.evWin&&ee(Ve(this.element),this.evWin,this.domHandler)}};function gt(e){var t,s=e.options.inputClass;return s?t=s:ce?t=_t:Ge?t=nt:we?t=Tt:t=Xe,new t(e,yt)}function yt(e,t,s){var a=s.pointers.length,i=s.changedPointers.length,c=t&te&&a-i===0,b=t&(B|Z)&&a-i===0;s.isFirst=!!c,s.isFinal=!!b,c&&(e.session={}),s.eventType=t,Ye(e,s),e.emit("hammer.input",s),e.recognize(s),e.session.prevInput=s}function Ye(e,t){var s=e.session,a=t.pointers,i=a.length;s.firstInput||(s.firstInput=T(t)),i>1&&!s.firstMultiple?s.firstMultiple=T(t):i===1&&(s.firstMultiple=!1);var c=s.firstInput,b=s.firstMultiple,K=b?b.center:c.center,se=t.center=A(a);t.timeStamp=N(),t.deltaTime=t.timeStamp-c.timeStamp,t.angle=J(K,se),t.distance=O(K,se),n(s,t),t.offsetDirection=o(t.deltaX,t.deltaY);var oe=M(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=oe.x,t.overallVelocityY=oe.y,t.overallVelocity=D(oe.x)>D(oe.y)?oe.x:oe.y,t.scale=b?de(b.pointers,a):1,t.rotation=b?ye(b.pointers,a):0,t.maxPointers=s.prevInput?t.pointers.length>s.prevInput.maxPointers?t.pointers.length:s.prevInput.maxPointers:t.pointers.length,v(s,t);var xe=e.element;me(t.srcEvent.target,xe)&&(xe=t.srcEvent.target),t.target=xe}function n(e,t){var s=t.center,a=e.offsetDelta||{},i=e.prevDelta||{},c=e.prevInput||{};(t.eventType===te||c.eventType===B)&&(i=e.prevDelta={x:c.deltaX||0,y:c.deltaY||0},a=e.offsetDelta={x:s.x,y:s.y}),t.deltaX=i.x+(s.x-a.x),t.deltaY=i.y+(s.y-a.y)}function v(e,t){var s=e.lastInterval||t,a=t.timeStamp-s.timeStamp,i,c,b,K;if(t.eventType!=Z&&(a>pt||s.velocity===g)){var se=t.deltaX-s.deltaX,oe=t.deltaY-s.deltaY,xe=M(a,se,oe);c=xe.x,b=xe.y,i=D(xe.x)>D(xe.y)?xe.x:xe.y,K=o(se,oe),e.lastInterval=t}else i=s.velocity,c=s.velocityX,b=s.velocityY,K=s.direction;t.velocity=i,t.velocityX=c,t.velocityY=b,t.direction=K}function T(e){for(var t=[],s=0;s<e.pointers.length;)t[s]={clientX:h(e.pointers[s].clientX),clientY:h(e.pointers[s].clientY)},s++;return{timeStamp:N(),pointers:t,center:A(t),deltaX:e.deltaX,deltaY:e.deltaY}}function A(e){var t=e.length;if(t===1)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var s=0,a=0,i=0;i<t;)s+=e[i].clientX,a+=e[i].clientY,i++;return{x:h(s/t),y:h(a/t)}}function M(e,t,s){return{x:t/e||0,y:s/e||0}}function o(e,t){return e===t?Ue:D(e)>=D(t)?e<0?Le:Ae:t<0?Fe:Be}function O(e,t,s){s||(s=ot);var a=t[s[0]]-e[s[0]],i=t[s[1]]-e[s[1]];return Math.sqrt(a*a+i*i)}function J(e,t,s){s||(s=ot);var a=t[s[0]]-e[s[0]],i=t[s[1]]-e[s[1]];return Math.atan2(i,a)*180/Math.PI}function ye(e,t){return J(t[1],t[0],ze)+J(e[1],e[0],ze)}function de(e,t){return O(t[0],t[1],ze)/O(e[0],e[1],ze)}var Pe={mousedown:te,mousemove:Ee,mouseup:B},Se="mousedown",Je="mousemove mouseup";function Xe(){this.evEl=Se,this.evWin=Je,this.pressed=!1,le.apply(this,arguments)}z(Xe,le,{handler:function(t){var s=Pe[t.type];s&te&&t.button===0&&(this.pressed=!0),s&Ee&&t.which!==1&&(s=B),this.pressed&&(s&B&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[t],changedPointers:[t],pointerType:Ze,srcEvent:t}))}});var fs={pointerdown:te,pointermove:Ee,pointerup:B,pointercancel:Z,pointerout:Z},vs={2:Re,3:mt,4:Ze,5:je},Ot="pointerdown",Dt="pointermove pointerup pointercancel";P.MSPointerEvent&&!P.PointerEvent&&(Ot="MSPointerDown",Dt="MSPointerMove MSPointerUp MSPointerCancel");function _t(){this.evEl=Ot,this.evWin=Dt,le.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}z(_t,le,{handler:function(t){var s=this.store,a=!1,i=t.type.toLowerCase().replace("ms",""),c=fs[i],b=vs[t.pointerType]||t.pointerType,K=b==Re,se=q(s,t.pointerId,"pointerId");c&te&&(t.button===0||K)?se<0&&(s.push(t),se=s.length-1):c&(B|Z)&&(a=!0),!(se<0)&&(s[se]=t,this.callback(this.manager,c,{pointers:s,changedPointers:[t],pointerType:b,srcEvent:t}),a&&s.splice(se,1))}});var hs={touchstart:te,touchmove:Ee,touchend:B,touchcancel:Z},ms="touchstart",ps="touchstart touchmove touchend touchcancel";function Mt(){this.evTarget=ms,this.evWin=ps,this.started=!1,le.apply(this,arguments)}z(Mt,le,{handler:function(t){var s=hs[t.type];if(s===te&&(this.started=!0),!!this.started){var a=gs.call(this,t,s);s&(B|Z)&&a[0].length-a[1].length===0&&(this.started=!1),this.callback(this.manager,s,{pointers:a[0],changedPointers:a[1],pointerType:Re,srcEvent:t})}}});function gs(e,t){var s=G(e.touches),a=G(e.changedTouches);return t&(B|Z)&&(s=Me(s.concat(a),"identifier",!0)),[s,a]}var ys={touchstart:te,touchmove:Ee,touchend:B,touchcancel:Z},_s="touchstart touchmove touchend touchcancel";function nt(){this.evTarget=_s,this.targetIds={},le.apply(this,arguments)}z(nt,le,{handler:function(t){var s=ys[t.type],a=Ts.call(this,t,s);a&&this.callback(this.manager,s,{pointers:a[0],changedPointers:a[1],pointerType:Re,srcEvent:t})}});function Ts(e,t){var s=G(e.touches),a=this.targetIds;if(t&(te|Ee)&&s.length===1)return a[s[0].identifier]=!0,[s,s];var i,c,b=G(e.changedTouches),K=[],se=this.target;if(c=s.filter(function(oe){return me(oe.target,se)}),t===te)for(i=0;i<c.length;)a[c[i].identifier]=!0,i++;for(i=0;i<b.length;)a[b[i].identifier]&&K.push(b[i]),t&(B|Z)&&delete a[b[i].identifier],i++;if(K.length)return[Me(c.concat(K),"identifier",!0),K]}var xs=2500,Rt=25;function Tt(){le.apply(this,arguments);var e=he(this.handler,this);this.touch=new nt(this.manager,e),this.mouse=new Xe(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}z(Tt,le,{handler:function(t,s,a){var i=a.pointerType==Re,c=a.pointerType==Ze;if(!(c&&a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents)){if(i)bs.call(this,s,a);else if(c&&ws.call(this,a))return;this.callback(t,s,a)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function bs(e,t){e&te?(this.primaryTouch=t.changedPointers[0].identifier,Ut.call(this,t)):e&(B|Z)&&Ut.call(this,t)}function Ut(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var s={x:t.clientX,y:t.clientY};this.lastTouches.push(s);var a=this.lastTouches,i=function(){var c=a.indexOf(s);c>-1&&a.splice(c,1)};setTimeout(i,xs)}}function ws(e){for(var t=e.srcEvent.clientX,s=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var i=this.lastTouches[a],c=Math.abs(t-i.x),b=Math.abs(s-i.y);if(c<=Rt&&b<=Rt)return!0}return!1}var Lt=re(j.style,"touchAction"),Ft=Lt!==g,Bt="compute",zt="auto",xt="manipulation",He="none",Ke="pan-x",Qe="pan-y",lt=Ps();function bt(e,t){this.manager=e,this.set(t)}bt.prototype={set:function(e){e==Bt&&(e=this.compute()),Ft&&this.manager.element.style&&lt[e]&&(this.manager.element.style[Lt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return V(this.manager.recognizers,function(t){ne(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Es(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,s=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var a=this.actions,i=S(a,He)&&!lt[He],c=S(a,Qe)&&!lt[Qe],b=S(a,Ke)&&!lt[Ke];if(i){var K=e.pointers.length===1,se=e.distance<2,oe=e.deltaTime<250;if(K&&se&&oe)return}if(!(b&&c)&&(i||c&&s&ue||b&&s&ge))return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Es(e){if(S(e,He))return He;var t=S(e,Ke),s=S(e,Qe);return t&&s?He:t||s?t?Ke:Qe:S(e,xt)?xt:zt}function Ps(){if(!Ft)return!1;var e={},t=P.CSS&&P.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(s){e[s]=t?P.CSS.supports("touch-action",s):!0}),e}var rt=1,fe=2,$e=4,Oe=8,Ce=Oe,et=16,Te=32;function Ne(e){this.options=I({},this.defaults,e||{}),this.id=H(),this.manager=null,this.options.enable=F(this.options.enable,!0),this.state=rt,this.simultaneous={},this.requireFail=[]}Ne.prototype={defaults:{},set:function(e){return I(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(X(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=ct(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return X(e,"dropRecognizeWith",this)?this:(e=ct(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(X(e,"requireFailure",this))return this;var t=this.requireFail;return e=ct(e,this),q(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(X(e,"dropRequireFailure",this))return this;e=ct(e,this);var t=q(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,s=this.state;function a(i){t.manager.emit(i,e)}s<Oe&&a(t.options.event+Yt(s)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),s>=Oe&&a(t.options.event+Yt(s))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Te},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Te|rt)))return!1;e++}return!0},recognize:function(e){var t=I({},e);if(!ne(this.options.enable,[this,t])){this.reset(),this.state=Te;return}this.state&(Ce|et|Te)&&(this.state=rt),this.state=this.process(t),this.state&(fe|$e|Oe|et)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}};function Yt(e){return e&et?"cancel":e&Oe?"end":e&$e?"move":e&fe?"start":""}function Ht(e){return e==Be?"down":e==Fe?"up":e==Le?"left":e==Ae?"right":""}function ct(e,t){var s=t.manager;return s?s.get(e):e}function _e(){Ne.apply(this,arguments)}z(_e,Ne,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,s=e.eventType,a=t&(fe|$e),i=this.attrTest(e);return a&&(s&Z||!i)?t|et:a||i?s&B?t|Oe:t&fe?t|$e:fe:Te}});function ut(){_e.apply(this,arguments),this.pX=null,this.pY=null}z(ut,_e,{defaults:{event:"pan",threshold:10,pointers:1,direction:it},getTouchAction:function(){var e=this.options.direction,t=[];return e&ue&&t.push(Qe),e&ge&&t.push(Ke),t},directionTest:function(e){var t=this.options,s=!0,a=e.distance,i=e.direction,c=e.deltaX,b=e.deltaY;return i&t.direction||(t.direction&ue?(i=c===0?Ue:c<0?Le:Ae,s=c!=this.pX,a=Math.abs(e.deltaX)):(i=b===0?Ue:b<0?Fe:Be,s=b!=this.pY,a=Math.abs(e.deltaY))),e.direction=i,s&&a>t.threshold&&i&t.direction},attrTest:function(e){return _e.prototype.attrTest.call(this,e)&&(this.state&fe||!(this.state&fe)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Ht(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}});function wt(){_e.apply(this,arguments)}z(wt,_e,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[He]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&fe)},emit:function(e){if(e.scale!==1){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}});function Et(){Ne.apply(this,arguments),this._timer=null,this._input=null}z(Et,Ne,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[zt]},process:function(e){var t=this.options,s=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!a||!s||e.eventType&(B|Z)&&!i)this.reset();else if(e.eventType&te)this.reset(),this._timer=r(function(){this.state=Ce,this.tryEmit()},t.time,this);else if(e.eventType&B)return Ce;return Te},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Ce&&(e&&e.eventType&B?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=N(),this.manager.emit(this.options.event,this._input)))}});function Pt(){_e.apply(this,arguments)}z(Pt,_e,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[He]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&fe)}});function St(){_e.apply(this,arguments)}z(St,_e,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ue|ge,pointers:1},getTouchAction:function(){return ut.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,s;return t&(ue|ge)?s=e.overallVelocity:t&ue?s=e.overallVelocityX:t&ge&&(s=e.overallVelocityY),this._super.attrTest.call(this,e)&&t&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&D(s)>this.options.velocity&&e.eventType&B},emit:function(e){var t=Ht(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}});function dt(){Ne.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}z(dt,Ne,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[xt]},process:function(e){var t=this.options,s=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&te&&this.count===0)return this.failTimeout();if(a&&i&&s){if(e.eventType!=B)return this.failTimeout();var c=this.pTime?e.timeStamp-this.pTime<t.interval:!0,b=!this.pCenter||O(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!b||!c?this.count=1:this.count+=1,this._input=e;var K=this.count%t.taps;if(K===0)return this.hasRequireFailures()?(this._timer=r(function(){this.state=Ce,this.tryEmit()},t.interval,this),fe):Ce}return Te},failTimeout:function(){return this._timer=r(function(){this.state=Te},this.options.interval,this),Te},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ce&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ie(e,t){return t=t||{},t.recognizers=F(t.recognizers,Ie.defaults.preset),new Ct(e,t)}Ie.VERSION="2.0.7",Ie.defaults={domEvents:!1,touchAction:Bt,enable:!0,inputTarget:null,inputClass:null,preset:[[Pt,{enable:!1}],[wt,{enable:!1},["rotate"]],[St,{direction:ue}],[ut,{direction:ue},["swipe"]],[dt],[dt,{event:"doubletap",taps:2},["tap"]],[Et]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Ss=1,Wt=2;function Ct(e,t){this.options=I({},Ie.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=gt(this),this.touchAction=new bt(this,this.options.touchAction),jt(this,!0),V(this.options.recognizers,function(s){var a=this.add(new s[0](s[1]));s[2]&&a.recognizeWith(s[2]),s[3]&&a.requireFailure(s[3])},this)}Ct.prototype={set:function(e){return I(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?Wt:Ss},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var s,a=this.recognizers,i=t.curRecognizer;(!i||i&&i.state&Ce)&&(i=t.curRecognizer=null);for(var c=0;c<a.length;)s=a[c],t.stopped!==Wt&&(!i||s==i||s.canRecognizeWith(i))?s.recognize(e):s.reset(),!i&&s.state&(fe|$e|Oe)&&(i=t.curRecognizer=s),c++}},get:function(e){if(e instanceof Ne)return e;for(var t=this.recognizers,s=0;s<t.length;s++)if(t[s].options.event==e)return t[s];return null},add:function(e){if(X(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(X(e,"remove",this))return this;if(e=this.get(e),e){var t=this.recognizers,s=q(t,e);s!==-1&&(t.splice(s,1),this.touchAction.update())}return this},on:function(e,t){if(e!==g&&t!==g){var s=this.handlers;return V(y(e),function(a){s[a]=s[a]||[],s[a].push(t)}),this}},off:function(e,t){if(e!==g){var s=this.handlers;return V(y(e),function(a){t?s[a]&&s[a].splice(q(s[a],t),1):delete s[a]}),this}},emit:function(e,t){this.options.domEvents&&Cs(e,t);var s=this.handlers[e]&&this.handlers[e].slice();if(!(!s||!s.length)){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<s.length;)s[a](t),a++}},destroy:function(){this.element&&jt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function jt(e,t){var s=e.element;if(s.style){var a;V(e.options.cssProps,function(i,c){a=re(s.style,c),t?(e.oldCssProps[a]=s.style[a],s.style[a]=i):s.style[a]=e.oldCssProps[a]||""}),t||(e.oldCssProps={})}}function Cs(e,t){var s=f.createEvent("Event");s.initEvent(e,!0,!0),s.gesture=t,t.target.dispatchEvent(s)}I(Ie,{INPUT_START:te,INPUT_MOVE:Ee,INPUT_END:B,INPUT_CANCEL:Z,STATE_POSSIBLE:rt,STATE_BEGAN:fe,STATE_CHANGED:$e,STATE_ENDED:Oe,STATE_RECOGNIZED:Ce,STATE_CANCELLED:et,STATE_FAILED:Te,DIRECTION_NONE:Ue,DIRECTION_LEFT:Le,DIRECTION_RIGHT:Ae,DIRECTION_UP:Fe,DIRECTION_DOWN:Be,DIRECTION_HORIZONTAL:ue,DIRECTION_VERTICAL:ge,DIRECTION_ALL:it,Manager:Ct,Input:le,TouchAction:bt,TouchInput:nt,MouseInput:Xe,PointerEventInput:_t,TouchMouseInput:Tt,SingleTouchInput:Mt,Recognizer:Ne,AttrRecognizer:_e,Tap:dt,Pan:ut,Swipe:St,Pinch:wt,Rotate:Pt,Press:Et,on:$,off:ee,each:V,merge:ae,extend:x,assign:I,inherit:z,bindFn:he,prefixed:re});var Ns=typeof P<"u"?P:typeof self<"u"?self:{};Ns.Hammer=Ie,typeof g=="function"&&g.amd?g(function(){return Ie}):l.exports?l.exports=Ie:P[R]=Ie})(window,document,"Hammer")})(ds);var It=ds.exports;function ba(l){const P=ss(l);let f=-1;function R(){clearInterval(f)}function g(){R(),is(()=>P.value=l)}function E(j){const Y=j?getComputedStyle(j):{transitionDuration:.2},h=parseFloat(Y.transitionDuration)*1e3||200;if(R(),P.value<=0)return;const D=performance.now();f=window.setInterval(()=>{const N=performance.now()-D+h;P.value=Math.max(l-N,0),P.value<=0&&R()},h)}return Ys(R),{clear:R,time:P,start:E,reset:g}}const wa=Gt({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Zt({location:"bottom"}),...Is(),...Jt(),...ks(),...Kt(),...Vs(As({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Ea=Qt()({name:"VSnackbar",props:wa(),emits:{"update:modelValue":l=>!0},setup(l,P){let{slots:f}=P;const R=Os(l,"modelValue"),{locationStyles:g}=es(l),{positionClasses:E}=Ds(l),{scopeId:j}=Ms(),{themeClasses:Y}=Rs(l),{colorClasses:h,colorStyles:D,variantClasses:N}=Us(l),{roundedClasses:r}=ts(l),X=ba(Number(l.timeout)),V=p(),U=p(),I=ss(!1);Q(R,ae),Q(()=>l.timeout,ae),Vt(()=>{R.value&&ae()});let x=-1;function ae(){X.reset(),window.clearTimeout(x);const F=Number(l.timeout);if(!R.value||F===-1)return;const $=Ls(U.value);X.start($),x=window.setTimeout(()=>{R.value=!1},F)}function z(){X.reset(),window.clearTimeout(x)}function he(){I.value=!0,z()}function ne(){I.value=!1,ae()}return as(()=>{const F=Xt.filterProps(l),$=!!(f.default||f.text||l.text);return d(Xt,st({ref:V,class:["v-snackbar",{"v-snackbar--active":R.value,"v-snackbar--multi-line":l.multiLine&&!l.vertical,"v-snackbar--timer":!!l.timer,"v-snackbar--vertical":l.vertical},E.value,l.class],style:l.style},F,{modelValue:R.value,"onUpdate:modelValue":ee=>R.value=ee,contentProps:st({class:["v-snackbar__wrapper",Y.value,h.value,r.value,N.value],style:[g.value,D.value],onPointerenter:he,onPointerleave:ne},F.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},j),{default:()=>{var ee,me;return[Fs(!1,"v-snackbar"),l.timer&&!I.value&&d("div",{key:"timer",class:"v-snackbar__timer"},[d(vt,{ref:U,color:typeof l.timer=="string"?l.timer:"info",max:l.timeout,"model-value":X.time.value},null)]),$&&d("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((ee=f.text)==null?void 0:ee.call(f))??l.text,(me=f.default)==null?void 0:me.call(f)]),f.actions&&d(Bs,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[d("div",{class:"v-snackbar__actions"},[f.actions()])]})]},activator:f.activator})}),zs({},V)}}),Pa=At({__name:"Snackbar",props:{openSnackbar:Boolean,closeButton:Boolean,message:{type:String,default:""},duration:{type:Number,default:3e3}},emits:["update:openSnackbar"],setup(l,{emit:P}){const f=l,R=P,g=p(f.openSnackbar),E=p(f.message),j=p(f.duration||3e3),Y=()=>{g.value=!1,R("update:openSnackbar",!1)};return Q(()=>f.openSnackbar,h=>{g.value=h}),Q(()=>f.message,h=>{E.value=h}),Q(g,h=>{h||R("update:openSnackbar",!1)}),(h,D)=>(_(),ke(Ea,{modelValue:g.value,"onUpdate:modelValue":D[0]||(D[0]=N=>g.value=N),elevation:"4",rounded:"lg",color:"#ffffff40",timeout:j.value,location:"bottom left","content-class":"bg-[#4f4f4f44] backdrop-filter backdrop-blur-lg text-white mb-[50px]",style:{marginBottom:40}},Hs({default:m(()=>[w(k(E.value)+" ",1)]),_:2},[l.closeButton?{name:"actions",fn:m(()=>[d(We,{color:"white",variant:"text",onClick:Y},{default:m(()=>[d(W,null,{default:m(()=>[w("mdi-close")]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["modelValue","timeout"]))}}),at=l=>(rs("data-v-9eaca5cf"),l=l(),cs(),l),Sa={class:"video-modal"},Ca={class:"modal-content"},Na={class:"flex flex-col justify-between h-full px-5 py-3 align-center"},Ia={class:"flex flex-col justify-between pt-2 align-center gap-y-8"},ka=["disabled","onClick"],Va={class:"flex flex-col justify-center py-2 mb-[10px] align-center"},Aa={class:"flex flex-col p-2 gap-y-2"},Oa=at(()=>u("div",null,[u("strong",null,"Computer:"),w(" Command+click, Ctrl+click or Long click to select multiple videos. ")],-1)),Da=at(()=>u("div",null,[u("strong",null,"Mobile:"),w(" Long press to select multiple videos.")],-1)),Ma={class:"flex flex-row mt-4 gap-x-10"},Ra={class:"ml-[-8px]"},Ua={class:"frosted-button flex flex-col justify-center align-center w-[28px] h-[28px] rounded-full mb-1"},La=at(()=>u("div",{class:"text-sm"},"Close",-1)),Fa={key:0,class:"flex flex-col justify-between align-center pt-8 px-2 w-[300px] h-[480px]"},Ba={class:"flex flex-col w-full h-full px-4 overflow-auto align-center"},za={class:"relative video-wrapper"},Ya=["id","poster"],Ha=["src"],Wa=["onClick"],ja=["onClick"],Xa={class:"flex flex-row justify-center w-full ml-1 overflow-hidden text-xs"},$a={key:0,class:"flex flex-row justify-between align-center h-[45px] w-full mb-[-15px]"},qa={key:1,class:"flex flex-col justify-between mt-5 align-center w-[720px]"},Ga=["controls","preload","poster"],Za=["src"],Ja={class:"processing-bar"},Ka={class:"w-0"},Qa={class:"flex flex-col p-2 gap-y-2"},ei={key:0,class:"flex flex-col justify-start w-full p-2 pt-3"},ti={class:"card-grid"},si={class:"text-sm"},ai={class:"video-card-dot"},ii={key:1,class:"flex flex-row justify-between w-full h-full px-8 overflow-hidden align-center"},oi={class:"flex flex-row justify-between pl-2 align-center gap-x-6"},ni={class:"flex flex-row cursor-default text-md"},li={key:0,class:"flex flex-row w-[320px] justify-center gap-x-4 align-center ml-1"},ri={key:0,class:"text-sm text-white border-2 rounded-md mt-[3px] border-[#ffffff44] bg-[#fafafa33] ml-4 px-1"},ci={class:"flex flex-row mt-2"},ui=["disabled","onClick"],di={class:"mb-10 slide-right-to-left"},fi={key:2},vi={key:2,class:"flex flex-row justify-center w-full h-full text-xl text-center align-center"},hi=at(()=>u("div",{class:"flex flex-col mb-2 text-center align-end"}," Processing multiple videos may take a while, depending on the number of videos and their sizes. Cockpit will be usable during the process, but the performance may be affected and recording of new videos is disabled. ",-1)),mi={key:0,class:"flex flex-col -mt-2 text-center align-center"},pi={class:"flex flex-col justify-between h-[140px] w-full pb-3"},gi={key:0,class:"flex flex-col justify-start"},yi={class:"mb-3 text-sm text-center"},_i={class:"flex flex-row justify-between w-full mb-2 align-center"},Ti={class:"text-sm font-bold w-[450px] text-nowrap text-start text-ellipsis overflow-x-hidden"},xi={class:"text-sm text-end"},bi={class:"flex flex-row justify-between w-full mb-2"},wi=at(()=>u("div",{class:"text-sm font-bold text-start"},"Overall Progress",-1)),Ei={class:"text-sm font-bold text-end"},Pi={key:1},Si={class:"flex flex-col justify-center w-full pb-3 text-center text-md"},Ci=At({__name:"VideoLibraryModal",props:{openModal:Boolean},emits:["update:openModal"],setup(l,{emit:P}){const f=os(),R=l,g=P,{showDialog:E,closeDialog:j}=Ws(),Y=p([]),h=p([]),D=p([]),N=p(R.openModal),r=p([]),X=p(null),V=p("videos"),U=p(!1),I=p(""),x=p(!1),ae=p(!1),z=p(!1),he=p({}),ne=p(!1),F=p(!1),$=p(!0),ee=p(!1),me=p(""),S=p([]),y=p(!1),q=p(""),G=p([]),Me=p(!1),re=p(!1),pe=p(0),H=p([{fileName:"",progress:0,message:""}]),Ve=p(0),ie=p(!1),we=p(null),ce=p(!1),Ge=p(!1),Re=[{name:"Videos",icon:"mdi-video-outline",selected:!0,disabled:!1,tooltip:""},{name:"Pictures",icon:"mdi-image-outline",selected:!1,disabled:!0,tooltip:"Coming soon"}],mt=kt(()=>[{name:"Delete",icon:"mdi-delete-outline",size:22,tooltip:"",confirmAction:!0,show:!0,disabled:ie.value===!0||re.value===!0,action:()=>yt()},{name:"Download",icon:"mdi-tray-arrow-down",size:28,tooltip:"Download selected videos with logs",confirmAction:!1,show:!0,disabled:ie.value===!0||re.value===!0,action:()=>le()}]),Ze=()=>{N.value=!1,g("update:openModal",!1),V.value="videos",Y.value.forEach(n=>URL.revokeObjectURL(n)),Y.value=[],ge(),we.value=null,x.value=!1},je=n=>{const v=/\(([^)]+)\)/,T=n.match(v);return T?T[1]:""},pt=n=>{const v=/.*\(([^)]+)\)/,T=n.match(v);return T?T[0]:""},te=()=>{if(r.value.length===1&&!x.value){const n=document.getElementById("video-player");n&&n.play().catch(v=>console.error("Error auto-playing video:",v))}},Ee=()=>{x.value=!x.value,x.value||ge()},B=n=>{const v=r.value.findIndex(T=>T.fileName===n.fileName);v!==-1?r.value.length>1&&r.value.splice(v,1):(r.value.push(n),x.value=!0)},Z=()=>{ce.value=!1,pe.value=0,H.value=[{fileName:"",progress:0,message:""}],ie.value=!1},Ue=async()=>{try{await f.processVideoChunksAndTelemetry(r.value.map(n=>n.hash)),x.value=!1,await Ye()}catch(n){const v=`Video processing failed: ${n.message??n.toString()}`;console.error(v),I.value=v,U.value=!0,ce.value=!0}},Le=()=>{ce.value&&Ye(),y.value=!1,Z()},Ae=async()=>{r.value.length===1&&!r.value[0].isProcessed&&(ie.value=!0),Ue()},Fe=()=>{Ve.value=r.value.length,q.value="Processing Videos",G.value=[{text:pe.value===100?"Close":"Hide",size:"small",class:"font-light",action:Le}],ee.value=!1,y.value=!0,Ue()},Be=()=>{me.value="Process Multiple Videos",S.value=[{text:"Cancel",size:"small",class:"font-light",action:()=>{ee.value=!1}},{text:"Process videos",size:"small",class:"font-bold",action:async()=>{ee.value=!1,Fe()}}],ee.value=!0},ue=()=>{r.value=[...h.value],x.value=!0},ge=()=>{x.value=!1,ae.value=!1,z.value=!1,r.value.length>1&&(r.value=[r.value[0]])},it=()=>{h.value.some(n=>!n.isProcessed)?(r.value=h.value.filter(n=>!n.isProcessed),x.value=!0):(I.value="No unprocessed videos found",U.value=!0)},ot=()=>{h.value.some(n=>n.isProcessed)?(r.value=h.value.filter(n=>n.isProcessed),x.value=!0):(I.value="No processed videos found",U.value=!0)},ze=n=>n.flatMap(T=>{const M=`${T.split(".").slice(0,-1).join(".")}.ass`;return D.value.some(O=>O.fileName===M)?[T,M]:[T]}),le=async()=>{let n=!1;const v=async(M,o)=>{const O=(100*M/o).toFixed(1);n&&(I.value=`Preparing download: ${O}%.`,U.value=!0)};I.value="Getting your download ready...",setTimeout(()=>n=!0,1500);let T=[],A=[];if(r.value.forEach(M=>{M.isProcessed&&T.push(M.fileName),!M.isProcessed&&M.hash&&A.push(M.hash)}),U.value=!0,!(A.length>0&&!await gt())){if(re.value=!0,T.length>0){const M=ze(T);await f.downloadFilesFromVideoDB(M,v)}A.length>0&&await f.downloadTempVideo(A,v),re.value=!1}},gt=async()=>{let n=!1;return await E({maxWidth:600,title:"You are downloading unprocessed videos",message:`One or more videos that you are downloading contains unprocessed chunks, which are not playable. To be
      able to play the downloaded videos, you need to go back and process those videos first.`,variant:"info",actions:[{text:"Go back",action:()=>{n=!1}},{text:"Download anyway",action:()=>{n=!0}}]}),j(),n},yt=async()=>{Ge.value=!0;let n=r.value.length,v=[],T=[];if(await r.value.forEach(A=>{A.isProcessed&&v.push(A.fileName),!A.isProcessed&&A.hash&&T.push(A.hash)}),v.length>0){const A=ze(v);await f.discardProcessedFilesFromVideoDB(A)}T.length>0&&await f.discardUnprocessedFilesFromVideoDB(T),I.value=`${n} video(s) discarded.`,U.value=!0,await Ye(),r.value=h.value.length>0?[h.value[0]]:[],h.value.length===1&&(x.value=!1),Ge.value=!1},Ye=async()=>{$.value=!0,h.value=[];const n=[],v=[];await f.videoStoringDB.iterate((ye,de)=>{f.isVideoFilename(de)&&n.push((async()=>{const Pe=await f.videoStoringDB.getItem(de);let Se="",Je=!0;Pe instanceof Blob?(Se=URL.createObjectURL(Pe),Y.value.push(Se)):console.error("Video data is not a Blob:",Pe);const Xe=await f.videoStorageFileSize(de)??0;return{fileName:de,size:Xe,url:Se,isProcessed:Je}})()),de.endsWith(".ass")&&v.push((async()=>{const Pe=await f.videoStoringDB.getItem(de);let Se="";Pe instanceof Blob?(Se=URL.createObjectURL(Pe),Y.value.push(Se)):console.error("Video data is not a Blob:",Pe);const Je=await f.videoStorageFileSize(de)??0;return{fileName:de,url:Se,size:Je}})())});const T=await f.unprocessedVideos,A=Object.entries(T).map(async([ye,de])=>({...de,hash:ye,url:"",isProcessed:!1})),M=await Promise.all(n),o=await Promise.all(v),J=(await Promise.all(A)).filter(ye=>ye.dateFinish||f.keysFailedUnprocessedVideos.includes(ye.hash));h.value=[...M,...J],D.value=o,$.value=!1};return Q(()=>f.currentFileProgress,n=>{H.value=n},{deep:!0}),Q(()=>f.overallProgress,n=>{pe.value=n,n>0&&n<100&&(Me.value=!0,ie.value=!0),n===100&&(Me.value=!1,ie.value=!1,setTimeout(()=>{y.value=!1},1e3))}),Q(N,n=>{g("update:openModal",n),n||(Z(),x.value=!1,we.value=null,ie.value=!1)}),Q(()=>R.openModal,async n=>{N.value=n,n===!0&&(await Ye(),ie.value=!1)}),Q(r,n=>{if(n.length===1){ce.value&&Z(),we.value=n[0];const v=n[0].url,T=X.value;T&&(T.src=v,T.load())}},{immediate:!0,deep:!0}),Q(h,()=>{if(we.value){const n=h.value.find(v=>je(v.fileName)===je(we.value.fileName));n&&(r.value=[n])}else r.value=h.value.length>0?[h.value[0]]:[]},{deep:!0}),Q(N,()=>{N.value||(we.value=null)}),Q(h,async()=>{await is(),h.value.forEach(n=>{var T;const v=document.getElementById(`video-library-${n.fileName}`);if(v){(T=he.value[n.fileName])==null||T.destroy();const A=new It.Manager(v);A.add(new It.Tap),A.add(new It.Press({time:500})),A.on("tap",M=>{const o=r.value.some(J=>J.fileName===n.fileName);if(x.value||M.srcEvent.ctrlKey||M.srcEvent.metaKey){x.value=!0;const J=r.value.findIndex(ye=>ye.fileName===n.fileName);J>-1?r.value.length>1&&r.value.splice(J,1):r.value.push(n)}else o||(r.value=[n]);if(r.value.length===1&&o){const J=document.getElementById("video-player");J&&(J.load(),J.play().catch(ye=>console.error("Error auto-playing video:",ye)))}}),A.on("press",()=>{x.value=!0,r.value.some(M=>M.fileName===n.fileName)||r.value.push(n)}),he.value[n.fileName]=A}})},{immediate:!0,deep:!0}),Vt(async()=>{$.value=!0,await Ye()}),ns(()=>{V.value="videos",Y.value.forEach(n=>URL.revokeObjectURL(n)),Y.value=[],Object.values(he.value).forEach(n=>{n.destroy()})}),(n,v)=>(_(),C(De,null,[d(ls,{modelValue:N.value,"onUpdate:modelValue":v[8]||(v[8]=T=>N.value=T),class:"dialog"},{default:m(()=>{var T,A,M;return[u("div",Sa,[u("div",Ca,[u("div",Na,[u("div",Ia,[(_(),C(De,null,ft(Re,o=>u("button",{key:o.name,disabled:o.disabled,class:"flex flex-col justify-center align-center",onClick:O=>V.value=o.name.toLowerCase()},[o.tooltip!==""?(_(),ke(be,{key:0,"open-delay":"600",activator:"parent",location:"top"},{default:m(()=>[w(k(o.tooltip),1)]),_:2},1024)):L("",!0),u("div",{class:ve(["mb-1 text-2xl rounded-full",[o.disabled?"frosted-button-disabled":"frosted-button",V.value===o.name.toLowerCase()?"w-[58px] h-[58px]":"w-[40px] h-[40px]"]])},[d(W,{size:V.value===o.name.toLowerCase()?40:24,class:ve({"ml-1":o.name.toLowerCase()==="videos"})},{default:m(()=>[w(k(o.icon),1)]),_:2},1032,["size","class"])],2),u("div",{class:ve(["text-sm",{"text-white/30":!o.disabled}])},k(o.name),3)],8,ka)),64))]),u("div",null,[u("div",Va,[u("button",{class:"frosted-button text-[#ffffffaa] flex flex-col justify-center align-center w-[28px] h-[28px] rounded-full mb-[4px]",onClick:v[2]||(v[2]=o=>ne.value=!ne.value)},[d(W,{class:"text-[24px]"},{default:m(()=>[w("mdi-help-circle-outline")]),_:1}),d(be,{modelValue:ne.value,"onUpdate:modelValue":v[0]||(v[0]=o=>ne.value=o),"open-on-hover":!1,activator:"parent",location:"top",arrow:"","content-class":"border-[#ffffff55] border-2","onClick:outside":v[1]||(v[1]=o=>ne.value=!1)},{default:m(()=>[u("div",Aa,[Oa,Da,u("div",Ma,[u("div",Ra,[d(W,{size:"10",class:"text-green-500 ml-2 mb-[2px] mr-1"},{default:m(()=>[w("mdi-circle")]),_:1}),w(" Processed video ")]),u("div",null,[d(W,{size:"10",class:"text-red-500 mb-[2px] mr-1"},{default:m(()=>[w("mdi-circle")]),_:1}),w(" Unprocessed video ")])])])]),_:1},8,["modelValue"])])]),d(tt,{class:"opacity-[0.1] ml-[-5px] w-[120%]"}),u("button",{class:"flex flex-col justify-center py-2 mt-4 align-center",onClick:Ze},[u("div",Ua,[d(W,{class:"text-[18px]"},{default:m(()=>[w("mdi-close")]),_:1})]),La])])]),d(tt,{vertical:"",class:"h-[92%] mt-4 opacity-[0.1]"}),V.value==="videos"?(_(),C(De,{key:0},[h.value.length>0?(_(),C("div",Fa,[u("div",Ba,[(_(!0),C(De,null,ft(h.value,o=>(_(),C("div",{key:o.fileName,class:"mb-4 video-container"},[u("div",za,[u("video",{id:`video-library-${o.fileName}`,class:ve(["border-4 border-white rounded-md cursor-pointer border-opacity-[0.1] hover:border-opacity-[0.4] transition duration-75 hover:ease-in",r.value.find(O=>O.fileName===o.fileName)?["border-opacity-[0.4]","w-[220px]"]:["border-opacity-[0.1]","w-[190px]"]]),preload:"auto",poster:o.isProcessed?void 0:o.thumbnail},[u("source",{src:o.url},null,8,Ha)],10,Ya),r.value.find(O=>O.fileName===o.fileName)&&!x.value?(_(),C("div",{key:0,class:"play-button",onClick:O=>o.isProcessed?te():Ae()},[d(W,{size:"40",class:"text-white"},{default:m(()=>[w(k(o.isProcessed?"mdi-play-circle-outline":"mdi-progress-alert"),1)]),_:2},1024)],8,Wa)):L("",!0),x.value?(_(),C("div",{key:1,class:ve(["checkmark-button",r.value.find(O=>O.fileName===o.fileName)?"bg-green":"bg-white"]),onClick:js(O=>B(o),["stop"])},[d(W,{size:"15",class:"text-white"},{default:m(()=>[w(k(r.value.find(O=>O.fileName===o.fileName)?"mdi-check-circle-outline":"mdi-radiobox-blank"),1)]),_:2},1024)],10,ja)):L("",!0)]),u("div",Xa,[d(be,{"open-delay":"500",activator:"parent",location:"top"},{default:m(()=>[w(k(o.isProcessed?"Processed video":"Unprocessed video"),1)]),_:2},1024),w(" "+k(je(o.fileName)??"Cockpit video")+" ",1),d(W,{size:"10",class:ve(["ml-1 mt-[3px]",o.isProcessed?"text-green-500":"text-red-500"])},{default:m(()=>[w(" mdi-circle ")]),_:2},1032,["class"])])]))),128))]),h.value.length>1?(_(),C("div",$a,[u("div",null,[d(We,{variant:"text",size:"small",class:"mt-[5px]",onClick:Ee},{default:m(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:m(()=>[w(" Select "+k(x.value?"single":"multiple")+" files ",1)]),_:1}),w(" "+k(x.value?"Single":"Multi"),1)]),_:1})]),u("div",null,[d(We,{variant:"text",size:"small",class:"mt-[5px]",onClick:v[3]||(v[3]=o=>r.value.length===h.value.length?ge():ue())},{default:m(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:m(()=>[w(" Select "+k(r.value.length===h.value.length?"none":"all files"),1)]),_:1}),w(" "+k(r.value.length===h.value.length?"None":"All"),1)]),_:1})]),u("div",null,[d(We,{variant:"text",size:"small",class:"mt-[5px]",onClick:v[4]||(v[4]=o=>r.value.every(O=>!O.isProcessed)?ot():it())},{default:m(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:m(()=>[w(k(r.value.every(o=>!o.isProcessed)?"Select all processed videos":"Select all unprocessed videos"),1)]),_:1}),w(" "+k(r.value.every(o=>!o.isProcessed)?"Select Process.":"select Unproc."),1)]),_:1})])])):L("",!0)])):L("",!0),d(tt,{vertical:"",class:"h-[92%] mt-4 opacity-[0.1]"}),h.value.length>0?(_(),C("div",qa,[u("div",null,[!x.value&&r.value.length===1&&!x.value&&!$.value?(_(),C("video",{key:0,id:"video-player",ref_key:"videoPlayerRef",ref:X,width:"660px",controls:!!r.value[0].isProcessed,preload:r.value[0].isProcessed?"auto":"none",poster:((T=r.value[0])==null?void 0:T.thumbnail)||void 0,class:"border-[14px] border-white border-opacity-10 rounded-lg min-h-[382px] aspect-video"},[u("source",{src:((A=r.value[0])==null?void 0:A.url)||void 0},null,8,Za)],8,Ga)):L("",!0),!$.value&&r.value.length===1&&!r.value[0].isProcessed&&!x.value&&!ce.value?(_(),ke(We,{key:1,variant:ie.value?"text":"outlined",color:"white",size:"large",disabled:ie.value,class:"process-button",onClick:Ae},{default:m(()=>[w(k(ie.value?"Processing...":"Process video"),1)]),_:1},8,["variant","disabled"])):L("",!0),u("div",Ja,[ie.value&&!y.value?(_(),ke(vt,{key:0,"model-value":ce.value?100:pe.value,color:ce.value?"red":"green",height:"8",striped:""},null,8,["model-value","color"])):L("",!0),u("div",Ka,[!$.value&&r.value.length===1&&ie.value&&ce.value?(_(),C("button",{key:0,class:"bg-red text-[#ffffffaa] flex flex-col justify-center align-center w-[20px] h-[20px] rounded-full mt-[40px] ml-[-25px]",onClick:v[7]||(v[7]=o=>F.value=!F.value)},[d(W,{class:"text-[18px]"},{default:m(()=>[w("mdi-alert-circle-outline")]),_:1}),d(be,{modelValue:F.value,"onUpdate:modelValue":v[5]||(v[5]=o=>F.value=o),"open-on-hover":!1,activator:"parent",location:"bottom",arrow:"","content-class":"border-[#ffffff55] border-2","onClick:outside":v[6]||(v[6]=o=>F.value=!1)},{default:m(()=>[u("div",Qa,[u("div",null,k(I.value),1)])]),_:1},8,["modelValue"])])):L("",!0)])])]),h.value.length>0&&r.value.length>=1&&x.value?(_(),C("div",ei,[u("div",ti,[(_(!0),C(De,null,ft(r.value,o=>(_(),ke(Xs,{key:o.fileName,class:"video-card"},{default:m(()=>[u("div",null,[d($s,null,{default:m(()=>[u("div",si,k(je(o.fileName)),1)]),_:2},1024),u("div",ai,[d(W,{size:"10",class:ve(o.isProcessed?"text-green-500":"text-red-500")},{default:m(()=>[w(" mdi-circle ")]),_:2},1032,["class"])])])]),_:2},1024))),128))]),d(tt,{class:"mb-[-10px] opacity-[0.1] mx-3"})])):L("",!0),h.value.length>0?(_(),C("div",ii,[u("div",oi,[u("div",ni,k(x.value?`Files selected: ${r.value.length}`:pt((M=r.value[0])==null?void 0:M.fileName)),1),x.value?(_(),C("div",li,[r.value.every(o=>!o.isProcessed)?(_(),C("div",ri,[u("button",{onClick:Be},"Process selected videos")])):L("",!0)])):L("",!0)]),u("div",ci,[(_(!0),C(De,null,ft(mt.value,o=>(_(),C("button",{key:o.name,class:"flex flex-col justify-center ml-6 align-center",disabled:o.disabled,onClick:O=>!o.confirmAction&&o.action()},[u("div",{class:ve([[o.disabled?"frosted-button-disabled":"frosted-button",!o.confirmAction&&"p-2"],"flex flex-col justify-center mb-1 rounded-full frosted-button align-center button"])},[o.tooltip?(_(),ke(be,{key:0,"open-delay":"500",activator:"parent",location:"bottom"},{default:m(()=>[w(k(o.tooltip),1)]),_:2},1024)):L("",!0),o.confirmAction?(_(),ke(qs,{key:1,location:"left center",opacity:"0",transition:"slide-x-reverse-transition",disabled:o.disabled},{activator:m(({props:O,isActive:J})=>[u("div",st({class:"flex items-center justify-center w-full h-full"},O),[d(W,{size:o.size,class:ve([{"rotate-[-45deg]":J,"outline outline-6 outline-[#ffffff55]":J},"rounded-full border-[transparent]"]),style:Gs({borderWidth:`${o.size-4}px`})},{default:m(()=>[w(k(J?"mdi-arrow-up":o.icon),1)]),_:2},1032,["size","class","style"])],16)]),default:m(()=>[d(Zs,{class:"bg-transparent",elevation:"0"},{default:m(()=>[d(Js,null,{append:m(()=>[u("div",di,[d(We,{fab:"",small:"",width:"28",height:"28",color:"red",icon:"mdi-close",class:"text-sm outline outline-3 outline-[#ffffff44] hover:outline-[#ffffff77]"},{default:m(()=>[d(be,{"open-delay":"600",activator:"parent",location:"bottom"},{default:m(()=>[w(" Cancel ")]),_:1}),d(W,null,{default:m(()=>[w("mdi-close")]),_:1})]),_:1}),d(We,{fab:"",small:"",width:"28",height:"28",color:"green",icon:"mdi-check",class:"ml-4 text-sm outline outline-3 outline-[#ffffff44] hover:outline-[#ffffff77]",loading:Ge.value,onClick:O=>o.action()},{default:m(()=>[d(be,{"open-delay":"600",activator:"parent",location:"bottom"},{default:m(()=>[w(" Confirm ")]),_:1}),d(W,null,{default:m(()=>[w("mdi-check")]),_:1})]),_:2},1032,["loading","onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disabled"])):(_(),C("div",fi,[d(W,{size:o.size},{default:m(()=>[w(k(o.icon),1)]),_:2},1032,["size"])]))],2)],8,ui))),128))])])):L("",!0)])):L("",!0),h.value.length===0?(_(),C("div",vi,k($.value?"Loading":"No videos on storage"),1)):L("",!0)],64)):L("",!0)])])]}),_:1},8,["modelValue"]),d(Pa,{"open-snackbar":U.value,message:I.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":v[9]||(v[9]=T=>U.value=T)},null,8,["open-snackbar","message"]),d($t,{"show-dialog":ee.value,title:me.value,actions:S.value,"max-width":600},{content:m(()=>[hi]),_:1},8,["show-dialog","title","actions"]),d($t,{"show-dialog":y.value,title:q.value,actions:G.value,"max-width":600},{content:m(()=>[ce.value?L("",!0):(_(),C("div",mi,[u("div",pi,[H.value.length>0?(_(),C("div",gi,[u("div",yi," File "+k(H.value.length)+" of "+k(Ve.value)+": "+k(H.value[H.value.length-1].message),1),u("div",_i,[u("div",Ti,k(H.value[H.value.length-1].fileName),1),u("div",xi,[d(Ks,{width:"1",size:"10",indeterminate:"",class:"mr-1 mb-[2px]"}),w(" "+k(`${H.value[H.value.length-1].progress}%`),1)])]),d(vt,{"model-value":H.value[H.value.length-1].progress,color:"white",height:"6",rounded:"",striped:""},null,8,["model-value"])])):L("",!0),u("div",null,[u("div",bi,[wi,u("div",Ei,k(`${Math.ceil(pe.value)}%`),1)]),d(vt,{"model-value":Math.ceil(pe.value),color:"blue",height:"6",rounded:"",striped:""},null,8,["model-value"])])])])),ce.value?(_(),C("div",Pi,[u("div",Si,k(`Error processing video file: ${H.value[H.value.length-1].fileName}`),1)])):L("",!0)]),_:1},8,["show-dialog","title","actions"])],64))}}),Ni=us(Ci,[["__scopeId","data-v-9eaca5cf"]]),Ii=Gt({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:Qs,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...ea(),...Zt({location:"top end"}),...Jt(),...ta(),...Kt(),...sa({transition:"scale-rotate-transition"})},"VBadge"),ki=Qt()({name:"VBadge",inheritAttrs:!1,props:Ii(),setup(l,P){const{backgroundColorClasses:f,backgroundColorStyles:R}=aa(qt(l,"color")),{roundedClasses:g}=ts(l),{t:E}=ia(),{textColorClasses:j,textColorStyles:Y}=oa(qt(l,"textColor")),{themeClasses:h}=na(),{locationStyles:D}=es(l,!0,N=>(l.floating?l.dot?2:4:l.dot?8:12)+(["top","bottom"].includes(N)?+(l.offsetY??0):["left","right"].includes(N)?+(l.offsetX??0):0));return as(()=>{const N=Number(l.content),r=!l.max||isNaN(N)?l.content:N<=+l.max?N:`${l.max}+`,[X,V]=la(P.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return d(l.tag,st({class:["v-badge",{"v-badge--bordered":l.bordered,"v-badge--dot":l.dot,"v-badge--floating":l.floating,"v-badge--inline":l.inline},l.class]},V,{style:l.style}),{default:()=>{var U,I;return[d("div",{class:"v-badge__wrapper"},[(I=(U=P.slots).default)==null?void 0:I.call(U),d(ra,{transition:l.transition},{default:()=>{var x,ae;return[ca(d("span",st({class:["v-badge__badge",h.value,f.value,g.value,j.value],style:[R.value,Y.value,l.inline?{}:D.value],"aria-atomic":"true","aria-label":E(l.label,N),"aria-live":"polite",role:"status"},X),[l.dot?void 0:P.slots.badge?(ae=(x=P.slots).badge)==null?void 0:ae.call(x):l.icon?d(W,{icon:l.icon},null):r]),[[ua,l.modelValue]])]}})])]}})}),{}}}),ht=l=>(rs("data-v-48d333f6"),l=l(),cs(),l),Vi={key:1},Ai={class:"text-xs text-white select-none scroll-text"},Oi={key:3,class:"w-16 text-justify text-slate-100"},Di={key:4,class:"w-16 text-justify text-slate-100"},Mi=ht(()=>u("div",{class:"text-xs text-center text-white select-none flex-nowrap"},"Processing video...",-1)),Ri=[Mi],Ui={key:5,class:"flex justify-center w-8"},Li={class:"p-6 m-5 bg-white rounded-md"},Fi=ht(()=>u("p",{class:"text-xl font-semibold"},"Choose a stream to record",-1)),Bi=ht(()=>u("div",{class:"w-auto h-px my-2 bg-grey-lighten-3"},null,-1)),zi={class:"flex items-center"},Yi=ht(()=>u("span",null,"Record",-1)),Hi={key:1,class:"w-5 h-5 ml-2 rounded-full bg-red"},Wi=At({__name:"MiniVideoRecorder",props:{miniWidget:{}},setup(l){const P=da(),f=os(),g=fa(l).miniWidget,E=p(),{namesAvailableStreams:j}=va(f),Y=p(),{isOutside:h}=ha(Y),D=p(!1),N=p(!1),r=p(!1),X=ma({interval:100}),V=p(),U=p(!1),I=p(0);Vt(async()=>{await ae()}),pa(async()=>{Object.keys(g.value.options).length===0&&(g.value.options={streamName:void 0}),E.value=g.value.options.streamName}),Q(E,()=>{g.value.options.streamName=E.value,V.value=void 0});const x=S=>{N.value=S},ae=async()=>{const S=(await f.videoStoringDB.keys()).filter(q=>f.isVideoFilename(q)).length,y=Object.keys(f.keysFailedUnprocessedVideos).length;I.value=S+y};function z(S){if(E.value=S,E.value===void 0){qe.fire({text:"No stream selected.",icon:"error"});return}if(j.value.includes(E.value))return;const y="The selected stream is not available. Please check its source or select another stream.";throw qe.fire({text:y,icon:"error"}),new Error(y)}const he=async()=>{if(F.value){E.value!==void 0&&f.stopRecording(E.value);return}if(E.value===void 0){D.value=!0;return}ne()},ne=()=>{var S;if(E.value&&!((S=f.getStreamData(E.value))!=null&&S.connected)){qe.fire({title:"Cannot start recording.",text:"Stream is not connected.",icon:"error"});return}z(E.value),f.startRecording(E.value),D.value=!1},F=kt(()=>E.value===void 0?!1:f.isRecording(E.value)),$=kt(()=>{var re,pe,H,Ve;if(E.value===void 0)return"00:00:00";const S=(re=f.getStreamData(E.value))==null?void 0:re.timeRecordingStart;if(S===void 0)return"00:00:00";const y=ga({start:S,end:X.value}),q=((pe=y.hours)==null?void 0:pe.toFixed(0).length)===1?`0${y.hours}`:y.hours,G=((H=y.minutes)==null?void 0:H.toFixed(0).length)===1?`0${y.minutes}`:y.minutes,Me=((Ve=y.seconds)==null?void 0:Ve.toFixed(0).length)===1?`0${y.seconds}`:y.seconds;return`${q}:${G}:${Me}`}),ee=async S=>{z(S),V.value=void 0,r.value=!0;let y=0;const q=100,G=3e3;for(;r.value&&y<G;)r.value=V.value===void 0||!V.value.active,await xa(q),y+=q;if(r.value){qe.fire({text:"Could not load media stream.",icon:"error"});return}g.value.options.streamName=S};let me;return P.isRealMiniWidget(g.value)&&(me=setInterval(()=>{g.value.options.streamName===void 0&&!j.value.isEmpty()&&(g.value.options.streamName=j.value[0],E.value=g.value.options.streamName,j.value.length>1&&qe.fire({title:"Multiple streams detected",text:`You have multiple streams available, so we chose one randomly to start with.
          If you want to change it, please open the widget configuration.`,icon:"info",confirmButtonText:"OK"}));const S=f.getMediaStream(g.value.options.streamName);ya(S,V.value)||(V.value=S)},1e3)),ns(()=>clearInterval(me)),Q(()=>f.areThereVideosProcessing,S=>{U.value=S,ae()}),Q(()=>f.keysFailedUnprocessedVideos,()=>ae()),Q(()=>N.value,async S=>{S===!1&&await ae()}),Q(F,()=>{if(!F.value){window.onbeforeunload=null;return}window.onbeforeunload=()=>(qe.fire({text:`
      You have a video recording ongoing.
      Remember to stop it before closing Cockpit, or the record will be lost.
    `,icon:"warning"}),"I hope the user does not click on the leave button.")}),(S,y)=>{const q=_a("FontAwesomeIcon");return _(),C(De,null,[u("div",{ref_key:"recorderWidget",ref:Y,class:ve(["flex justify-around px-2 py-1 text-center rounded-lg h-9 align-center bg-slate-800/60",{"w-48":I.value>0,"w-32":I.value<=0}])},[U.value?(_(),C("div",Vi,[d(W,{class:"w-6 h-6 animate-spin",color:"white"},{default:m(()=>[w("mdi-loading")]),_:1})])):(_(),C("div",{key:0,class:ve([{"blob red w-5 opacity-100 rounded-sm":F.value,"opacity-30 bg-red-400":Nt(h)&&!F.value},"w-6 transition-all duration-500 rounded-full aspect-square bg-red-lighten-1 hover:cursor-pointer opacity-70 hover:opacity-90"]),onClick:y[0]||(y[0]=G=>he())},null,2)),!F.value&&!U.value?(_(),C(De,{key:2},[E.value?(_(),C("div",{key:0,class:"flex flex-col max-w-[50%] scroll-container transition-all border-blur cursor-pointer",onClick:y[1]||(y[1]=G=>D.value=!0)},[u("div",Ai,k(E.value),1)])):(_(),ke(q,{key:1,icon:"fa-solid fa-video",class:"h-6 text-slate-100"}))],64)):L("",!0),F.value&&!U.value?(_(),C("div",Oi,k($.value),1)):U.value?(_(),C("div",Di,Ri)):L("",!0),I.value>0?(_(),C("div",Ui,[d(tt,{vertical:"",class:"h-6"}),d(ki,{color:"info",content:I.value,dot:Nt(h)||N.value,class:"cursor-pointer",onClick:y[3]||(y[3]=G=>N.value=!0)},{default:m(()=>[d(W,{class:"w-6 h-6 ml-3 text-slate-100",onClick:y[2]||(y[2]=G=>N.value=!0)},{default:m(()=>[w(" mdi-video-box ")]),_:1})]),_:1},8,["content","dot"])])):L("",!0)],2),d(ls,{modelValue:D.value,"onUpdate:modelValue":y[5]||(y[5]=G=>D.value=G),width:"auto"},{default:m(()=>[u("div",Li,[Fi,Bi,d(Ta,{"model-value":E.value,label:"Stream name",items:Nt(j),"item-title":"name",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":"","onUpdate:modelValue":ee},null,8,["model-value","items"]),u("div",zi,[u("button",{class:"w-auto p-3 m-2 font-medium transition-all rounded-md shadow-md text-uppercase hover:bg-slate-100",onClick:y[4]||(y[4]=G=>D.value=!1)}," Cancel "),u("button",{class:ve(["flex items-center p-3 mx-2 font-medium transition-all rounded-md shadow-md w-fit text-uppercase hover:bg-slate-100",{"bg-slate-200 opacity-30 pointer-events-none":r.value}]),onClick:ne},[Yi,r.value?(_(),ke(W,{key:0,class:"m-2 animate-spin"},{default:m(()=>[w("mdi-loading")]),_:1})):(_(),C("div",Hi))],2)])])]),_:1},8,["modelValue"]),d(Ni,{"open-modal":N.value,"onUpdate:openModal":x},null,8,["open-modal"])],64)}}}),Xi=us(Wi,[["__scopeId","data-v-48d333f6"]]);export{Xi as default};
