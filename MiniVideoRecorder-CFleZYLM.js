import{z as Kt,A as Qt,B as ks,C as es,F as Vs,G as ts,H as Os,I as As,J as ss,K as Ds,L as as,M as Ms,N as Rs,O as Us,P as Ls,Q as is,q as _,R as os,v as $,x as Dt,S as Fs,T as ns,V as qt,i as d,U as Bs,W as mt,X as zs,Y as st,Z as Ws,_ as Ys,$ as ls,d as Mt,o as T,j as Ve,a0 as Hs,a1 as p,a2 as He,a3 as W,a4 as E,t as N,a5 as rs,a6 as js,a7 as $s,a8 as Xs,l as pt,a9 as cs,c as C,a as u,aa as Gt,ab as Le,ac as ht,ad as be,k as L,n as me,ae as tt,af as qs,ag as Gs,ah as Zs,ai as Js,aj as Ks,ak as Qs,al as us,am as Zt,an as ea,ao as ds,ap as fs,aq as vs,ar as ta,as as sa,at as aa,au as ia,av as oa,aw as Jt,ax as na,ay as la,az as ra,aA as ca,aB as ua,w as da,aC as fa,aD as va,aE as ha,aF as ma,aG as pa,aH as ga,aI as ya,aJ as _a,aK as Xe,aL as Ta,r as xa,b as Ye,aM as ba,aN as wa}from"./index-BFtXDR0v.js";var hs={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(r){(function(S,f,R,m){var P=["","webkit","Moz","MS","ms","o"],Y=f.createElement("div"),oe="function",D=Math.round,I=Math.abs,h=Date.now;function re(e,t,s){return setTimeout(ye(e,s),t)}function V(e,t,s){return Array.isArray(e)?(n(e,s[t],s),!0):!1}function n(e,t,s){var a;if(e)if(e.forEach)e.forEach(t,s);else if(e.length!==m)for(a=0;a<e.length;)t.call(s,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(s,e[a],a,e)}function X(e,t,s){var a="DEPRECATED METHOD: "+t+`
`+s+` AT 
`;return function(){var i=new Error("get-stack-trace"),c=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",w=S.console&&(S.console.warn||S.console.log);return w&&w.call(S.console,a,c),e.apply(this,arguments)}}var A;typeof Object.assign!="function"?A=function(t){if(t===m||t===null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(t),a=1;a<arguments.length;a++){var i=arguments[a];if(i!==m&&i!==null)for(var c in i)i.hasOwnProperty(c)&&(s[c]=i[c])}return s}:A=Object.assign;var U=X(function(t,s,a){for(var i=Object.keys(s),c=0;c<i.length;)(!a||a&&t[i[c]]===m)&&(t[i[c]]=s[i[c]]),c++;return t},"extend","Use `assign`."),B=X(function(t,s){return U(t,s,!0)},"merge","Use `assign`.");function y(e,t,s){var a=t.prototype,i;i=e.prototype=Object.create(a),i.constructor=e,i._super=a,s&&A(i,s)}function ye(e,t){return function(){return e.apply(t,arguments)}}function se(e,t){return typeof e==oe?e.apply(t&&t[0]||m,t):e}function ne(e,t){return e===m?t:e}function Z(e,t,s){n(J(t),function(a){e.addEventListener(a,s,!1)})}function H(e,t,s){n(J(t),function(a){e.removeEventListener(a,s,!1)})}function b(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function g(e,t){return e.indexOf(t)>-1}function J(e){return e.trim().split(/\s+/g)}function z(e,t,s){if(e.indexOf&&!s)return e.indexOf(t);for(var a=0;a<e.length;){if(s&&e[a][s]==t||!s&&e[a]===t)return a;a++}return-1}function ue(e){return Array.prototype.slice.call(e,0)}function Oe(e,t,s){for(var a=[],i=[],c=0;c<e.length;){var w=t?e[c][t]:e[c];z(i,w)<0&&a.push(e[c]),i[c]=w,c++}return s&&(t?a=a.sort(function(G,ie){return G[t]>ie[t]}):a=a.sort()),a}function _e(e,t){for(var s,a,i=t[0].toUpperCase()+t.slice(1),c=0;c<P.length;){if(s=P[c],a=s?s+i:t,a in e)return a;c++}return m}var Fe=1;function we(){return Fe++}function Ee(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||S}var K=/mobile|tablet|ip(ad|hone|od)|android/i,qe="ontouchstart"in S,ae=_e(S,"PointerEvent")!==m,Ae=qe&&K.test(navigator.userAgent),Q="touch",Ge="pen",Ze="mouse",yt="kinect",_t=25,q=1,de=2,F=4,ee=8,je=1,Be=2,Pe=4,De=8,ze=16,ce=Be|Pe,Se=De|ze,it=ce|Se,ot=["x","y"],Me=["clientX","clientY"];function le(e,t){var s=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(a){se(e.options.enable,[e])&&s.handler(a)},this.init()}le.prototype={handler:function(){},init:function(){this.evEl&&Z(this.element,this.evEl,this.domHandler),this.evTarget&&Z(this.target,this.evTarget,this.domHandler),this.evWin&&Z(Ee(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(Ee(this.element),this.evWin,this.domHandler)}};function Tt(e){var t,s=e.options.inputClass;return s?t=s:ae?t=Et:Ae?t=rt:qe?t=Pt:t=ve,new t(e,nt)}function nt(e,t,s){var a=s.pointers.length,i=s.changedPointers.length,c=t&q&&a-i===0,w=t&(F|ee)&&a-i===0;s.isFirst=!!c,s.isFinal=!!w,c&&(e.session={}),s.eventType=t,xt(e,s),e.emit("hammer.input",s),e.recognize(s),e.session.prevInput=s}function xt(e,t){var s=e.session,a=t.pointers,i=a.length;s.firstInput||(s.firstInput=Re(t)),i>1&&!s.firstMultiple?s.firstMultiple=Re(t):i===1&&(s.firstMultiple=!1);var c=s.firstInput,w=s.firstMultiple,j=w?w.center:c.center,G=t.center=o(a);t.timeStamp=h(),t.deltaTime=t.timeStamp-c.timeStamp,t.angle=O(j,G),t.distance=k(j,G),bt(s,t),t.offsetDirection=x(t.deltaX,t.deltaY);var ie=v(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=ie.x,t.overallVelocityY=ie.y,t.overallVelocity=I(ie.x)>I(ie.y)?ie.x:ie.y,t.scale=w?M(w.pointers,a):1,t.rotation=w?l(w.pointers,a):0,t.maxPointers=s.prevInput?t.pointers.length>s.prevInput.maxPointers?t.pointers.length:s.prevInput.maxPointers:t.pointers.length,wt(s,t);var xe=e.element;b(t.srcEvent.target,xe)&&(xe=t.srcEvent.target),t.target=xe}function bt(e,t){var s=t.center,a=e.offsetDelta||{},i=e.prevDelta||{},c=e.prevInput||{};(t.eventType===q||c.eventType===F)&&(i=e.prevDelta={x:c.deltaX||0,y:c.deltaY||0},a=e.offsetDelta={x:s.x,y:s.y}),t.deltaX=i.x+(s.x-a.x),t.deltaY=i.y+(s.y-a.y)}function wt(e,t){var s=e.lastInterval||t,a=t.timeStamp-s.timeStamp,i,c,w,j;if(t.eventType!=ee&&(a>_t||s.velocity===m)){var G=t.deltaX-s.deltaX,ie=t.deltaY-s.deltaY,xe=v(a,G,ie);c=xe.x,w=xe.y,i=I(xe.x)>I(xe.y)?xe.x:xe.y,j=x(G,ie),e.lastInterval=t}else i=s.velocity,c=s.velocityX,w=s.velocityY,j=s.direction;t.velocity=i,t.velocityX=c,t.velocityY=w,t.direction=j}function Re(e){for(var t=[],s=0;s<e.pointers.length;)t[s]={clientX:D(e.pointers[s].clientX),clientY:D(e.pointers[s].clientY)},s++;return{timeStamp:h(),pointers:t,center:o(t),deltaX:e.deltaX,deltaY:e.deltaY}}function o(e){var t=e.length;if(t===1)return{x:D(e[0].clientX),y:D(e[0].clientY)};for(var s=0,a=0,i=0;i<t;)s+=e[i].clientX,a+=e[i].clientY,i++;return{x:D(s/t),y:D(a/t)}}function v(e,t,s){return{x:t/e||0,y:s/e||0}}function x(e,t){return e===t?je:I(e)>=I(t)?e<0?Be:Pe:t<0?De:ze}function k(e,t,s){s||(s=ot);var a=t[s[0]]-e[s[0]],i=t[s[1]]-e[s[1]];return Math.sqrt(a*a+i*i)}function O(e,t,s){s||(s=ot);var a=t[s[0]]-e[s[0]],i=t[s[1]]-e[s[1]];return Math.atan2(i,a)*180/Math.PI}function l(e,t){return O(t[1],t[0],Me)+O(e[1],e[0],Me)}function M(e,t){return k(t[0],t[1],Me)/k(e[0],e[1],Me)}var te={mousedown:q,mousemove:de,mouseup:F},pe="mousedown",fe="mousemove mouseup";function ve(){this.evEl=pe,this.evWin=fe,this.pressed=!1,le.apply(this,arguments)}y(ve,le,{handler:function(t){var s=te[t.type];s&q&&t.button===0&&(this.pressed=!0),s&de&&t.which!==1&&(s=F),this.pressed&&(s&F&&(this.pressed=!1),this.callback(this.manager,s,{pointers:[t],changedPointers:[t],pointerType:Ze,srcEvent:t}))}});var Ce={pointerdown:q,pointermove:de,pointerup:F,pointercancel:ee,pointerout:ee},Je={2:Q,3:Ge,4:Ze,5:yt},lt="pointerdown",Rt="pointermove pointerup pointercancel";S.MSPointerEvent&&!S.PointerEvent&&(lt="MSPointerDown",Rt="MSPointerMove MSPointerUp MSPointerCancel");function Et(){this.evEl=lt,this.evWin=Rt,le.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}y(Et,le,{handler:function(t){var s=this.store,a=!1,i=t.type.toLowerCase().replace("ms",""),c=Ce[i],w=Je[t.pointerType]||t.pointerType,j=w==Q,G=z(s,t.pointerId,"pointerId");c&q&&(t.button===0||j)?G<0&&(s.push(t),G=s.length-1):c&(F|ee)&&(a=!0),!(G<0)&&(s[G]=t,this.callback(this.manager,c,{pointers:s,changedPointers:[t],pointerType:w,srcEvent:t}),a&&s.splice(G,1))}});var ms={touchstart:q,touchmove:de,touchend:F,touchcancel:ee},ps="touchstart",gs="touchstart touchmove touchend touchcancel";function Ut(){this.evTarget=ps,this.evWin=gs,this.started=!1,le.apply(this,arguments)}y(Ut,le,{handler:function(t){var s=ms[t.type];if(s===q&&(this.started=!0),!!this.started){var a=ys.call(this,t,s);s&(F|ee)&&a[0].length-a[1].length===0&&(this.started=!1),this.callback(this.manager,s,{pointers:a[0],changedPointers:a[1],pointerType:Q,srcEvent:t})}}});function ys(e,t){var s=ue(e.touches),a=ue(e.changedTouches);return t&(F|ee)&&(s=Oe(s.concat(a),"identifier",!0)),[s,a]}var _s={touchstart:q,touchmove:de,touchend:F,touchcancel:ee},Ts="touchstart touchmove touchend touchcancel";function rt(){this.evTarget=Ts,this.targetIds={},le.apply(this,arguments)}y(rt,le,{handler:function(t){var s=_s[t.type],a=xs.call(this,t,s);a&&this.callback(this.manager,s,{pointers:a[0],changedPointers:a[1],pointerType:Q,srcEvent:t})}});function xs(e,t){var s=ue(e.touches),a=this.targetIds;if(t&(q|de)&&s.length===1)return a[s[0].identifier]=!0,[s,s];var i,c,w=ue(e.changedTouches),j=[],G=this.target;if(c=s.filter(function(ie){return b(ie.target,G)}),t===q)for(i=0;i<c.length;)a[c[i].identifier]=!0,i++;for(i=0;i<w.length;)a[w[i].identifier]&&j.push(w[i]),t&(F|ee)&&delete a[w[i].identifier],i++;if(j.length)return[Oe(c.concat(j),"identifier",!0),j]}var bs=2500,Lt=25;function Pt(){le.apply(this,arguments);var e=ye(this.handler,this);this.touch=new rt(this.manager,e),this.mouse=new ve(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}y(Pt,le,{handler:function(t,s,a){var i=a.pointerType==Q,c=a.pointerType==Ze;if(!(c&&a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents)){if(i)ws.call(this,s,a);else if(c&&Es.call(this,a))return;this.callback(t,s,a)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ws(e,t){e&q?(this.primaryTouch=t.changedPointers[0].identifier,Ft.call(this,t)):e&(F|ee)&&Ft.call(this,t)}function Ft(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var s={x:t.clientX,y:t.clientY};this.lastTouches.push(s);var a=this.lastTouches,i=function(){var c=a.indexOf(s);c>-1&&a.splice(c,1)};setTimeout(i,bs)}}function Es(e){for(var t=e.srcEvent.clientX,s=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var i=this.lastTouches[a],c=Math.abs(t-i.x),w=Math.abs(s-i.y);if(c<=Lt&&w<=Lt)return!0}return!1}var Bt=_e(Y.style,"touchAction"),zt=Bt!==m,Wt="compute",Yt="auto",St="manipulation",We="none",Ke="pan-x",Qe="pan-y",ct=Ss();function Ct(e,t){this.manager=e,this.set(t)}Ct.prototype={set:function(e){e==Wt&&(e=this.compute()),zt&&this.manager.element.style&&ct[e]&&(this.manager.element.style[Bt]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return n(this.manager.recognizers,function(t){se(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),Ps(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,s=e.offsetDirection;if(this.manager.session.prevented){t.preventDefault();return}var a=this.actions,i=g(a,We)&&!ct[We],c=g(a,Qe)&&!ct[Qe],w=g(a,Ke)&&!ct[Ke];if(i){var j=e.pointers.length===1,G=e.distance<2,ie=e.deltaTime<250;if(j&&G&&ie)return}if(!(w&&c)&&(i||c&&s&ce||w&&s&Se))return this.preventSrc(t)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Ps(e){if(g(e,We))return We;var t=g(e,Ke),s=g(e,Qe);return t&&s?We:t||s?t?Ke:Qe:g(e,St)?St:Yt}function Ss(){if(!zt)return!1;var e={},t=S.CSS&&S.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(s){e[s]=t?S.CSS.supports("touch-action",s):!0}),e}var ut=1,he=2,$e=4,Ue=8,Ne=Ue,et=16,Te=32;function Ie(e){this.options=A({},this.defaults,e||{}),this.id=we(),this.manager=null,this.options.enable=ne(this.options.enable,!0),this.state=ut,this.simultaneous={},this.requireFail=[]}Ie.prototype={defaults:{},set:function(e){return A(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(V(e,"recognizeWith",this))return this;var t=this.simultaneous;return e=dt(e,this),t[e.id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return V(e,"dropRecognizeWith",this)?this:(e=dt(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(V(e,"requireFailure",this))return this;var t=this.requireFail;return e=dt(e,this),z(t,e)===-1&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(V(e,"dropRequireFailure",this))return this;e=dt(e,this);var t=z(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,s=this.state;function a(i){t.manager.emit(i,e)}s<Ue&&a(t.options.event+Ht(s)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),s>=Ue&&a(t.options.event+Ht(s))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Te},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Te|ut)))return!1;e++}return!0},recognize:function(e){var t=A({},e);if(!se(this.options.enable,[this,t])){this.reset(),this.state=Te;return}this.state&(Ne|et|Te)&&(this.state=ut),this.state=this.process(t),this.state&(he|$e|Ue|et)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}};function Ht(e){return e&et?"cancel":e&Ue?"end":e&$e?"move":e&he?"start":""}function jt(e){return e==ze?"down":e==De?"up":e==Be?"left":e==Pe?"right":""}function dt(e,t){var s=t.manager;return s?s.get(e):e}function ge(){Ie.apply(this,arguments)}y(ge,Ie,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return t===0||e.pointers.length===t},process:function(e){var t=this.state,s=e.eventType,a=t&(he|$e),i=this.attrTest(e);return a&&(s&ee||!i)?t|et:a||i?s&F?t|Ue:t&he?t|$e:he:Te}});function ft(){ge.apply(this,arguments),this.pX=null,this.pY=null}y(ft,ge,{defaults:{event:"pan",threshold:10,pointers:1,direction:it},getTouchAction:function(){var e=this.options.direction,t=[];return e&ce&&t.push(Qe),e&Se&&t.push(Ke),t},directionTest:function(e){var t=this.options,s=!0,a=e.distance,i=e.direction,c=e.deltaX,w=e.deltaY;return i&t.direction||(t.direction&ce?(i=c===0?je:c<0?Be:Pe,s=c!=this.pX,a=Math.abs(e.deltaX)):(i=w===0?je:w<0?De:ze,s=w!=this.pY,a=Math.abs(e.deltaY))),e.direction=i,s&&a>t.threshold&&i&t.direction},attrTest:function(e){return ge.prototype.attrTest.call(this,e)&&(this.state&he||!(this.state&he)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=jt(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}});function Nt(){ge.apply(this,arguments)}y(Nt,ge,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[We]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&he)},emit:function(e){if(e.scale!==1){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}});function It(){Ie.apply(this,arguments),this._timer=null,this._input=null}y(It,Ie,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Yt]},process:function(e){var t=this.options,s=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!a||!s||e.eventType&(F|ee)&&!i)this.reset();else if(e.eventType&q)this.reset(),this._timer=re(function(){this.state=Ne,this.tryEmit()},t.time,this);else if(e.eventType&F)return Ne;return Te},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Ne&&(e&&e.eventType&F?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}});function kt(){ge.apply(this,arguments)}y(kt,ge,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[We]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&he)}});function Vt(){ge.apply(this,arguments)}y(Vt,ge,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ce|Se,pointers:1},getTouchAction:function(){return ft.prototype.getTouchAction.call(this)},attrTest:function(e){var t=this.options.direction,s;return t&(ce|Se)?s=e.overallVelocity:t&ce?s=e.overallVelocityX:t&Se&&(s=e.overallVelocityY),this._super.attrTest.call(this,e)&&t&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&I(s)>this.options.velocity&&e.eventType&F},emit:function(e){var t=jt(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}});function vt(){Ie.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}y(vt,Ie,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[St]},process:function(e){var t=this.options,s=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),e.eventType&q&&this.count===0)return this.failTimeout();if(a&&i&&s){if(e.eventType!=F)return this.failTimeout();var c=this.pTime?e.timeStamp-this.pTime<t.interval:!0,w=!this.pCenter||k(this.pCenter,e.center)<t.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!w||!c?this.count=1:this.count+=1,this._input=e;var j=this.count%t.taps;if(j===0)return this.hasRequireFailures()?(this._timer=re(function(){this.state=Ne,this.tryEmit()},t.interval,this),he):Ne}return Te},failTimeout:function(){return this._timer=re(function(){this.state=Te},this.options.interval,this),Te},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ne&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ke(e,t){return t=t||{},t.recognizers=ne(t.recognizers,ke.defaults.preset),new Ot(e,t)}ke.VERSION="2.0.7",ke.defaults={domEvents:!1,touchAction:Wt,enable:!0,inputTarget:null,inputClass:null,preset:[[kt,{enable:!1}],[Nt,{enable:!1},["rotate"]],[Vt,{direction:ce}],[ft,{direction:ce},["swipe"]],[vt],[vt,{event:"doubletap",taps:2},["tap"]],[It]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Cs=1,$t=2;function Ot(e,t){this.options=A({},ke.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=Tt(this),this.touchAction=new Ct(this,this.options.touchAction),Xt(this,!0),n(this.options.recognizers,function(s){var a=this.add(new s[0](s[1]));s[2]&&a.recognizeWith(s[2]),s[3]&&a.requireFailure(s[3])},this)}Ot.prototype={set:function(e){return A(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?$t:Cs},recognize:function(e){var t=this.session;if(!t.stopped){this.touchAction.preventDefaults(e);var s,a=this.recognizers,i=t.curRecognizer;(!i||i&&i.state&Ne)&&(i=t.curRecognizer=null);for(var c=0;c<a.length;)s=a[c],t.stopped!==$t&&(!i||s==i||s.canRecognizeWith(i))?s.recognize(e):s.reset(),!i&&s.state&(he|$e|Ue)&&(i=t.curRecognizer=s),c++}},get:function(e){if(e instanceof Ie)return e;for(var t=this.recognizers,s=0;s<t.length;s++)if(t[s].options.event==e)return t[s];return null},add:function(e){if(V(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(V(e,"remove",this))return this;if(e=this.get(e),e){var t=this.recognizers,s=z(t,e);s!==-1&&(t.splice(s,1),this.touchAction.update())}return this},on:function(e,t){if(e!==m&&t!==m){var s=this.handlers;return n(J(e),function(a){s[a]=s[a]||[],s[a].push(t)}),this}},off:function(e,t){if(e!==m){var s=this.handlers;return n(J(e),function(a){t?s[a]&&s[a].splice(z(s[a],t),1):delete s[a]}),this}},emit:function(e,t){this.options.domEvents&&Ns(e,t);var s=this.handlers[e]&&this.handlers[e].slice();if(!(!s||!s.length)){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<s.length;)s[a](t),a++}},destroy:function(){this.element&&Xt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Xt(e,t){var s=e.element;if(s.style){var a;n(e.options.cssProps,function(i,c){a=_e(s.style,c),t?(e.oldCssProps[a]=s.style[a],s.style[a]=i):s.style[a]=e.oldCssProps[a]||""}),t||(e.oldCssProps={})}}function Ns(e,t){var s=f.createEvent("Event");s.initEvent(e,!0,!0),s.gesture=t,t.target.dispatchEvent(s)}A(ke,{INPUT_START:q,INPUT_MOVE:de,INPUT_END:F,INPUT_CANCEL:ee,STATE_POSSIBLE:ut,STATE_BEGAN:he,STATE_CHANGED:$e,STATE_ENDED:Ue,STATE_RECOGNIZED:Ne,STATE_CANCELLED:et,STATE_FAILED:Te,DIRECTION_NONE:je,DIRECTION_LEFT:Be,DIRECTION_RIGHT:Pe,DIRECTION_UP:De,DIRECTION_DOWN:ze,DIRECTION_HORIZONTAL:ce,DIRECTION_VERTICAL:Se,DIRECTION_ALL:it,Manager:Ot,Input:le,TouchAction:Ct,TouchInput:rt,MouseInput:ve,PointerEventInput:Et,TouchMouseInput:Pt,SingleTouchInput:Ut,Recognizer:Ie,AttrRecognizer:ge,Tap:vt,Pan:ft,Swipe:Vt,Pinch:Nt,Rotate:kt,Press:It,on:Z,off:H,each:n,merge:B,extend:U,assign:A,inherit:y,bindFn:ye,prefixed:_e});var Is=typeof S<"u"?S:typeof self<"u"?self:{};Is.Hammer=ke,typeof m=="function"&&m.amd?m(function(){return ke}):r.exports?r.exports=ke:S[R]=ke})(window,document,"Hammer")})(hs);var At=hs.exports;function Ea(r){const S=os(r);let f=-1;function R(){clearInterval(f)}function m(){R(),ls(()=>S.value=r)}function P(Y){const oe=Y?getComputedStyle(Y):{transitionDuration:.2},D=parseFloat(oe.transitionDuration)*1e3||200;if(R(),S.value<=0)return;const I=performance.now();f=window.setInterval(()=>{const h=performance.now()-I+D;S.value=Math.max(r-h,0),S.value<=0&&R()},D)}return Ys(R),{clear:R,time:S,start:P,reset:m}}const Pa=Kt({multiLine:Boolean,text:String,timer:[Boolean,String],timeout:{type:[Number,String],default:5e3},vertical:Boolean,...Qt({location:"bottom"}),...ks(),...es(),...Vs(),...ts(),...Os(As({transition:"v-snackbar-transition"}),["persistent","noClickAnimation","scrim","scrollStrategy"])},"VSnackbar"),Sa=ss()({name:"VSnackbar",props:Pa(),emits:{"update:modelValue":r=>!0},setup(r,S){let{slots:f}=S;const R=Ds(r,"modelValue"),{locationStyles:m}=as(r),{positionClasses:P}=Ms(r),{scopeId:Y}=Rs(),{themeClasses:oe}=Us(r),{colorClasses:D,colorStyles:I,variantClasses:h}=Ls(r),{roundedClasses:re}=is(r),V=Ea(Number(r.timeout)),n=_(),X=_(),A=os(!1);$(R,B),$(()=>r.timeout,B),Dt(()=>{R.value&&B()});let U=-1;function B(){V.reset(),window.clearTimeout(U);const ne=Number(r.timeout);if(!R.value||ne===-1)return;const Z=Fs(X.value);V.start(Z),U=window.setTimeout(()=>{R.value=!1},ne)}function y(){V.reset(),window.clearTimeout(U)}function ye(){A.value=!0,y()}function se(){A.value=!1,B()}return ns(()=>{const ne=qt.filterProps(r),Z=!!(f.default||f.text||r.text);return d(qt,st({ref:n,class:["v-snackbar",{"v-snackbar--active":R.value,"v-snackbar--multi-line":r.multiLine&&!r.vertical,"v-snackbar--timer":!!r.timer,"v-snackbar--vertical":r.vertical},P.value,r.class],style:r.style},ne,{modelValue:R.value,"onUpdate:modelValue":H=>R.value=H,contentProps:st({class:["v-snackbar__wrapper",oe.value,D.value,re.value,h.value],style:[m.value,I.value],onPointerenter:ye,onPointerleave:se},ne.contentProps),persistent:!0,noClickAnimation:!0,scrim:!1,scrollStrategy:"none",_disableGlobalStack:!0},Y),{default:()=>{var H,b;return[Bs(!1,"v-snackbar"),r.timer&&!A.value&&d("div",{key:"timer",class:"v-snackbar__timer"},[d(mt,{ref:X,color:typeof r.timer=="string"?r.timer:"info",max:r.timeout,"model-value":V.time.value},null)]),Z&&d("div",{key:"content",class:"v-snackbar__content",role:"status","aria-live":"polite"},[((H=f.text)==null?void 0:H.call(f))??r.text,(b=f.default)==null?void 0:b.call(f)]),f.actions&&d(zs,{defaults:{VBtn:{variant:"text",ripple:!1,slim:!0}}},{default:()=>[d("div",{class:"v-snackbar__actions"},[f.actions()])]})]},activator:f.activator})}),Ws({},n)}}),Ca=Mt({__name:"Snackbar",props:{openSnackbar:Boolean,closeButton:Boolean,message:{type:String,default:""},duration:{type:Number,default:3e3}},emits:["update:openSnackbar"],setup(r,{emit:S}){const f=r,R=S,m=_(f.openSnackbar),P=_(f.message),Y=_(f.duration||3e3),oe=()=>{m.value=!1,R("update:openSnackbar",!1)};return $(()=>f.openSnackbar,D=>{m.value=D}),$(()=>f.message,D=>{P.value=D}),$(m,D=>{D||R("update:openSnackbar",!1)}),(D,I)=>(T(),Ve(Sa,{modelValue:m.value,"onUpdate:modelValue":I[0]||(I[0]=h=>m.value=h),elevation:"4",rounded:"lg",color:"#ffffff40",timeout:Y.value,location:"bottom left","content-class":"bg-[#4f4f4f44] backdrop-filter backdrop-blur-lg text-white mb-[50px]",style:{marginBottom:40}},Hs({default:p(()=>[E(N(P.value)+" ",1)]),_:2},[r.closeButton?{name:"actions",fn:p(()=>[d(He,{color:"white",variant:"text",onClick:oe},{default:p(()=>[d(W,null,{default:p(()=>[E("mdi-close")]),_:1})]),_:1})]),key:"0"}:void 0]),1032,["modelValue","timeout"]))}}),at=r=>(ds("data-v-aa996948"),r=r(),fs(),r),Na={class:"video-modal"},Ia={class:"modal-content"},ka={class:"flex flex-col justify-between h-full px-5 py-3 align-center"},Va={class:"flex flex-col justify-between pt-2 align-center gap-y-8"},Oa=["disabled","onClick"],Aa={class:"flex flex-col justify-center py-2 mb-[10px] align-center"},Da={class:"flex flex-col p-2 gap-y-2"},Ma=at(()=>u("div",null,[u("strong",null,"Computer:"),E(" Command+click, Ctrl+click or Long click to select multiple videos. ")],-1)),Ra=at(()=>u("div",null,[u("strong",null,"Mobile:"),E(" Long press to select multiple videos.")],-1)),Ua={class:"flex flex-row mt-4 gap-x-10"},La={class:"ml-[-8px]"},Fa={class:"frosted-button flex flex-col justify-center align-center w-[28px] h-[28px] rounded-full mb-1"},Ba=at(()=>u("div",{class:"text-sm"},"Close",-1)),za={key:0,class:"flex flex-col justify-between align-center pt-8 px-2 w-[300px] h-[480px]"},Wa={class:"flex flex-col w-full h-full px-4 overflow-auto align-center"},Ya={class:"relative video-wrapper"},Ha=["id","poster"],ja=["src"],$a=["onClick"],Xa=["onClick"],qa={class:"flex flex-row justify-center w-full ml-1 overflow-hidden text-xs"},Ga={key:0,class:"flex flex-row justify-between align-center h-[45px] w-full mb-[-15px]"},Za={key:1,class:"flex flex-col justify-between mt-5 align-center w-[720px]"},Ja=["controls","preload","poster"],Ka=["src"],Qa={class:"processing-bar"},ei={class:"w-0"},ti={class:"flex flex-col p-2 gap-y-2"},si={key:0,class:"flex flex-col justify-start w-full p-2 pt-3"},ai={class:"card-grid"},ii={class:"text-sm"},oi={class:"video-card-dot"},ni={key:1,class:"flex flex-row justify-between w-full h-full px-8 overflow-hidden align-center"},li={class:"flex flex-row justify-between pl-2 align-center gap-x-6"},ri={class:"flex flex-row cursor-default text-md"},ci={key:0,class:"flex flex-row w-[320px] justify-center gap-x-4 align-center ml-1"},ui={key:0,class:"text-sm text-white border-2 rounded-md mt-[3px] border-[#ffffff44] bg-[#fafafa33] ml-4 px-1"},di={class:"flex flex-row mt-2"},fi=["disabled","onClick"],vi={class:"mb-10 slide-right-to-left"},hi={key:2},mi={key:2,class:"flex flex-row justify-center w-full h-full text-xl text-center align-center"},pi=at(()=>u("div",{class:"flex flex-col mb-2 text-center align-end"}," Processing multiple videos may take a while, depending on the number of videos and their sizes. Cockpit will be usable during the process, but the performance may be affected and recording of new videos is disabled. ",-1)),gi={key:0,class:"flex flex-col -mt-2 text-center align-center"},yi={class:"flex flex-col justify-between h-[140px] w-full pb-3"},_i={key:0,class:"flex flex-col justify-start"},Ti={class:"mb-3 text-sm text-center"},xi={class:"flex flex-row justify-between w-full mb-2 align-center"},bi={class:"text-sm font-bold w-[450px] text-nowrap text-start text-ellipsis overflow-x-hidden"},wi={class:"text-sm text-end"},Ei={class:"flex flex-row justify-between w-full mb-2"},Pi=at(()=>u("div",{class:"text-sm font-bold text-start"},"Overall Progress",-1)),Si={class:"text-sm font-bold text-end"},Ci={key:1},Ni={class:"flex flex-col justify-center w-full pb-3 text-center text-md"},Ii=Mt({__name:"VideoLibraryModal",props:{openModal:Boolean},emits:["update:openModal"],setup(r,{emit:S}){const f=rs(),R=js(),m=r,P=S,{showDialog:Y,closeDialog:oe}=$s(),{width:D}=Xs(),I=_([]),h=_([]),re=_([]),V=_(m.openModal),n=_([]),X=_(null),A=_("videos"),U=_(!1),B=_(""),y=_(!1),ye=_(!1),se=_(!1),ne=_({}),Z=_(!1),H=_(!1),b=_(!0),g=_(!1),J=_(""),z=_([]),ue=_(!1),Oe=_(""),_e=_([]),Fe=_(!1),we=_(!1),Ee=_(0),K=_([{fileName:"",progress:0,message:""}]),qe=_(0),ae=_(!1),Ae=_(null),Q=_(!1),Ge=_(!1),Ze=pt(()=>({transform:`scale(${(R.isOnSmallScreen?D.value/1100:1)*.98}) translate(0, 0)`,transformOrigin:"center"})),yt=[{name:"Videos",icon:"mdi-video-outline",selected:!0,disabled:!1,tooltip:""},{name:"Pictures",icon:"mdi-image-outline",selected:!1,disabled:!0,tooltip:"Coming soon"}],_t=pt(()=>[{name:"Delete",icon:"mdi-delete-outline",size:22,tooltip:"",confirmAction:!0,show:!0,disabled:ae.value===!0||we.value===!0,action:()=>wt()},{name:"Download",icon:"mdi-tray-arrow-down",size:28,tooltip:"Download selected videos with logs",confirmAction:!1,show:!0,disabled:ae.value===!0||we.value===!0,action:()=>xt()}]),q=()=>{V.value=!1,P("update:openModal",!1),A.value="videos",I.value.forEach(o=>URL.revokeObjectURL(o)),I.value=[],Me(),Ae.value=null,y.value=!1},de=o=>{const v=/\(([^)]+)\)/,x=o.match(v);return x?x[1]:""},F=o=>{const v=/.*\(([^)]+)\)/,x=o.match(v);return x?x[0]:""},ee=()=>{if(n.value.length===1&&!y.value){const o=document.getElementById("video-player");o&&o.play().catch(v=>console.error("Error auto-playing video:",v))}},je=()=>{y.value=!y.value,y.value||Me()},Be=o=>{const v=n.value.findIndex(x=>x.fileName===o.fileName);v!==-1?n.value.length>1&&n.value.splice(v,1):(n.value.push(o),y.value=!0)},Pe=()=>{Q.value=!1,Ee.value=0,K.value=[{fileName:"",progress:0,message:""}],ae.value=!1},De=async()=>{try{await f.processVideoChunksAndTelemetry(n.value.map(o=>o.hash)),y.value=!1,await Re()}catch(o){const v=`Video processing failed: ${o.message??o.toString()}`;console.error(v),B.value=v,U.value=!0,Q.value=!0}},ze=()=>{Q.value&&Re(),ue.value=!1,Pe()},ce=async()=>{n.value.length===1&&!n.value[0].isProcessed&&(ae.value=!0),De()},Se=()=>{qe.value=n.value.length,Oe.value="Processing Videos",_e.value=[{text:Ee.value===100?"Close":"Hide",size:"small",class:"font-light",action:ze}],g.value=!1,ue.value=!0,De()},it=()=>{J.value="Process Multiple Videos",z.value=[{text:"Cancel",size:"small",class:"font-light",action:()=>{g.value=!1}},{text:"Process videos",size:"small",class:"font-bold",action:async()=>{g.value=!1,Se()}}],g.value=!0},ot=()=>{n.value=[...h.value],y.value=!0},Me=()=>{y.value=!1,ye.value=!1,se.value=!1,n.value.length>1&&(n.value=[n.value[0]])},le=()=>{h.value.some(o=>!o.isProcessed)?(n.value=h.value.filter(o=>!o.isProcessed),y.value=!0):(B.value="No unprocessed videos found",U.value=!0)},Tt=()=>{h.value.some(o=>o.isProcessed)?(n.value=h.value.filter(o=>o.isProcessed),y.value=!0):(B.value="No processed videos found",U.value=!0)},nt=o=>o.flatMap(x=>{const O=`${x.split(".").slice(0,-1).join(".")}.ass`;return re.value.some(M=>M.fileName===O)?[x,O]:[x]}),xt=async()=>{let o=!1;const v=async(O,l)=>{const M=(100*O/l).toFixed(1);o&&(B.value=`Preparing download: ${M}%.`,U.value=!0)};B.value="Getting your download ready...",setTimeout(()=>o=!0,1500);let x=[],k=[];if(n.value.forEach(O=>{O.isProcessed&&x.push(O.fileName),!O.isProcessed&&O.hash&&k.push(O.hash)}),U.value=!0,!(k.length>0&&!await bt())){if(we.value=!0,x.length>0){const O=nt(x);await f.downloadFilesFromVideoDB(O,v)}k.length>0&&await f.downloadTempVideo(k,v),we.value=!1}},bt=async()=>{let o=!1;return await Y({maxWidth:600,title:"You are downloading unprocessed videos",message:`One or more videos that you are downloading contains unprocessed chunks, which are not playable. To be
      able to play the downloaded videos, you need to go back and process those videos first.`,variant:"info",actions:[{text:"Go back",action:()=>{o=!1}},{text:"Download anyway",action:()=>{o=!0}}]}),oe(),o},wt=async()=>{Ge.value=!0;let o=n.value.length,v=[],x=[];if(await n.value.forEach(k=>{k.isProcessed&&v.push(k.fileName),!k.isProcessed&&k.hash&&x.push(k.hash)}),v.length>0){const k=nt(v);await f.discardProcessedFilesFromVideoDB(k)}x.length>0&&await f.discardUnprocessedFilesFromVideoDB(x),B.value=`${o} video(s) discarded.`,U.value=!0,await Re(),n.value=h.value.length>0?[h.value[0]]:[],h.value.length===1&&(y.value=!1),Ge.value=!1},Re=async()=>{b.value=!0,h.value=[];const o=[],v=[];await f.videoStoringDB.iterate((pe,fe)=>{f.isVideoFilename(fe)&&o.push((async()=>{const ve=await f.videoStoringDB.getItem(fe);let Ce="",Je=!0;ve instanceof Blob?(Ce=URL.createObjectURL(ve),I.value.push(Ce)):console.error("Video data is not a Blob:",ve);const lt=await f.videoStorageFileSize(fe)??0;return{fileName:fe,size:lt,url:Ce,isProcessed:Je}})()),fe.endsWith(".ass")&&v.push((async()=>{const ve=await f.videoStoringDB.getItem(fe);let Ce="";ve instanceof Blob?(Ce=URL.createObjectURL(ve),I.value.push(Ce)):console.error("Video data is not a Blob:",ve);const Je=await f.videoStorageFileSize(fe)??0;return{fileName:fe,url:Ce,size:Je}})())});const x=await f.unprocessedVideos,k=Object.entries(x).map(async([pe,fe])=>({...fe,hash:pe,url:"",isProcessed:!1})),O=await Promise.all(o),l=await Promise.all(v),te=(await Promise.all(k)).filter(pe=>pe.dateFinish||f.keysFailedUnprocessedVideos.includes(pe.hash));h.value=[...O,...te],re.value=l,b.value=!1};return $(()=>f.currentFileProgress,o=>{K.value=o},{deep:!0}),$(()=>f.overallProgress,o=>{Ee.value=o,o>0&&o<100&&(Fe.value=!0,ae.value=!0),o===100&&(Fe.value=!1,ae.value=!1,setTimeout(()=>{ue.value=!1},1e3))}),$(V,o=>{P("update:openModal",o),o||(Pe(),y.value=!1,Ae.value=null,ae.value=!1)}),$(()=>m.openModal,async o=>{V.value=o,o===!0&&(await Re(),ae.value=!1)}),$(n,o=>{if(o.length===1){Q.value&&Pe(),Ae.value=o[0];const v=o[0].url,x=X.value;x&&(x.src=v,x.load())}},{immediate:!0,deep:!0}),$(h,()=>{if(Ae.value){const o=h.value.find(v=>de(v.fileName)===de(Ae.value.fileName));o&&(n.value=[o])}else n.value=h.value.length>0?[h.value[0]]:[]},{deep:!0}),$(V,()=>{V.value||(Ae.value=null)}),$(h,async()=>{await ls(),h.value.forEach(o=>{var x;const v=document.getElementById(`video-library-${o.fileName}`);if(v){(x=ne.value[o.fileName])==null||x.destroy();const k=new At.Manager(v);k.add(new At.Tap),k.add(new At.Press({time:500})),k.on("tap",O=>{const l=n.value.some(te=>te.fileName===o.fileName);if(y.value||O.srcEvent.ctrlKey||O.srcEvent.metaKey){y.value=!0;const te=n.value.findIndex(pe=>pe.fileName===o.fileName);te>-1?n.value.length>1&&n.value.splice(te,1):n.value.push(o)}else l||(n.value=[o]);if(n.value.length===1&&l){const te=document.getElementById("video-player");te&&(te.load(),te.play().catch(pe=>console.error("Error auto-playing video:",pe)))}}),k.on("press",()=>{y.value=!0,n.value.some(O=>O.fileName===o.fileName)||n.value.push(o)}),ne.value[o.fileName]=k}})},{immediate:!0,deep:!0}),Dt(async()=>{b.value=!0,await Re()}),cs(()=>{A.value="videos",I.value.forEach(o=>URL.revokeObjectURL(o)),I.value=[],Object.values(ne.value).forEach(o=>{o.destroy()})}),(o,v)=>(T(),C(Le,null,[d(us,{modelValue:V.value,"onUpdate:modelValue":v[8]||(v[8]=x=>V.value=x),class:"dialog"},{default:p(()=>{var x,k,O;return[u("div",{class:"dialog-frame",style:Gt(Ze.value)},[u("div",Na,[u("div",Ia,[u("div",ka,[u("div",Va,[(T(),C(Le,null,ht(yt,l=>u("button",{key:l.name,disabled:l.disabled,class:"flex flex-col justify-center align-center",onClick:M=>A.value=l.name.toLowerCase()},[l.tooltip!==""?(T(),Ve(be,{key:0,"open-delay":"600",activator:"parent",location:"top"},{default:p(()=>[E(N(l.tooltip),1)]),_:2},1024)):L("",!0),u("div",{class:me(["mb-1 text-2xl rounded-full",[l.disabled?"frosted-button-disabled":"frosted-button",A.value===l.name.toLowerCase()?"w-[58px] h-[58px]":"w-[40px] h-[40px]"]])},[d(W,{size:A.value===l.name.toLowerCase()?40:24,class:me({"ml-1":l.name.toLowerCase()==="videos"})},{default:p(()=>[E(N(l.icon),1)]),_:2},1032,["size","class"])],2),u("div",{class:me(["text-sm",{"text-white/30":!l.disabled}])},N(l.name),3)],8,Oa)),64))]),u("div",null,[u("div",Aa,[u("button",{class:"frosted-button text-[#ffffffaa] flex flex-col justify-center align-center w-[28px] h-[28px] rounded-full mb-[4px]",onClick:v[2]||(v[2]=l=>Z.value=!Z.value)},[d(W,{class:"text-[24px]"},{default:p(()=>[E("mdi-help-circle-outline")]),_:1}),d(be,{modelValue:Z.value,"onUpdate:modelValue":v[0]||(v[0]=l=>Z.value=l),"open-on-hover":!1,activator:"parent",location:"top",arrow:"","content-class":"border-[#ffffff55] border-2","onClick:outside":v[1]||(v[1]=l=>Z.value=!1)},{default:p(()=>[u("div",Da,[Ma,Ra,u("div",Ua,[u("div",La,[d(W,{size:"10",class:"text-green-500 ml-2 mb-[2px] mr-1"},{default:p(()=>[E("mdi-circle")]),_:1}),E(" Processed video ")]),u("div",null,[d(W,{size:"10",class:"text-red-500 mb-[2px] mr-1"},{default:p(()=>[E("mdi-circle")]),_:1}),E(" Unprocessed video ")])])])]),_:1},8,["modelValue"])])]),d(tt,{class:"opacity-[0.1] ml-[-5px] w-[120%]"}),u("button",{class:"flex flex-col justify-center py-2 mt-4 align-center",onClick:q},[u("div",Fa,[d(W,{class:"text-[18px]"},{default:p(()=>[E("mdi-close")]),_:1})]),Ba])])]),d(tt,{vertical:"",class:"h-[92%] mt-4 opacity-[0.1]"}),A.value==="videos"?(T(),C(Le,{key:0},[h.value.length>0?(T(),C("div",za,[u("div",Wa,[(T(!0),C(Le,null,ht(h.value,l=>(T(),C("div",{key:l.fileName,class:"mb-4 video-container"},[u("div",Ya,[u("video",{id:`video-library-${l.fileName}`,class:me(["border-4 border-white rounded-md cursor-pointer border-opacity-[0.1] hover:border-opacity-[0.4] transition duration-75 hover:ease-in",n.value.find(M=>M.fileName===l.fileName)?["border-opacity-[0.4]","w-[220px]"]:["border-opacity-[0.1]","w-[190px]"]]),preload:"auto",poster:l.isProcessed?void 0:l.thumbnail},[u("source",{src:l.url},null,8,ja)],10,Ha),n.value.find(M=>M.fileName===l.fileName)&&!y.value?(T(),C("div",{key:0,class:"play-button",onClick:M=>l.isProcessed?ee():ce()},[d(W,{size:"40",class:"text-white"},{default:p(()=>[E(N(l.isProcessed?"mdi-play-circle-outline":"mdi-progress-alert"),1)]),_:2},1024)],8,$a)):L("",!0),y.value?(T(),C("div",{key:1,class:me(["checkmark-button",n.value.find(M=>M.fileName===l.fileName)?"bg-green":"bg-white"]),onClick:qs(M=>Be(l),["stop"])},[d(W,{size:"15",class:"text-white"},{default:p(()=>[E(N(n.value.find(M=>M.fileName===l.fileName)?"mdi-check-circle-outline":"mdi-radiobox-blank"),1)]),_:2},1024)],10,Xa)):L("",!0)]),u("div",qa,[d(be,{"open-delay":"500",activator:"parent",location:"top"},{default:p(()=>[E(N(l.isProcessed?"Processed video":"Unprocessed video"),1)]),_:2},1024),E(" "+N(de(l.fileName)??"Cockpit video")+" ",1),d(W,{size:"10",class:me(["ml-1 mt-[3px]",l.isProcessed?"text-green-500":"text-red-500"])},{default:p(()=>[E(" mdi-circle ")]),_:2},1032,["class"])])]))),128))]),h.value.length>1?(T(),C("div",Ga,[u("div",null,[d(He,{variant:"text",size:"small",class:"mt-[5px]",onClick:je},{default:p(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:p(()=>[E(" Select "+N(y.value?"single":"multiple")+" files ",1)]),_:1}),E(" "+N(y.value?"Single":"Multi"),1)]),_:1})]),u("div",null,[d(He,{variant:"text",size:"small",class:"mt-[5px]",onClick:v[3]||(v[3]=l=>n.value.length===h.value.length?Me():ot())},{default:p(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:p(()=>[E(" Select "+N(n.value.length===h.value.length?"none":"all files"),1)]),_:1}),E(" "+N(n.value.length===h.value.length?"None":"All"),1)]),_:1})]),u("div",null,[d(He,{variant:"text",size:"small",class:"mt-[5px]",onClick:v[4]||(v[4]=l=>n.value.every(M=>!M.isProcessed)?Tt():le())},{default:p(()=>[d(be,{"open-delay":"500",activator:"parent",location:"bottom"},{default:p(()=>[E(N(n.value.every(l=>!l.isProcessed)?"Select all processed videos":"Select all unprocessed videos"),1)]),_:1}),E(" "+N(n.value.every(l=>!l.isProcessed)?"Select Process.":"select Unproc."),1)]),_:1})])])):L("",!0)])):L("",!0),d(tt,{vertical:"",class:"h-[92%] mt-4 opacity-[0.1]"}),h.value.length>0?(T(),C("div",Za,[u("div",null,[!y.value&&n.value.length===1&&!y.value&&!b.value?(T(),C("video",{key:0,id:"video-player",ref_key:"videoPlayerRef",ref:X,width:"660px",controls:!!n.value[0].isProcessed,preload:n.value[0].isProcessed?"auto":"none",poster:((x=n.value[0])==null?void 0:x.thumbnail)||void 0,class:"border-[14px] border-white border-opacity-10 rounded-lg min-h-[382px] aspect-video"},[u("source",{src:((k=n.value[0])==null?void 0:k.url)||void 0},null,8,Ka)],8,Ja)):L("",!0),!b.value&&n.value.length===1&&!n.value[0].isProcessed&&!y.value&&!Q.value?(T(),Ve(He,{key:1,variant:ae.value?"text":"outlined",color:"white",size:"large",disabled:ae.value,class:"process-button",onClick:ce},{default:p(()=>[E(N(ae.value?"Processing...":"Process video"),1)]),_:1},8,["variant","disabled"])):L("",!0),u("div",Qa,[ae.value&&!ue.value?(T(),Ve(mt,{key:0,"model-value":Q.value?100:Ee.value,color:Q.value?"red":"green",height:"8",striped:""},null,8,["model-value","color"])):L("",!0),u("div",ei,[!b.value&&n.value.length===1&&ae.value&&Q.value?(T(),C("button",{key:0,class:"bg-red text-[#ffffffaa] flex flex-col justify-center align-center w-[20px] h-[20px] rounded-full mt-[40px] ml-[-25px]",onClick:v[7]||(v[7]=l=>H.value=!H.value)},[d(W,{class:"text-[18px]"},{default:p(()=>[E("mdi-alert-circle-outline")]),_:1}),d(be,{modelValue:H.value,"onUpdate:modelValue":v[5]||(v[5]=l=>H.value=l),"open-on-hover":!1,activator:"parent",location:"bottom",arrow:"","content-class":"border-[#ffffff55] border-2","onClick:outside":v[6]||(v[6]=l=>H.value=!1)},{default:p(()=>[u("div",ti,[u("div",null,N(B.value),1)])]),_:1},8,["modelValue"])])):L("",!0)])])]),h.value.length>0&&n.value.length>=1&&y.value?(T(),C("div",si,[u("div",ai,[(T(!0),C(Le,null,ht(n.value,l=>(T(),Ve(Gs,{key:l.fileName,class:"video-card"},{default:p(()=>[u("div",null,[d(Zs,null,{default:p(()=>[u("div",ii,N(de(l.fileName)),1)]),_:2},1024),u("div",oi,[d(W,{size:"10",class:me(l.isProcessed?"text-green-500":"text-red-500")},{default:p(()=>[E(" mdi-circle ")]),_:2},1032,["class"])])])]),_:2},1024))),128))]),d(tt,{class:"mb-[-10px] opacity-[0.1] mx-3"})])):L("",!0),h.value.length>0?(T(),C("div",ni,[u("div",li,[u("div",ri,N(y.value?`Files selected: ${n.value.length}`:F((O=n.value[0])==null?void 0:O.fileName)),1),y.value?(T(),C("div",ci,[n.value.every(l=>!l.isProcessed)?(T(),C("div",ui,[u("button",{onClick:it},"Process selected videos")])):L("",!0)])):L("",!0)]),u("div",di,[(T(!0),C(Le,null,ht(_t.value,l=>(T(),C("button",{key:l.name,class:"flex flex-col justify-center ml-6 align-center",disabled:l.disabled,onClick:M=>!l.confirmAction&&l.action()},[u("div",{class:me([[l.disabled?"frosted-button-disabled":"frosted-button",!l.confirmAction&&"p-2"],"flex flex-col justify-center mb-1 rounded-full frosted-button align-center button"])},[l.tooltip?(T(),Ve(be,{key:0,"open-delay":"500",activator:"parent",location:"bottom"},{default:p(()=>[E(N(l.tooltip),1)]),_:2},1024)):L("",!0),l.confirmAction?(T(),Ve(Js,{key:1,location:"left center",opacity:"0",transition:"slide-x-reverse-transition",disabled:l.disabled},{activator:p(({props:M,isActive:te})=>[u("div",st({class:"flex items-center justify-center w-full h-full"},M),[d(W,{size:l.size,class:me([{"rotate-[-45deg]":te,"outline outline-6 outline-[#ffffff55]":te},"rounded-full border-[transparent]"]),style:Gt({borderWidth:`${l.size-4}px`})},{default:p(()=>[E(N(te?"mdi-arrow-up":l.icon),1)]),_:2},1032,["size","class","style"])],16)]),default:p(()=>[d(Ks,{class:"bg-transparent",elevation:"0"},{default:p(()=>[d(Qs,null,{append:p(()=>[u("div",vi,[d(He,{fab:"",small:"",width:"28",height:"28",color:"red",icon:"mdi-close",class:"text-sm outline outline-3 outline-[#ffffff44] hover:outline-[#ffffff77]"},{default:p(()=>[d(be,{"open-delay":"600",activator:"parent",location:"bottom"},{default:p(()=>[E(" Cancel ")]),_:1}),d(W,null,{default:p(()=>[E("mdi-close")]),_:1})]),_:1}),d(He,{fab:"",small:"",width:"28",height:"28",color:"green",icon:"mdi-check",class:"ml-4 text-sm outline outline-3 outline-[#ffffff44] hover:outline-[#ffffff77]",loading:Ge.value,onClick:M=>l.action()},{default:p(()=>[d(be,{"open-delay":"600",activator:"parent",location:"bottom"},{default:p(()=>[E(" Confirm ")]),_:1}),d(W,null,{default:p(()=>[E("mdi-check")]),_:1})]),_:2},1032,["loading","onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disabled"])):(T(),C("div",hi,[d(W,{size:l.size},{default:p(()=>[E(N(l.icon),1)]),_:2},1032,["size"])]))],2)],8,fi))),128))])])):L("",!0)])):L("",!0),h.value.length===0?(T(),C("div",mi,N(b.value?"Loading":"No videos on storage"),1)):L("",!0)],64)):L("",!0)])])],4)]}),_:1},8,["modelValue"]),d(Ca,{"open-snackbar":U.value,message:B.value,duration:3e3,"close-button":!1,"onUpdate:openSnackbar":v[9]||(v[9]=x=>U.value=x)},null,8,["open-snackbar","message"]),d(Zt,{"show-dialog":g.value,title:J.value,actions:z.value,"max-width":600},{content:p(()=>[pi]),_:1},8,["show-dialog","title","actions"]),d(Zt,{"show-dialog":ue.value,title:Oe.value,actions:_e.value,"max-width":600},{content:p(()=>[Q.value?L("",!0):(T(),C("div",gi,[u("div",yi,[K.value.length>0?(T(),C("div",_i,[u("div",Ti," File "+N(K.value.length)+" of "+N(qe.value)+": "+N(K.value[K.value.length-1].message),1),u("div",xi,[u("div",bi,N(K.value[K.value.length-1].fileName),1),u("div",wi,[d(ea,{width:"1",size:"10",indeterminate:"",class:"mr-1 mb-[2px]"}),E(" "+N(`${K.value[K.value.length-1].progress}%`),1)])]),d(mt,{"model-value":K.value[K.value.length-1].progress,color:"white",height:"6",rounded:"",striped:""},null,8,["model-value"])])):L("",!0),u("div",null,[u("div",Ei,[Pi,u("div",Si,N(`${Math.ceil(Ee.value)}%`),1)]),d(mt,{"model-value":Math.ceil(Ee.value),color:"blue",height:"6",rounded:"",striped:""},null,8,["model-value"])])])])),Q.value?(T(),C("div",Ci,[u("div",Ni,N(`Error processing video file: ${K.value[K.value.length-1].fileName}`),1)])):L("",!0)]),_:1},8,["show-dialog","title","actions"])],64))}}),ki=vs(Ii,[["__scopeId","data-v-aa996948"]]),Vi=Kt({bordered:Boolean,color:String,content:[Number,String],dot:Boolean,floating:Boolean,icon:ta,inline:Boolean,label:{type:String,default:"$vuetify.badge"},max:[Number,String],modelValue:{type:Boolean,default:!0},offsetX:[Number,String],offsetY:[Number,String],textColor:String,...sa(),...Qt({location:"top end"}),...es(),...aa(),...ts(),...ia({transition:"scale-rotate-transition"})},"VBadge"),Oi=ss()({name:"VBadge",inheritAttrs:!1,props:Vi(),setup(r,S){const{backgroundColorClasses:f,backgroundColorStyles:R}=oa(Jt(r,"color")),{roundedClasses:m}=is(r),{t:P}=na(),{textColorClasses:Y,textColorStyles:oe}=la(Jt(r,"textColor")),{themeClasses:D}=ra(),{locationStyles:I}=as(r,!0,h=>(r.floating?r.dot?2:4:r.dot?8:12)+(["top","bottom"].includes(h)?+(r.offsetY??0):["left","right"].includes(h)?+(r.offsetX??0):0));return ns(()=>{const h=Number(r.content),re=!r.max||isNaN(h)?r.content:h<=+r.max?h:`${r.max}+`,[V,n]=ca(S.attrs,["aria-atomic","aria-label","aria-live","role","title"]);return d(r.tag,st({class:["v-badge",{"v-badge--bordered":r.bordered,"v-badge--dot":r.dot,"v-badge--floating":r.floating,"v-badge--inline":r.inline},r.class]},n,{style:r.style}),{default:()=>{var X,A;return[d("div",{class:"v-badge__wrapper"},[(A=(X=S.slots).default)==null?void 0:A.call(X),d(ua,{transition:r.transition},{default:()=>{var U,B;return[da(d("span",st({class:["v-badge__badge",D.value,f.value,m.value,Y.value],style:[R.value,oe.value,r.inline?{}:I.value],"aria-atomic":"true","aria-label":P(r.label,h),"aria-live":"polite",role:"status"},V),[r.dot?void 0:S.slots.badge?(B=(U=S.slots).badge)==null?void 0:B.call(U):r.icon?d(W,{icon:r.icon},null):re]),[[fa,r.modelValue]])]}})])]}})}),{}}}),gt=r=>(ds("data-v-4c0101b9"),r=r(),fs(),r),Ai={key:1},Di={class:"text-xs text-white select-none scroll-text"},Mi={key:3,class:"w-16 text-justify text-slate-100"},Ri={key:4,class:"w-16 text-justify text-slate-100"},Ui=gt(()=>u("div",{class:"text-xs text-center text-white select-none flex-nowrap"},"Processing video...",-1)),Li=[Ui],Fi={key:5,class:"flex justify-center w-8"},Bi={class:"p-6 m-5 bg-white rounded-md"},zi=gt(()=>u("p",{class:"text-xl font-semibold"},"Choose a stream to record",-1)),Wi=gt(()=>u("div",{class:"w-auto h-px my-2 bg-grey-lighten-3"},null,-1)),Yi={class:"flex items-center"},Hi=gt(()=>u("span",null,"Record",-1)),ji={key:1,class:"w-5 h-5 ml-2 rounded-full bg-red"},$i=Mt({__name:"MiniVideoRecorder",props:{miniWidget:{}},setup(r){const S=va(),f=rs(),m=ha(r).miniWidget,P=_(),{namesAvailableStreams:Y}=ma(f),oe=_(),{isOutside:D}=pa(oe),I=_(!1),h=_(!1),re=ga({interval:100}),V=_(),n=_(!1),X=_(0);Dt(async()=>{await U()}),ya(async()=>{Object.keys(m.value.options).length===0&&(m.value.options={streamName:void 0}),P.value=m.value.options.streamName}),$(P,()=>{m.value.options.streamName=P.value,V.value=void 0});const A=b=>{I.value=b},U=async()=>{const b=(await f.videoStoringDB.keys()).filter(J=>f.isVideoFilename(J)).length,g=Object.keys(f.keysFailedUnprocessedVideos).length;X.value=b+g};function B(b){if(P.value=b,P.value===void 0){Xe.fire({text:"No stream selected.",icon:"error"});return}if(Y.value.includes(P.value))return;const g="The selected stream is not available. Please check its source or select another stream.";throw Xe.fire({text:g,icon:"error"}),new Error(g)}const y=async()=>{if(se.value){P.value!==void 0&&f.stopRecording(P.value);return}if(P.value===void 0){m.value.managerVars.configMenuOpen=!0;return}ye()},ye=()=>{var b;if(P.value&&!((b=f.getStreamData(P.value))!=null&&b.connected)){Xe.fire({title:"Cannot start recording.",text:"Stream is not connected.",icon:"error"});return}B(P.value),f.startRecording(P.value),m.value.managerVars.configMenuOpen=!1},se=pt(()=>P.value===void 0?!1:f.isRecording(P.value)),ne=pt(()=>{var Oe,_e,Fe,we;if(P.value===void 0)return"00:00:00";const b=(Oe=f.getStreamData(P.value))==null?void 0:Oe.timeRecordingStart;if(b===void 0)return"00:00:00";const g=_a({start:b,end:re.value}),J=((_e=g.hours)==null?void 0:_e.toFixed(0).length)===1?`0${g.hours}`:g.hours,z=((Fe=g.minutes)==null?void 0:Fe.toFixed(0).length)===1?`0${g.minutes}`:g.minutes,ue=((we=g.seconds)==null?void 0:we.toFixed(0).length)===1?`0${g.seconds}`:g.seconds;return`${J}:${z}:${ue}`}),Z=async b=>{B(b),V.value=void 0,h.value=!0;let g=0;const J=100,z=3e3;for(;h.value&&g<z;)h.value=V.value===void 0||!V.value.active,await wa(J),g+=J;if(h.value){Xe.fire({text:"Could not load media stream.",icon:"error"});return}m.value.options.streamName=b};let H;return S.isRealMiniWidget(m.value)&&(H=setInterval(()=>{m.value.options.streamName===void 0&&!Y.value.isEmpty()&&(m.value.options.streamName=Y.value[0],P.value=m.value.options.streamName,Y.value.length>1&&Xe.fire({title:"Multiple streams detected",text:`You have multiple streams available, so we chose one randomly to start with.
          If you want to change it, please open the widget configuration.`,icon:"info",confirmButtonText:"OK"}));const b=f.getMediaStream(m.value.options.streamName);Ta(b,V.value)||(V.value=b)},1e3)),cs(()=>clearInterval(H)),$(()=>f.areThereVideosProcessing,b=>{n.value=b,U()}),$(()=>f.keysFailedUnprocessedVideos,()=>U()),$(()=>I.value,async b=>{b===!1&&await U()}),$(se,()=>{if(!se.value){window.onbeforeunload=null;return}window.onbeforeunload=()=>(Xe.fire({text:`
      You have a video recording ongoing.
      Remember to stop it before closing Cockpit, or the record will be lost.
    `,icon:"warning"}),"I hope the user does not click on the leave button.")}),(b,g)=>{const J=xa("FontAwesomeIcon");return T(),C(Le,null,[u("div",{ref_key:"recorderWidget",ref:oe,class:me(["flex justify-around px-2 py-1 text-center rounded-lg h-9 align-center bg-slate-800/60",{"w-48":X.value>0,"w-32":X.value<=0}])},[n.value?(T(),C("div",Ai,[d(W,{class:"w-6 h-6 animate-spin",color:"white"},{default:p(()=>[E("mdi-loading")]),_:1})])):(T(),C("div",{key:0,class:me([{"blob red w-5 opacity-100 rounded-sm":se.value,"opacity-30 bg-red-400":Ye(D)&&!se.value},"w-6 transition-all duration-500 rounded-full aspect-square bg-red-lighten-1 hover:cursor-pointer opacity-70 hover:opacity-90"]),onClick:g[0]||(g[0]=z=>y())},null,2)),!se.value&&!n.value?(T(),C(Le,{key:2},[P.value?(T(),C("div",{key:0,class:"flex flex-col max-w-[50%] scroll-container transition-all border-blur cursor-pointer",onClick:g[1]||(g[1]=z=>Ye(m).managerVars.configMenuOpen=!0)},[u("div",Di,N(P.value),1)])):(T(),Ve(J,{key:1,icon:"fa-solid fa-video",class:"h-6 text-slate-100"}))],64)):L("",!0),se.value&&!n.value?(T(),C("div",Mi,N(ne.value),1)):n.value?(T(),C("div",Ri,Li)):L("",!0),X.value>0?(T(),C("div",Fi,[d(tt,{vertical:"",class:"h-6"}),d(Oi,{color:"info",content:X.value,dot:Ye(D)||I.value,class:"cursor-pointer",onClick:g[3]||(g[3]=z=>I.value=!0)},{default:p(()=>[d(W,{class:"w-6 h-6 ml-3 text-slate-100",onClick:g[2]||(g[2]=z=>I.value=!0)},{default:p(()=>[E(" mdi-video-box ")]),_:1})]),_:1},8,["content","dot"])])):L("",!0)],2),d(us,{modelValue:Ye(m).managerVars.configMenuOpen,"onUpdate:modelValue":g[5]||(g[5]=z=>Ye(m).managerVars.configMenuOpen=z),width:"auto"},{default:p(()=>[u("div",Bi,[zi,Wi,d(ba,{"model-value":P.value,label:"Stream name",items:Ye(Y),"item-title":"name",density:"compact",variant:"outlined","no-data-text":"No streams available.","hide-details":"","return-object":"","onUpdate:modelValue":Z},null,8,["model-value","items"]),u("div",Yi,[u("button",{class:"w-auto p-3 m-2 font-medium transition-all rounded-md shadow-md text-uppercase hover:bg-slate-100",onClick:g[4]||(g[4]=z=>Ye(m).managerVars.configMenuOpen=!1)}," Cancel "),u("button",{class:me(["flex items-center p-3 mx-2 font-medium transition-all rounded-md shadow-md w-fit text-uppercase hover:bg-slate-100",{"bg-slate-200 opacity-30 pointer-events-none":h.value}]),onClick:ye},[Hi,h.value?(T(),Ve(W,{key:0,class:"m-2 animate-spin"},{default:p(()=>[E("mdi-loading")]),_:1})):(T(),C("div",ji))],2)])])]),_:1},8,["modelValue"]),d(ki,{"open-modal":I.value,"onUpdate:openModal":A},null,8,["open-modal"])],64)}}}),qi=vs($i,[["__scopeId","data-v-4c0101b9"]]);export{qi as default};
