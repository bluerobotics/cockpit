import{c as F,I as k,u as B,J as U,K as D,r as c,k as u,w as O,L as j,M as x,h as z,l as d,m as v,q as E,T as G,n as o,x as R,F as V,t as m,G as r,N as g,V as q,O as H,s as a,P as J,Q as K,R as L,S as I,H as Q,U as $,v as X,W as Y}from"./index-CmwIAKgn.js";const Z={class:"flex items-center w-[5.5rem] h-12 text-white justify-center"},ee=o("span",{class:"absolute text-sm text-yellow-400 -bottom-[2px] -right-[7px] mdi mdi-alert-circle"},null,-1),te=[ee],oe={class:"flex flex-col w-[4rem] select-none text-sm font-semibold leading-4 text-end"},se={class:"w-full"},ae={class:"font-mono"},ne=o("span",null," V",-1),le={class:"w-full"},re={class:"font-mono"},ie=o("span",null," A",-1),ue={class:"w-full"},de={class:"font-mono"},pe=o("span",null," W",-1),ce={class:"w-full"},ve={class:"font-mono"},me=o("span",null," Wh",-1),w=500,he=F({__name:"BatteryIndicator",props:{miniWidget:{}},setup(A){const e=k(A).miniWidget,t=B(),C=U(),S=D(),p=c(!0),i=c(void 0),h=c(e.value.options.toggleInterval),b=u(()=>{var s;return((s=t==null?void 0:t.powerSupply)==null?void 0:s.voltage)===void 0?NaN:Math.abs(t.powerSupply.voltage)>=100?t.powerSupply.voltage.toFixed(0):t.powerSupply.voltage.toFixed(1)}),W=u(()=>{var s;return((s=t==null?void 0:t.powerSupply)==null?void 0:s.current)===void 0?NaN:Math.abs(t.powerSupply.current)>=100?t.powerSupply.current.toFixed(0):t.powerSupply.current.toFixed(1)}),M=u(()=>t.instantaneousWatts?t.instantaneousWatts.toFixed(1):NaN),N=u(()=>t.totalConsumedWatts.toFixed(1)),P=u(()=>"mdi-battery"),_=()=>{i.value&&clearInterval(i.value),h.value=e.value.options.toggleInterval,e.value.options.showVoltageAndCurrent&&e.value.options.showPowerAndConsumption?i.value=setInterval(()=>{p.value=!p.value},e.value.options.toggleInterval):p.value=e.value.options.showVoltageAndCurrent};O(()=>e.value.options,_,{deep:!0});const y=s=>{!e.value.options.showVoltageAndCurrent&&!e.value.options.showPowerAndConsumption&&(e.value.options[s?"showPowerAndConsumption":"showVoltageAndCurrent"]=!0)},f=c(""),T=s=>{s<w?f.value=`Interval must be at least ${w}ms`:(f.value="",e.value.options.toggleInterval=s)};return j(()=>{const s={showVoltageAndCurrent:!0,showPowerAndConsumption:!0,toggleInterval:3e3};!e.value.options.showVoltageAndCurrent&&!e.value.options.showPowerAndConsumption?e.value.options={...s}:e.value.options=Object.assign({},s,e.value.options),e.value.options.toggleInterval=Math.max(w,e.value.options.toggleInterval),_(),x.registerUsage("Instantaneous Watts"),x.registerUsage("Total Consumed Wh")}),z(()=>{i.value&&clearInterval(i.value)}),(s,n)=>(d(),v(V,null,[E((d(),v("div",Z,[o("span",{class:R(["relative w-[1.5rem] mdi battery-icon",[P.value]])},te,2),o("div",oe,[p.value?(d(),v(V,{key:0},[o("div",se,[o("span",ae,m(b.value),1),ne]),o("div",le,[o("span",re,m(W.value),1),ie])],64)):(d(),v(V,{key:1},[o("div",ue,[o("span",de,m(M.value),1),pe]),o("div",ce,[o("span",ve,m(N.value),1),me])],64))])])),[[G,"Battery information"]]),r(Y,{modelValue:a(C).miniWidgetManagerVars(a(e).hash).configMenuOpen,"onUpdate:modelValue":n[4]||(n[4]=l=>a(C).miniWidgetManagerVars(a(e).hash).configMenuOpen=l),width:"auto"},{default:g(()=>[r(q,{class:"pa-4 text-white",style:H([{"border-radius":"15px"},a(S).globalGlassMenuStyles])},{default:g(()=>[r(J,{class:"text-center"},{default:g(()=>[K("Battery Indicator Config")]),_:1}),r(L,{class:"flex flex-col gap-y-4"},{default:g(()=>[r(I,{modelValue:a(e).options.showVoltageAndCurrent,"onUpdate:modelValue":[n[0]||(n[0]=l=>a(e).options.showVoltageAndCurrent=l),y],label:"Show Voltage and Current","hide-details":""},null,8,["modelValue"]),r(I,{modelValue:a(e).options.showPowerAndConsumption,"onUpdate:modelValue":[n[1]||(n[1]=l=>a(e).options.showPowerAndConsumption=l),y],label:"Show Power and Consumption","hide-details":""},null,8,["modelValue"]),a(e).options.showVoltageAndCurrent&&a(e).options.showPowerAndConsumption?(d(),Q($,{key:0,modelValue:h.value,"onUpdate:modelValue":[n[2]||(n[2]=l=>h.value=l),n[3]||(n[3]=l=>T(Number(l)))],modelModifiers:{number:!0},label:"Toggle Interval (ms)",type:"number",min:w,step:"100",density:"compact",variant:"outlined","error-messages":f.value},null,8,["modelValue","error-messages"])):X("",!0)]),_:1})]),_:1},8,["style"])]),_:1},8,["modelValue"])],64))}});export{he as default};
